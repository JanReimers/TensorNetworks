#LyX 2.3 created this file. For more info see http://www.lyx.org/
\lyxformat 544
\begin_document
\begin_header
\save_transient_properties true
\origin unavailable
\textclass article
\use_default_options true
\maintain_unincluded_children false
\language english
\language_package default
\inputencoding auto
\fontencoding global
\font_roman "default" "default"
\font_sans "default" "default"
\font_typewriter "default" "default"
\font_math "auto" "auto"
\font_default_family default
\use_non_tex_fonts false
\font_sc false
\font_osf false
\font_sf_scale 100 100
\font_tt_scale 100 100
\use_microtype false
\use_dash_ligatures true
\graphics default
\default_output_format default
\output_sync 0
\bibtex_command default
\index_command default
\paperfontsize default
\spacing single
\use_hyperref false
\papersize default
\use_geometry true
\use_package amsmath 1
\use_package amssymb 1
\use_package cancel 1
\use_package esint 1
\use_package mathdots 1
\use_package mathtools 1
\use_package mhchem 1
\use_package stackrel 1
\use_package stmaryrd 1
\use_package undertilde 1
\cite_engine basic
\cite_engine_type default
\biblio_style plain
\use_bibtopic false
\use_indices false
\paperorientation portrait
\suppress_date false
\justification true
\use_refstyle 1
\use_minted 0
\index Index
\shortcut idx
\color #008000
\end_index
\leftmargin 2cm
\topmargin 2cm
\rightmargin 2cm
\bottommargin 2cm
\secnumdepth 3
\tocdepth 3
\paragraph_separation indent
\paragraph_indentation default
\is_math_indent 0
\math_numbering_side default
\quotes_style english
\dynamic_quotes 0
\papercolumns 1
\papersides 1
\paperpagestyle default
\listings_params "language={C++},keywordstyle={\color{blue}},commentstyle={\color{magenta}\itshape},emphstyle={\color{red}},breaklines=true,basicstyle={\ttfamily},stringstyle={\color{green}},identifierstyle={\color{cyan}}"
\tracking_changes false
\output_changes false
\html_math_output 0
\html_css_as_file 0
\html_be_strict false
\end_header

\begin_body

\begin_layout Title
Tensor Networks and Matrix Product States II
\end_layout

\begin_layout Author
Jan Reimers
\end_layout

\begin_layout Date
Jan 2020
\end_layout

\begin_layout Section
Introduction
\end_layout

\begin_layout Standard
These notes are based on the review article by Schollwoeck
\begin_inset CommandInset citation
LatexCommand cite
key "schollwoeck_density-matrix_2010"
literal "false"

\end_inset

 which has all the details required for programming a Matrix Product State
 (MPS) code.
\end_layout

\begin_layout Standard
It turns out that quantum states encountered in nature and in particular
 ground and low lying states, only sample an exponentially tiny fraction
 of the available Hilbert space.
 So in principle we could save ourselves a lot of work if there was a way
 of restricting the wave function to the relevant part of Hilbert space.
 In fact we do this all the time with mean field methods like the Hartree-Fock
 approximation.
 In this form we just assume that the wave function is a product of single
 particle state functions.
 But this goes too far, we need a way of constraining the wave function
 in a tune-able way.
 Over the last twenty years this has been essentially solved for 
\begin_inset Formula $1D$
\end_inset

 systems with Matrix Product States (MPS) and with tensor networks (really
 Tensor Product States) for higher dimensional systems.
 These ideas grew out of White
\begin_inset CommandInset citation
LatexCommand cite
key "white_density_1992,white_density-matrix_1993"
literal "false"

\end_inset

 and Wilson's Density Matrix Renormalization Group methods.
\end_layout

\begin_layout Section
MPS Preliminaries
\end_layout

\begin_layout Subsection
Definition
\end_layout

\begin_layout Standard
The most general form for the state vector of a 
\begin_inset Formula $1D$
\end_inset

 lattice of spins with open boundary conditions (OBC), is
\begin_inset Formula 
\begin{equation}
\left|\psi\right\rangle =\sum_{n_{1}n_{2}\cdots n_{L}=0}^{d}c_{n_{1}n_{2}\cdots n_{L}}\left|n_{1}n_{2}\cdots n_{L}\right\rangle \label{eq:GeneralStateVector}
\end{equation}

\end_inset

where 
\begin_inset Formula $L$
\end_inset

 is the number of particles or spins on the lattice sites, 
\begin_inset Formula $d$
\end_inset

 is the dimension of the local Hilbert space for each spin, 
\begin_inset Formula $n_{a}$
\end_inset

 is the quantum number for the spin at lattice site 
\begin_inset Formula $a$
\end_inset

 and the 
\begin_inset Formula $c_{n_{1}n_{2}\cdots n_{L}}$
\end_inset

 are the 
\begin_inset Formula $L^{d}$
\end_inset

 complex amplitudes.
 One can show 
\begin_inset CommandInset citation
LatexCommand cite
key "schollwoeck_density-matrix_2010"
literal "false"

\end_inset

 that this massive tensor can be expressed as a product of matrices
\begin_inset Formula 
\begin{equation}
c_{n_{1}n_{2}\cdots n_{L}}=\boldsymbol{M}^{\left[1\right]n_{1}}\boldsymbol{M}^{\left[2\right]n_{2}}\ldots\boldsymbol{M}^{\left[L\right]n_{L}}\label{eq:MPS Representation}
\end{equation}

\end_inset

provided that the matrices have dimensions 
\begin_inset Formula $1\times d$
\end_inset

, 
\begin_inset Formula $d\times d^{2}$
\end_inset

, 
\begin_inset Formula $d^{2}\times d^{3}\cdots d^{\left(L-1\right)/2}\times d^{L/2}\cdots d\times1$
\end_inset

.
 The boundary matrices are tractable but they get exponentially large towards
 the center of the spin chain.
 The ansatz is that we can place a cutoff 
\begin_inset Formula $D$
\end_inset

 on the size of the matrices.
 
\begin_inset Formula $D$
\end_inset

 is often referred to as the maximum bond dimension.
 It turns out that very accurate ground state wave functions for many 
\begin_inset Formula $1D$
\end_inset

 systems can be represented with 
\begin_inset Formula $D\lesssim O\left(100\right)$
\end_inset

.
\end_layout

\begin_layout Subsection
MPS Diagrams
\end_layout

\begin_layout Standard
We can express eq.
 
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:MPS Representation"
plural "false"
caps "false"
noprefix "false"

\end_inset

 in a diagram form shown in figure 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:MPS bra and ket"
plural "false"
caps "false"
noprefix "false"

\end_inset

a.
\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename BraKet.png
	rotateOrigin center

\end_inset


\begin_inset Caption Standard

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "fig:MPS bra and ket"

\end_inset

Diagrammatic representation of an MPS state ket (a) and is adjoint bra in
 (b)
\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout

\end_layout

\end_inset


\end_layout

\begin_layout Standard
For programming it is often convenient to include names for all the internal
 and external legs in the diagram.
 Each circle in the diagram corresponds to one of the 
\begin_inset Formula $\boldsymbol{M}$
\end_inset

 matrices in eq 
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:MPS Representation"
plural "false"
caps "false"
noprefix "false"

\end_inset

.
 Also it is nice to avoid Greek symbols when programming.
 Figure 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:MPS bra and ket"
plural "false"
caps "false"
noprefix "false"

\end_inset

a corresponds to
\begin_inset Formula 
\begin{equation}
\left|\psi\right\rangle =\sum_{\left\{ n\right\} =0}^{d}\sum_{\left\{ j\right\} =1}^{D}M_{1j_{1}}^{\left[1\right]n_{1}}M_{j_{1}j_{2}}^{\left[2\right]n_{2}}M_{j_{2}j_{3}}^{\left[3\right]n_{3}}M_{j_{3}j_{4}}^{\left[4\right]n_{4}}M_{j_{4}1}^{\left[5\right]n_{5}}\left|n_{1}n_{2}n_{3}n_{4}n_{5}\right\rangle \label{eq:KetFull}
\end{equation}

\end_inset


\begin_inset Formula 
\begin{equation}
\sum_{\left\{ n\right\} }\prod_{a}\boldsymbol{M}^{n_{a}}\left|n_{a}\right\rangle \label{eq:KetCompact}
\end{equation}

\end_inset

Where the second line is a compact representation with summation limits,
 matrix multiplications and state tensor products implied.
 The conventions here are that
\end_layout

\begin_layout Enumerate
\begin_inset Formula $a$
\end_inset

 labels a lattice site from 
\begin_inset Formula $1\ldots L$
\end_inset

.
\end_layout

\begin_layout Enumerate
\begin_inset Formula $m_{a}$
\end_inset

 and 
\begin_inset Formula $n_{a}$
\end_inset

 are bra and ket quantum numbers for site 
\begin_inset Formula $a$
\end_inset

 ranging from 
\begin_inset Formula $0\rightarrow d-1$
\end_inset


\end_layout

\begin_layout Enumerate
\begin_inset Formula $i_{a}$
\end_inset

 and 
\begin_inset Formula $j_{a}$
\end_inset

 are bra and ket internal indices than tie together neighbouring matrices.
 These are called the bond indices.
 These are 
\begin_inset Formula $1$
\end_inset

 based (not 
\begin_inset Formula $0$
\end_inset

 based).
 They can usually range up to some maximum 
\begin_inset Formula $D$
\end_inset

, but can also be site dependent 
\begin_inset Formula $D_{a}$
\end_inset

 for certain algorithms which dynamically tune 
\begin_inset Formula $D_{a}$
\end_inset

 separately for each site in order to achieve a specified accuracy.
\end_layout

\begin_layout Enumerate
open up and down legs in the diagram have local bra 
\begin_inset Formula $\left\langle m_{a}\right|$
\end_inset

 or ket 
\begin_inset Formula $\left|n_{a}\right\rangle $
\end_inset

 states associated with them.
 These are called the physical indices
\end_layout

\begin_layout Enumerate
For each matrix the number in square brackets 
\begin_inset Formula $\left[a\right]$
\end_inset

 labels the matrix as being associated with lattice site 
\begin_inset Formula $a$
\end_inset

.
 Often these labels are omitted since quantum number label 
\begin_inset Formula $n_{a}$
\end_inset

 also identifies the site.
 
\begin_inset Formula $\boldsymbol{M}^{\left[a\right]n_{a}}=\boldsymbol{M}^{n_{a}}$
\end_inset


\end_layout

\begin_layout Enumerate
Lower indices on the 
\begin_inset Formula $\boldsymbol{M}$
\end_inset

's are for bond indices and upper indices are for the physical index.
\end_layout

\begin_layout Enumerate
For open boundary conditions (OBC) the edge matrices are 
\begin_inset Formula $1\times D$
\end_inset

 and 
\begin_inset Formula $D\times1$
\end_inset

.
\end_layout

\begin_layout Standard
One can think of the 
\begin_inset Formula $\boldsymbol{M}$
\end_inset

's on each site as a group of 
\begin_inset Formula $d$
\end_inset

, 
\begin_inset Formula $D\times D$
\end_inset

 matrices or as a rank 
\begin_inset Formula $3$
\end_inset

 tensor on each site.
 With all this in mind the bra vector in figure 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:MPS bra and ket"
plural "false"
caps "false"
noprefix "false"

\end_inset

b is
\begin_inset Formula 
\begin{equation}
\left\langle \psi\right|=\sum_{\left\{ m\right\} =0}^{d}\sum_{\left\{ i\right\} =1}^{D}M_{1i_{4}}^{*\left[5\right]m_{5}}M_{i_{4}i_{3}}^{*\left[4\right]m_{4}}M_{i_{3}i_{2}}^{*\left[3\right]m_{3}}M_{i_{2}i_{1}}^{*\left[2\right]m_{2}}M_{i_{1}1}^{*\left[1\right]m_{1}}\left\langle m_{1}m_{2}m_{3}m_{4}m_{5}\right|\label{eq:BraFull}
\end{equation}

\end_inset


\begin_inset Formula 
\begin{equation}
=\sum_{\left\{ m\right\} }\prod_{a=L}^{1}\boldsymbol{M}^{*m_{a}}\left\langle m_{a}\right|\label{eq:BraCompact}
\end{equation}

\end_inset

where I have explicitly shown that the product runs backwards through the
 lattice since 
\begin_inset Formula $\left(\boldsymbol{A}\boldsymbol{B}\right)^{\dagger}=\boldsymbol{B}^{\dagger}\boldsymbol{A}^{\dagger}$
\end_inset


\end_layout

\begin_layout Subsection
Calculating the overlap
\end_layout

\begin_layout Standard
The brute force approach to the overlap 
\begin_inset Formula $\left\langle \psi\right|\left.\psi\right\rangle $
\end_inset

 would be to combine eq.
 
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:BraFull"
plural "false"
caps "false"
noprefix "false"

\end_inset

 and 
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:KetFull"
plural "false"
caps "false"
noprefix "false"

\end_inset

 and then do the algebra.
 However it is much easier to get the answer from a diagram.
 We can join the physical legs of the diagram in figure 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:MPS bra and ket"
plural "false"
caps "false"
noprefix "false"

\end_inset

 and use 
\begin_inset Formula $\left\langle m\right|\left.n\right\rangle =\delta_{mn}$
\end_inset

 everywhere.
 The resulting labeled diagram is shown in figure 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:Overlap"
plural "false"
caps "false"
noprefix "false"

\end_inset

.
\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout

\end_layout

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename Overlap.png

\end_inset


\begin_inset Caption Standard

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "fig:Overlap"

\end_inset

Diagrammatic representation of the overlap
\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout

\end_layout

\end_inset


\end_layout

\begin_layout Standard
From the diagram we can read off the overlap expression by summing over
 all indices
\begin_inset Formula 
\[
\left\langle \psi\right|\left.\psi\right\rangle =\sum_{\left\{ n\right\} }\left(\boldsymbol{M}^{*n_{5}}\boldsymbol{M}^{*n_{4}}\boldsymbol{M}^{*n_{3}}\boldsymbol{M}^{*n_{2}}\boldsymbol{M}^{*n_{1}}\right)\left(\boldsymbol{M}^{n_{1}}\boldsymbol{M}^{n_{2}}\boldsymbol{M}^{n_{3}}\boldsymbol{M}^{n_{4}}\boldsymbol{M}^{n_{5}}\right).
\]

\end_inset

where matrix multiplication occur inside the brackets, but not between the
 two brackets.
 The big win with MPS is that the 
\begin_inset Formula $2^{L}$
\end_inset

 summation over quantum numbers now factorizes
\begin_inset Formula 
\begin{equation}
\left\langle \psi\right|\left.\psi\right\rangle =\sum_{n_{5}}\boldsymbol{M}^{*n_{5}}\cdots\left[\sum_{n_{2}}\boldsymbol{M}^{*n_{2}}\left(\sum_{n_{1}}\boldsymbol{M}^{*n_{1}}\boldsymbol{M}^{n_{1}}\right)\boldsymbol{M}^{n_{2}}\right]\cdots\boldsymbol{M}^{n_{5}}.\label{eq:OverlapUnormalized}
\end{equation}

\end_inset

This is the most efficient contraction order.
 Note that 
\begin_inset Formula $\boldsymbol{M}^{*n_{1}}$
\end_inset

 and 
\begin_inset Formula $\boldsymbol{M}^{n_{1}}$
\end_inset

 have different internal indices so we are not multiplying them, it is more
 like an outer product.
 At this point we can define the so called transfer matrix for each site
\begin_inset Formula 
\[
E_{\left(11\right)\left(i_{1}j_{1}\right)}^{1}=\sum_{n_{1}}\boldsymbol{M}^{*n_{1}}\boldsymbol{M}^{n_{1}}=\sum_{n_{1}}M_{1i_{1}}^{*n_{1}}M_{1j_{1}}^{n_{1}}
\]

\end_inset


\begin_inset Formula 
\begin{equation}
E_{\left(i_{a-1}j_{a-1}\right)\left(i_{a}j_{a}\right)}^{a}=\sum_{n_{a}}\boldsymbol{M}^{*n_{a}}\boldsymbol{M}^{n_{a}}=\sum_{n_{a}}M_{i_{a-1}i_{a}}^{*n_{a}}M_{j_{a-1}j_{a}}^{n_{a}}\label{eq:TransferSitea}
\end{equation}

\end_inset


\begin_inset Formula 
\[
E_{\left(i_{L-1}j_{L-1}\right)\left(11\right)}^{L}=\sum_{n_{L}}\boldsymbol{M}^{*n_{L}}\boldsymbol{M}^{n_{L}}=\sum_{n_{L}}M_{i_{L-1}i_{1}}^{*n_{L}}M_{j_{L-1}j_{1}}^{n_{L}}.
\]

\end_inset

In terms of transfer matrices the overlap is
\begin_inset Formula 
\begin{equation}
\left\langle \psi\right|\left.\psi\right\rangle =\sum_{\left\{ ij\right\} }E_{\left(11\right)\left(i_{1}j_{1}\right)}^{1}E_{\left(i_{1}j_{1}\right)\left(i_{2}j_{2}\right)}^{2}\cdots E_{\left(i_{L-1}j_{L-1}\right)\left(11\right)}^{L}\label{eq:OverlapTransfer}
\end{equation}

\end_inset


\begin_inset Formula 
\[
=\prod_{a}\boldsymbol{E}^{a}
\]

\end_inset


\end_layout

\begin_layout Subsection
Gauge freedom and canonical forms
\end_layout

\begin_layout Standard
The matrices in the an MPS are not uniquely defined, for any matrix product
 one can always insert or sandwich the identity matrix without changing
 the result of the product
\begin_inset Formula 
\[
\boldsymbol{A}\boldsymbol{B}=\boldsymbol{A}\text{ùïÄ}\boldsymbol{B}=\boldsymbol{A}\boldsymbol{X}\boldsymbol{X}^{-1}\boldsymbol{B}
\]

\end_inset


\end_layout

\begin_layout Standard
We will now use this gauge freedom the represent and MPS in canonical form.
 Essential for this is the concept of re-shaping tensors.
\end_layout

\begin_layout Subsubsection
Re-shaping and SVD
\end_layout

\begin_layout Standard
Any rank-
\begin_inset Formula $3$
\end_inset

 tensor can be re-shaped into rank-
\begin_inset Formula $2$
\end_inset

 matrix as follows
\begin_inset Formula 
\[
M_{i_{a-1}i_{a}}^{n_{a}}\rightarrow M_{(i_{a-1},n_{a})i_{a}}=\begin{bmatrix}\boldsymbol{M}^{\left[a\right]0}\\
\boldsymbol{M}^{\left[a\right]1}\\
\vdots\\
\boldsymbol{M}^{\left[a\right]d}
\end{bmatrix}
\]

\end_inset

where we have grouped together the 
\begin_inset Formula $i_{a-1}$
\end_inset

 and 
\begin_inset Formula $n_{a}$
\end_inset

 indices with brackets.
 We can also think of this as 
\begin_inset Formula $d$
\end_inset

 matrices with shape 
\begin_inset Formula $D_{a-1}\times D_{a}$
\end_inset

 being reshaped into a larger 
\begin_inset Formula $dD_{a-1}\times D_{a}$
\end_inset

 matrix.
 This general non-square matrix can be decomposed using Singular Value Decomposi
tion (SVD)
\begin_inset Formula 
\begin{equation}
M_{(i_{a-1},n_{1})i_{a}}=\left(\boldsymbol{UsV}\right)_{(i_{a-1},n_{1})i_{a}}=\sum_{j_{a}}^{D}U_{\left(i_{a-1},n_{a}\right)j_{a}}s_{j_{a}j_{a}}V_{j_{a}i_{a}}\label{eq:SVDDecomp}
\end{equation}

\end_inset

where 
\begin_inset Formula $\boldsymbol{s}$
\end_inset

 is a diagonal matrix of singular values and 
\begin_inset Formula $\boldsymbol{U}$
\end_inset

 and 
\begin_inset Formula $\boldsymbol{V}$
\end_inset

 are orthonormal matrices satisfying
\begin_inset Formula 
\begin{equation}
\boldsymbol{U}^{\dagger}\boldsymbol{U}=\text{ùïÄ},\;\boldsymbol{V}\boldsymbol{V}^{\dagger}=\text{ùïÄ}.\label{eq:SVDOrthoNormConditions}
\end{equation}

\end_inset

The 
\begin_inset Formula $\boldsymbol{U}$
\end_inset


\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
 can now be reshaped backwards as
\begin_inset Formula 
\begin{equation}
A_{i_{a-1}j_{a}}^{n_{a}}=U_{\left(i_{a-1},n_{a}\right)j_{a}}\label{eq:Uassign}
\end{equation}

\end_inset

The normalization conditions in eq.
 
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:SVDOrthoNormConditions"
plural "false"
caps "false"
noprefix "false"

\end_inset

 can also be reshaped 
\begin_inset Formula 
\begin{equation}
\sum_{n_{a}}\boldsymbol{A}^{\dagger n_{a}}\boldsymbol{A}^{n_{a}}=\text{ùïÄ}\label{eq:LeftNormalized}
\end{equation}

\end_inset


\end_layout

\begin_layout Subsubsection
Repeated SVD and normalization
\end_layout

\begin_layout Standard
We can now start on the left and zip through the lattice and convert the
 whole MPS into a left canonical form.
 Starting with site 
\begin_inset Formula $1$
\end_inset


\begin_inset Formula 
\begin{equation}
M_{1i_{1}}^{n_{1}}\rightarrow M_{(1,n_{1})i_{1}}=\boldsymbol{U}^{1}\boldsymbol{s}^{1}\boldsymbol{V}^{1}\label{eq:SVD Site 1}
\end{equation}

\end_inset


\begin_inset Formula 
\begin{equation}
A_{1j_{1}}^{n_{1}}=U_{\left(1,n_{1}\right)j_{1}}.\label{eq:Uassign1}
\end{equation}

\end_inset

At this point we need to decide what to do with 
\begin_inset Formula $\boldsymbol{s}^{1}$
\end_inset

 and 
\begin_inset Formula $\boldsymbol{V}^{1}$
\end_inset

.
 We can keep the singular values separate, and they would naturally live
 on the bond between sites 
\begin_inset Formula $1$
\end_inset

 and 
\begin_inset Formula $2$
\end_inset

.
 In addition the 
\begin_inset Formula $\boldsymbol{s}^{1}$
\end_inset

 and 
\begin_inset Formula $\boldsymbol{V}^{1}$
\end_inset

 matrices can be absorbed into 
\begin_inset Formula $\boldsymbol{M}^{n_{2}}$
\end_inset


\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
\tilde{\boldsymbol{M}}^{n_{2}}=\boldsymbol{s}^{1}\boldsymbol{V}^{1}\boldsymbol{M}^{n_{2}}
\]

\end_inset


\begin_inset Formula 
\begin{equation}
\tilde{M}_{j_{1}i_{2}}^{n_{2}}=\sum_{i_{1}=1}^{D_{1}}s_{i_{1}i_{1}}V_{j_{1}i_{1}}^{1}M_{i_{1}i_{2}}^{n_{2}}\label{eq:SVTransfer}
\end{equation}

\end_inset

the gauge freedom allows this.
 Now the MPS looks like
\begin_inset Formula 
\[
\boldsymbol{A}^{n_{1}}\tilde{\boldsymbol{M}}^{n_{2}}\boldsymbol{M}^{n_{3}}\cdots\boldsymbol{M}^{n_{L}}
\]

\end_inset

One can now continue this process by zipping through the lattice repeating
 the above steps, finally arriving at
\begin_inset Formula 
\[
\boldsymbol{A}^{n_{1}}\boldsymbol{A}^{n_{2}}\boldsymbol{A}^{n_{3}}\cdots\boldsymbol{A}^{n_{L}}
\]

\end_inset

The singular values on each bond tell us something about the suitability
 the bond dimension 
\begin_inset Formula $D_{a}$
\end_inset

.
 If 
\begin_inset Formula $\boldsymbol{s_{a}}$
\end_inset

 has a lot of singular values close to zero (
\begin_inset Formula $<\epsilon\approx10^{-14}$
\end_inset

 in a double precision calculation) then 
\begin_inset Formula $D_{a}$
\end_inset

 is bigger than it needs to be.
 Reducing 
\begin_inset Formula $D$
\end_inset

 so that only singular values above some threshold are retained is called
 SVD compression.
 On the other hand if the lowest singular value 
\begin_inset Formula $s_{min}\gg\epsilon$
\end_inset

 then we know 
\begin_inset Formula $D$
\end_inset

 is not big enough to get an accurate ground state.
 Other advantages will become obvious below.
\end_layout

\begin_layout Standard
The whole process can also be run in the other direction starting on the
 right at site 
\begin_inset Formula $L$
\end_inset

, yielding right normalized matrices 
\begin_inset Formula $\boldsymbol{B}$
\end_inset

 which satisfy
\begin_inset Formula 
\[
\sum_{n}\boldsymbol{B}^{n}\boldsymbol{B}^{\dagger n}=\boldsymbol{\mathbb{I}}
\]

\end_inset


\end_layout

\begin_layout Subsubsection
Mixed canonical form
\end_layout

\begin_layout Standard
For calculating expectation values it is often useful so start with a mixed
 canonical state that looks like
\begin_inset Formula 
\[
\left|\psi\right\rangle =\sum_{\left\{ n\right\} }\boldsymbol{A}^{n_{1}}\boldsymbol{A}^{n_{2}}\cdots\boldsymbol{A}^{n_{a}}\boldsymbol{B}^{n_{a+1}}\cdots\boldsymbol{B}^{n_{L}}\left|\left\{ n\right\} \right\rangle 
\]

\end_inset

or
\begin_inset Formula 
\begin{equation}
\left|\psi\right\rangle =\sum_{\left\{ n\right\} }\boldsymbol{A}^{n_{1}}\boldsymbol{A}^{n_{2}}\cdots\boldsymbol{A}^{n_{a-1}}\boldsymbol{M}^{n_{a}}\boldsymbol{B}^{n_{a+1}}\cdots\boldsymbol{B}^{n_{L}}\left|\left\{ n\right\} \right\rangle \label{eq:MixedCanonicalM}
\end{equation}

\end_inset

These states are optimal for calculating the expectation value of a one
 site operator at site 
\begin_inset Formula $a$
\end_inset

.
 In practice one would start with a right normalized and sweep through the
 lattice from left to right and evaluate all required expectations on each
 site as you sweep.
 While sweeping you leave behind left normalized matrices on the left of
 the current site.
\end_layout

\begin_layout Subsubsection
Vidal's Canonical Form
\end_layout

\begin_layout Standard
Yet another canonical form due to Vidal
\begin_inset CommandInset citation
LatexCommand cite
key "vidal_efficient_2003"
literal "false"

\end_inset

 involves storing the singular values on each bond.
 Consider an SVD decomposition of the first matrix at site 
\begin_inset Formula $1$
\end_inset

 as in eq.
 
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:SVD Site 1"
plural "false"
caps "false"
noprefix "false"

\end_inset

 and define
\begin_inset Formula 
\[
\varGamma_{1i_{1}}^{n_{1}}=U_{\left(1,n_{1}\right)i_{1}}
\]

\end_inset


\begin_inset Formula 
\[
\lambda_{i_{1}i_{1}}=s_{i_{1}}
\]

\end_inset


\begin_inset Formula 
\[
\tilde{\boldsymbol{M}}^{n_{2}}=\boldsymbol{V}^{1}\boldsymbol{M}^{n_{2}}
\]

\end_inset

and repeat this process across the lattice.
 The difference here is that we do not absorb the singular values into the
 next site, instead we keep them separate, living on the bond.
 We end up with
\begin_inset Formula 
\begin{equation}
\Gamma^{n_{1}}\lambda^{[1]}\Gamma^{n_{2}}\lambda^{[2]}\Gamma^{n_{3}}\lambda^{[3]}\ldots\lambda^{[L-1]}\Gamma^{n_{L}}.\label{eq:Vidal Canonical}
\end{equation}

\end_inset

as shown in figure 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:Vidal's-canonial-form"
plural "false"
caps "false"
noprefix "false"

\end_inset

.
 The numerical labels for the lambdas can be a little confusing, for example
 
\begin_inset Formula $\lambda^{[1]}$
\end_inset

 should really be labeled 
\begin_inset Formula $\lambda^{[12]}$
\end_inset

 since it is equally associated with site one and site 2.
 With this representation we can bifurcate the lattice at any bond and quickly
 create a block wave function or a mixed canonical form
\begin_inset Formula 
\[
\left(\Gamma^{n_{1}}\lambda^{[1]}\Gamma^{n_{2}}\lambda^{[2]}\ldots\Gamma^{n_{a}}\right)\lambda^{[a]}\left(\Gamma^{n_{a+1}}\ldots\lambda^{[L-1]}\Gamma^{n_{L}}\right)
\]

\end_inset

where the left bracket is called the 
\begin_inset Formula $A$
\end_inset

 block, the right is the 
\begin_inset Formula $B$
\end_inset

 block and 
\begin_inset Formula $\lambda^{[a]}$
\end_inset

 are the Schmidt coefficients.
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout

\end_layout

\begin_layout Plain Layout
\begin_inset Graphics
	filename CanonicalVidal.png
	scale 50

\end_inset


\begin_inset Caption Standard

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "fig:Vidal's-canonial-form"

\end_inset

Vidal's canonical form
\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout

\end_layout

\end_inset


\end_layout

\begin_layout Subsubsection
Canonical Bond Dimensions
\end_layout

\begin_layout Standard
For a wave function with OBC bond dimension 
\begin_inset Formula $D$
\end_inset

 the edge sites will usually have bond dimension 
\begin_inset Formula $D_{a}<D$
\end_inset

.
 In particular the left edge site will have matrix dimensions 
\begin_inset Formula $1\times\min\left\{ d,D\right\} $
\end_inset

 and the next site in will have dimensions 
\begin_inset Formula $\min\left\{ d,D\right\} \times\min\left\{ d^{2},D\right\} $
\end_inset

.
 In general if site 
\begin_inset Formula $a$
\end_inset

 is a distance 
\begin_inset Formula $a$
\end_inset

 from the left then the bond dimensions will be 
\begin_inset Formula $\min\left\{ d^{a-1},D\right\} \times\min\left\{ d^{a},D\right\} $
\end_inset

, similarly on the right the dimensions will be 
\begin_inset Formula $\min\left\{ d^{L-a+1},D\right\} \times\min\left\{ d^{L-a},D\right\} $
\end_inset

.
 The literature does make a passing mention of this in a few instances.
 They don't have a name for it, so I will just call it 
\emph on
canonical bond dimensions
\emph default
.
 These limits are unavoidable, the Hilbert space at the edges of the lattice
 is only so big.
 If you run a left and then right normalization sweeps across the lattice
 these conditions will automatically be enforced by the number of non-zero
 singular values at each bond.
 However for a left normalization sweep no such automatic sizing happens
 on the right hand side of the lattice.
 Similarly if you only do a right normalization sweep, then left side ends
 up with non-canonical bond dimension.
 The last site will always be 
\begin_inset Formula $D\times1$
\end_inset

 instead of 
\begin_inset Formula $\min\left\{ d,D\right\} \times1$
\end_inset

.
 Options for handling this in software are
\end_layout

\begin_layout Enumerate
Always do a left then a right sweep for normalization.
\end_layout

\begin_layout Enumerate
Add code to the left sweep to reshape the right side with canonical dimensions.
 And similarly for right sweeps.
\end_layout

\begin_layout Enumerate
Add code to the MPS constructor so that canonical bond dimensions are built
 in the from the start.
\end_layout

\begin_layout Standard
What we want to avoid is if statements sprinkled randomly throughout the
 code trying fix up the bond dimensions as problems (usually failed asserts)
 arise.
 In addition we may need to enforce canonical bond dimensions when applying
 an MPO (with 
\begin_inset Formula $D_{w}>1$
\end_inset

) to an MPS.
\end_layout

\begin_layout Subsection
Density matrices
\end_layout

\begin_layout Standard
Single and two site density matrices make the calculation of expectation
 values trivial since
\begin_inset Formula 
\[
\left\langle \psi\right|\hat{O}_{a}\left|\psi\right\rangle =Tr\left(O_{a}\rho_{a}\right)=\sum_{mn=0}^{d-1}O_{a}^{mn}\rho_{a}^{mn}
\]

\end_inset

and
\begin_inset Formula 
\[
\left\langle \psi\right|\hat{O}_{a}\hat{O}_{b}\left|\psi\right\rangle =Tr\left(O_{a}O_{b}\rho_{ab}\right)=\sum_{m_{a}n_{a}=0}^{d-1}\sum_{m_{b}n_{b}=0}^{d-1}O_{a}^{m_{a}n_{a}}O_{b}^{m_{b}n_{b}}\rho_{ab}^{\left(m_{a}m_{b}\right)\left(n_{a}n_{b}\right)}
\]

\end_inset

where 
\begin_inset Formula $\rho_{ab}$
\end_inset

 is a 
\begin_inset Formula $d^{2}\times d^{2}$
\end_inset

 two site density matrix.
 In addition these density matrices are of interest in the their own right.
 For example the two site density matrix has 
\begin_inset Formula $d^{2}$
\end_inset

 positive definite eigenvalues all summing to 
\begin_inset Formula $1$
\end_inset

.
 The largest 
\begin_inset Formula $2d$
\end_inset

 of these will be predominantly associated with disentangled states on each
 site.
 The remaining 
\begin_inset Formula $d^{2}-2d$
\end_inset

 eigenvalues are a measure of the entanglement entropy between the two sites.
 It will be interesting to see how this entanglement measure drops with
 distance.
\end_layout

\begin_layout Subsubsection
One site density matrix
\end_layout

\begin_layout Standard
The diagram for a one site density matrix at site 
\begin_inset Formula $2$
\end_inset

 is show in figure 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:OneSiteDensity"
plural "false"
caps "false"
noprefix "false"

\end_inset

.
 It is the same as the overlap diagram with one exception, we make a cut
 on the physical (vertical) leg between 
\begin_inset Formula $\boldsymbol{M}^{n_{2}}$
\end_inset

 and 
\begin_inset Formula $\boldsymbol{M}^{\dagger m_{2}}$
\end_inset

, leaving the site 
\begin_inset Formula $2$
\end_inset

 quantum numbers uncontracted.
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Graphics
	filename density1.png
	scale 50

\end_inset


\begin_inset Caption Standard

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "fig:OneSiteDensity"

\end_inset

Diagram for the density matrix at site 
\begin_inset Formula $2$
\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout

\end_layout

\end_inset

In order to evaluate diagram 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:OneSiteDensity"
plural "false"
caps "false"
noprefix "false"

\end_inset

 we would need to contract from the left and right using expressions like
 
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:OverlapUnormalized"
plural "false"
caps "false"
noprefix "false"

\end_inset

 or 
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:OverlapTransfer"
plural "false"
caps "false"
noprefix "false"

\end_inset

.
\end_layout

\begin_layout Standard
The calculation becomes trivial if the system is in a mixed canonical state
 as per eq.
 
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:MixedCanonicalM"
plural "false"
caps "false"
noprefix "false"

\end_inset

.
 In this case the diagram is much simpler as shown in figure 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:NormalizedDensity"
plural "false"
caps "false"
noprefix "false"

\end_inset

a.
 We can read the expression as
\begin_inset Formula 
\[
\rho_{a}^{mn}=\sum_{j_{a-1}j_{a}}A_{j_{a-1}j_{a}}^{*m}A_{j_{a-1}j_{a}}^{n}=Tr\left(\boldsymbol{A}^{*m}\boldsymbol{A}^{n}\right).
\]

\end_inset


\end_layout

\begin_layout Subsubsection
Neighbouring two site density matrix
\end_layout

\begin_layout Standard
The two site density matrix for neighbouring site is almost as simple
\begin_inset Formula 
\[
\rho_{a,a+1}^{\left(m_{a}m_{a+1}\right)\left(n_{a}n_{a+1}\right)}=\sum_{j_{a-1}j_{a+1}}\sum_{j_{a}i_{a}}A_{j_{a-1}i_{a}}^{*m_{a}}A_{j_{a-1}j_{a}}^{n_{a}}A_{i_{a}j_{a+1}}^{*m_{a+1}}A_{j_{a}j_{a+1}}^{n_{a+1}}
\]

\end_inset


\begin_inset Formula 
\[
=\sum_{j_{a-1}j_{a+1}}\left(\sum_{i_{a}}A_{j_{a-1}i_{a}}^{*m_{a}}A_{i_{a}j_{a+1}}^{*m_{a+1}}\right)\left(\sum_{j_{a}}A_{j_{a-1}j_{a}}^{n_{a}}A_{j_{a}j_{a+1}}^{n_{a+1}}\right)
\]

\end_inset


\begin_inset Formula 
\[
=\sum_{j_{a-1}j_{a+1}}\left(\boldsymbol{A}^{*m_{a}}\boldsymbol{A}^{*m_{a+1}}\right)_{j_{a-1}j_{a+1}}\left(\boldsymbol{A}^{n_{a}}\boldsymbol{A}^{n_{a+1}}\right)_{j_{a-1}j_{a+1}}
\]

\end_inset


\begin_inset Formula 
\[
=Tr\left[\left(\boldsymbol{A}^{*m_{a}}\boldsymbol{A}^{*m_{a+1}}\right)\left(\boldsymbol{A}^{n_{a}}\boldsymbol{A}^{n_{a+1}}\right)\right]
\]

\end_inset

_
\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout

\end_layout

\begin_layout Plain Layout
\begin_inset Graphics
	filename density2.png
	scale 50

\end_inset


\begin_inset Caption Standard

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "fig:NormalizedDensity"

\end_inset

Diagrams for one and two site density matrices for suitable mixed normalized
 states.
\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout

\end_layout

\end_inset


\end_layout

\begin_layout Subsubsection
General two site density matrix
\end_layout

\begin_layout Standard
Reading from the diagram in figure 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:NormalizedDensity"
plural "false"
caps "false"
noprefix "false"

\end_inset

b we have
\begin_inset Formula 
\[
\rho_{a,b}^{\left(m_{a}m_{b}\right)\left(n_{a}n_{b}\right)}=\sum_{\left\{ ij\right\} }A_{j_{a-1}i_{a}}^{*m_{a}}A_{j_{a-1}j_{a}}^{n_{a}}E_{\left(i_{a}j_{a}\right)\left(i_{a+1}j_{a+1}\right)}^{a+1}\cdots E_{\left(i_{b-2}j_{b-2}\right)\left(i_{b-1}j_{b-1}\right)}^{b-1}A_{i_{b-1}j_{b}}^{*m_{b}}A_{j_{b-1}j_{b}}^{n_{b}}
\]

\end_inset

using the transfer matrices defined in eq.
 
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:TransferSitea"
plural "false"
caps "false"
noprefix "false"

\end_inset

.
 Now we see where the name transfer matrix comes from, they allow us to
 transfer from one site to another.
\end_layout

\begin_layout Standard
We need to decide on an efficient way of zipping through the lattice from
 site 
\begin_inset Formula $a$
\end_inset

 to site 
\begin_inset Formula $b$
\end_inset

.
 Calculating 
\begin_inset Formula $D^{2}\times D^{2}$
\end_inset

 transfer matrices is probably not the way to go.
 The first step is to pick a direction.
 Let's try left to right.
 The obvious next step is to contract over 
\begin_inset Formula $i_{a-1}=j_{a-1}$
\end_inset


\begin_inset Formula 
\[
C_{i_{a}j_{a}}^{m_{a}n_{a}}=\sum_{i_{a-1}}A_{i_{a-1}i_{a}}^{*m_{a}}A_{i_{a-1}j_{a}}^{n_{a}}.
\]

\end_inset

Next we contract over 
\begin_inset Formula $j_{a}$
\end_inset

 first and then over 
\begin_inset Formula $i_{a}n_{a+1}$
\end_inset

:
\begin_inset Formula 
\[
C_{i_{a+1}j_{a+1}}^{m_{a}n_{a}}=\sum_{i_{a}j_{a}}\sum_{n_{a+1}}C_{i_{a}j_{a}}^{m_{a}n_{a}}M_{i_{a}i_{a+1}}^{*n_{a+1}}M_{j_{a}j_{a+1}}^{n_{a+1}}
\]

\end_inset


\begin_inset Formula 
\[
=\sum_{i_{a}}\sum_{n_{a}}M_{i_{a}i_{a+1}}^{*n_{a+1}}\left(\sum_{j_{a}}C_{i_{a}j_{a}}^{m_{a}n_{a}}M_{j_{a}j_{a+1}}^{n_{a+1}}\right)
\]

\end_inset

We continue this iteration until we reach 
\begin_inset Formula $C_{i_{b-1}j_{b-1}}^{m_{a}n_{a}}$
\end_inset

 from which we can evaluate the final result
\begin_inset Formula 
\[
\rho_{a,b}^{\left(m_{a}m_{b}\right)\left(n_{a}n_{b}\right)}=\sum_{i_{b-1}j_{b}}M_{i_{b-1}j_{b}}^{*m_{b}}\left(\sum_{j_{b-1}}C_{i_{b-1}j_{b-1}}^{m_{a}n_{a}}M_{j_{b-1}j_{b}}^{n_{b}}\right)
\]

\end_inset


\end_layout

\begin_layout Section
Matrix Product Operators
\end_layout

\begin_layout Standard
We can project out a single wave function amplitude as
\begin_inset Formula 
\[
\left\langle n_{1}n_{2}\cdots n_{L}\right|\left.\psi\right\rangle =\boldsymbol{M}^{n_{1}}\boldsymbol{M}^{n_{2}}\ldots\boldsymbol{M}^{n_{N}}
\]

\end_inset

in an analogous manner we can write the expectation of any operator 
\begin_inset Formula $\mathcal{\hat{O}}$
\end_inset

 as
\begin_inset Formula 
\[
\left\langle n_{1}n_{2}\cdots n_{L}\right|\hat{O}\left|m_{1}m_{2}\cdots m_{L}\right\rangle =\boldsymbol{W}^{n_{1}m_{1}}\boldsymbol{W}^{n_{2}m_{2}}\cdots\boldsymbol{W}^{n_{L}m_{L}}
\]

\end_inset

or
\begin_inset Formula 
\[
\hat{O}=\sum_{\left\{ nm\right\} }\boldsymbol{W}^{n_{1}m_{1}}\boldsymbol{W}^{n_{2}m_{2}}\cdots\boldsymbol{W}^{n_{L}m_{L}}\left|n_{1}\cdots n_{L}\right\rangle \left\langle m_{1}\cdots m_{L}\right|
\]

\end_inset

The 
\begin_inset Formula $\boldsymbol{W}^{n_{a}m_{a}}$
\end_inset

 matrices are analogous to the 
\begin_inset Formula $\boldsymbol{A}^{n_{a}}$
\end_inset

 matrices in the state expansion with the exception that the 
\begin_inset Formula $W's$
\end_inset

 have two physical indices.
 So the big question is how do we go from a Hamiltonian expression to the
 
\begin_inset Formula $W's$
\end_inset

? We can also write this in terms of operator valued matrices
\begin_inset Formula 
\begin{equation}
\hat{\boldsymbol{W}^{a}}=\sum_{n_{a}m_{a}}\boldsymbol{W}^{n_{a}m_{a}}\left|n_{a}\right\rangle \left\langle m_{a}\right|\label{eq:OpValuedMatrix}
\end{equation}

\end_inset

now
\begin_inset Formula 
\[
\hat{O}=\hat{\boldsymbol{W}^{1}}\hat{\boldsymbol{W}^{2}}\cdots\hat{\boldsymbol{W}^{L}}
\]

\end_inset

In this representation each 
\begin_inset Formula $\hat{\boldsymbol{W}^{a}}$
\end_inset

 acts on one site
\end_layout

\begin_layout Subsection
Representing the Hamiltonian as an MPO
\end_layout

\begin_layout Standard
For a simple Heisenberg Hamiltonian
\begin_inset Formula 
\[
\mathcal{\hat{H}}=\sum_{a=1}^{L-1}\vec{S}_{a}\cdot\vec{S}_{a+1}=\sum_{a=1}^{L-1}\hat{\mathcal{H}}_{a}
\]

\end_inset

we need realize that this is a compact way of expressing
\begin_inset Formula 
\[
\mathcal{\hat{H}}=\hat{\mathcal{H}}_{1}\otimes\mathbb{I}_{3}\otimes\mathbb{I}_{4}\cdots\otimes\mathbb{I}_{L}+\mathbb{I}_{1}\otimes\hat{\mathcal{H}}_{2}\otimes\mathbb{I}_{4}\cdots\otimes\mathbb{I}_{L}+\cdots+\mathbb{I}_{1}\otimes\mathbb{I}_{2}\otimes\mathbb{I}_{3}\cdots\otimes\hat{\mathcal{H}}_{L-1}
\]

\end_inset

where the 
\begin_inset Formula $\mathbb{I}_{a}'s$
\end_inset

 are 
\begin_inset Formula $d\times d$
\end_inset

 and 
\begin_inset Formula $\hat{\mathcal{H}}_{a}'s$
\end_inset

 are
\begin_inset Formula $d^{2}\times d^{2}$
\end_inset

 since they couple two neighbouring sites.
 We can break this down even further using
\begin_inset Formula 
\[
\hat{\mathcal{H}}_{a}=\frac{1}{2}\left(\hat{S}_{+}^{a}\hat{S}_{-}^{a+1}+\hat{S}_{-}^{a}\hat{S}_{+}^{a+1}\right)+\hat{S}_{z}^{a}\hat{S}_{z}^{a+1}
\]

\end_inset

now
\begin_inset Formula 
\[
\mathcal{\hat{H}}=\frac{1}{2}\hat{S}_{+}^{1}\otimes\hat{S}_{-}^{2}\otimes\mathbb{I}_{3}\otimes\mathbb{I}_{4}\cdots\otimes\mathbb{I}_{L}+\frac{1}{2}\hat{S}_{-}^{1}\otimes\hat{S}_{+}^{2}\otimes\mathbb{I}_{3}\otimes\mathbb{I}_{4}\cdots\otimes\mathbb{I}_{L}+\hat{S}_{z}^{1}\otimes\hat{S}_{z}^{2}\otimes\mathbb{I}_{3}\otimes\mathbb{I}_{4}\cdots\otimes\mathbb{I}_{L}
\]

\end_inset


\begin_inset Formula 
\begin{equation}
+\mathbb{I}_{1}\otimes\frac{1}{2}\hat{S}_{+}^{2}\otimes\hat{S}_{-}^{3}\otimes\mathbb{I}_{4}\cdots\otimes\mathbb{I}_{L}+\mathbb{I}_{1}\otimes\frac{1}{2}\hat{S}_{-}^{2}\otimes\hat{S}_{+}^{3}\otimes\mathbb{I}_{4}\cdots\otimes\mathbb{I}_{L}+\mathbb{I}_{1}\otimes\hat{S}_{z}^{2}\otimes\hat{S}_{z}^{3}\otimes\mathbb{I}_{4}\cdots\otimes\mathbb{I}_{L}+\cdots\label{eq:HamitonianTensorProduct}
\end{equation}

\end_inset

This may look tedious but I need to write these tensor product out explicitly
 until I gain experience working with these ideas.
 So how do we map the first term in eq.
 
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:HamitonianTensorProduct"
plural "false"
caps "false"
noprefix "false"

\end_inset

 as something like eq.
 
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:OpValuedMatrix"
plural "false"
caps "false"
noprefix "false"

\end_inset

? We apparently need 
\begin_inset Formula $D_{W}=3+2=5$
\end_inset

 because we have three non-commuting terms.
\end_layout

\begin_layout Standard
It turns out we can write
\begin_inset Formula 
\begin{equation}
\boldsymbol{W}^{1}=\begin{bmatrix}0, & \frac{1}{2}\hat{S}_{-}^{1} & \frac{1}{2}\hat{S}_{+}^{1}, & \hat{S}_{z}^{1}, & \mathbb{I}^{1}\end{bmatrix}\label{eq:W1forH}
\end{equation}

\end_inset


\begin_inset Formula 
\begin{equation}
\boldsymbol{W}^{2}=\begin{bmatrix}\mathbb{I}^{2} & 0 & 0 & 0 & 0\\
\hat{S}_{+}^{2} & 0 & 0 & 0 & 0\\
\hat{S}_{-}^{2} & 0 & 0 & 0 & 0\\
\hat{S}_{z}^{2} & 0 & 0 & 0 & 0\\
0 & \frac{1}{2}\hat{S}_{-}^{2} & \frac{1}{2}\hat{S}_{+}^{2} & \hat{S}_{z}^{2} & \mathbb{I}^{2}
\end{bmatrix}\label{eq:W2forH}
\end{equation}

\end_inset

 Now
\begin_inset Formula 
\[
\hat{\boldsymbol{W}^{1}}\hat{\boldsymbol{W}^{2}}=\begin{bmatrix}\frac{1}{2}\hat{S}_{-}^{1}\otimes\hat{S}_{+}^{2}+\frac{1}{2}\hat{S}_{+}^{1}\otimes\hat{S}_{-}^{2}+\hat{S}_{z}^{1}\otimes\hat{S}_{z}^{2}, & \mathbb{I}^{1}\otimes\frac{1}{2}\hat{S}_{-}^{2}, & \mathbb{I}^{1}\otimes\frac{1}{2}\hat{S}_{+}^{2}, & \mathbb{I}^{1}\otimes & \hat{S}_{z}^{2}, & \mathbb{I}^{1}\otimes\mathbb{I}^{2}\end{bmatrix}
\]

\end_inset

We can now right multiply the row vector by 
\begin_inset Formula $\hat{\boldsymbol{W}^{3}}$
\end_inset

 and get three more terms in the first element for the interactions between
 sites 
\begin_inset Formula $2$
\end_inset

 and 
\begin_inset Formula $3$
\end_inset

.
 Finally with 
\begin_inset Formula 
\begin{equation}
\boldsymbol{W}^{L}=\begin{bmatrix}\mathbb{I}^{L}\\
\hat{S}_{+}^{L}\\
\hat{S}_{-}^{L}\\
\hat{S}_{z}^{L}\\
0
\end{bmatrix}\label{eq:W4forH}
\end{equation}

\end_inset

the whole thing zips up to a scalar which is the Hamiltonian.
\end_layout

\begin_layout Subsection
One site spin MPO
\end_layout

\begin_layout Standard
If we want to calculate one site expectations like
\begin_inset Formula 
\[
\left\langle \vec{S}^{a}\right\rangle =\left(\left\langle S_{x}^{a}\right\rangle ,\left\langle S_{y}^{a}\right\rangle ,\left\langle S_{z}^{a}\right\rangle \right)
\]

\end_inset

how to represent this with an MPO? The first thing to keep in mind is the
 products of 
\begin_inset Formula $W$
\end_inset

's always contract to scalar, so the output is always a number not a vector
 or a number for each site.
 We can make an MPO that returns 
\begin_inset Formula $S_{x}$
\end_inset

 for site one
\begin_inset Formula 
\[
\boldsymbol{W}^{1x}=\begin{bmatrix}\hat{S}_{x}^{1}\end{bmatrix}
\]

\end_inset


\begin_inset Formula 
\[
\boldsymbol{W}^{a}=\begin{bmatrix}\mathbb{I}^{a}\end{bmatrix},\;a>1
\]

\end_inset

This becomes a little less pedantic a two site correlation
\begin_inset Formula 
\[
\left\langle S_{x}^{1}S_{x}^{2}\right\rangle 
\]

\end_inset

then
\begin_inset Formula 
\[
\boldsymbol{W}^{1x}=\begin{bmatrix}\hat{S}_{x}^{1}\end{bmatrix},\quad\boldsymbol{W}^{2x}=\begin{bmatrix}\hat{S}_{x}^{2}\end{bmatrix}
\]

\end_inset


\begin_inset Formula 
\[
\boldsymbol{W}^{a}=\begin{bmatrix}\mathbb{I}^{a}\end{bmatrix},\;a>2
\]

\end_inset


\end_layout

\begin_layout Subsection
Applying and MPO to an MPS
\end_layout

\begin_layout Standard
If we operate on an MPS state with and MPO we should get a new state
\begin_inset Formula 
\[
\left|\psi'\right\rangle =\hat{O}\left|\psi\right\rangle 
\]

\end_inset

The diagram for this operation is shown in figure 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:Applying-an-MPO"
plural "false"
caps "false"
noprefix "false"

\end_inset

 from which we can see how the MPS matrices are related.
\begin_inset Formula 
\[
M_{i_{a-1}i}^{\prime n_{a}}=M_{\left(w_{a-1}j_{a-1}\right)\left(w_{a}j_{a}\right)}^{\prime n_{a}}=\sum_{m_{a}}W_{w_{a-1}w_{a}}^{n_{a}m_{a}}M_{j_{a-1}j_{a}}^{m_{a}}
\]

\end_inset


\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout

\end_layout

\begin_layout Plain Layout
\begin_inset Graphics
	filename OperatorApply.png
	scale 50

\end_inset


\begin_inset Caption Standard

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "fig:Applying-an-MPO"

\end_inset

Applying an MPO to and MPS for a five site system
\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout

\end_layout

\end_inset


\end_layout

\begin_layout Section
Ground State
\end_layout

\begin_layout Standard
The energy expectation
\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
E=\left\langle n_{1}n_{2}\cdots n_{L}\right|\mathcal{\hat{H}}\left|m_{1}m_{2}\cdots m_{L}\right\rangle 
\]

\end_inset

can be expressed as a diagram shown in figure 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:OperatorContraction"
plural "false"
caps "false"
noprefix "false"

\end_inset

 where the squares represent the Hamiltonian MPO elements.
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\begin_inset Graphics
	filename OperatorExp.png
	scale 50

\end_inset


\begin_inset Caption Standard

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "fig:OperatorContraction"

\end_inset

Expectation of an operator
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Subsection
Variational Ground State Search
\end_layout

\begin_layout Standard
In order to find the ground state we must minimize this with respect to
 the wave function coefficients
\begin_inset Formula 
\[
\frac{\partial E}{\partial M^{n_{i}}}=0,\;i\in1..L.
\]

\end_inset

We also need to constrain the overlap to be unity, so we also need to add
 a Lagrange multiplier term
\begin_inset Formula 
\begin{equation}
\frac{\partial E}{\partial M^{n_{i}}}-\lambda\frac{\partial N}{\partial M^{n_{i}}}=0,\;i\in1..L.\label{eq:GSEquations}
\end{equation}

\end_inset

In the diagram this simply corresponds to deleting the site 
\begin_inset Formula $i$
\end_inset

 from contractions as shown in figure 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:NeffHeff"
plural "false"
caps "false"
noprefix "false"

\end_inset

.
 In the literature these terms are refereed to as 
\begin_inset Formula $H_{eff}$
\end_inset

 and 
\begin_inset Formula $N_{eff}$
\end_inset

 for site 
\begin_inset Formula $i$
\end_inset

, which are matrices with dimension 
\begin_inset Formula $D^{2}d$
\end_inset

.
 If one has already normalized to the left and right of site 
\begin_inset Formula $i$
\end_inset

 then 
\begin_inset Formula $N_{eff}$
\end_inset

 is already diagonal.
 A standard algorithm is to solve eq.
 
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:GSEquations"
plural "false"
caps "false"
noprefix "false"

\end_inset

 for site 
\begin_inset Formula $1$
\end_inset

 and replace 
\begin_inset Formula $M^{1}$
\end_inset

 with the new values, and then proceed through the lattice optimizing each
 site.
 One can also optimize two or more sites at once which improves the convergence
 rate but also requires solving much larger secular equations in eq.
 
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:GSEquations"
plural "false"
caps "false"
noprefix "false"

\end_inset

.
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout

\end_layout

\begin_layout Plain Layout
\begin_inset Graphics
	filename HeffNeff.png
	scale 50

\end_inset


\begin_inset Caption Standard

\begin_layout Plain Layout
a) 
\begin_inset Formula $N_{eff}$
\end_inset

 for site 3, b) 
\begin_inset Formula $H_{eff}$
\end_inset

 for site 3
\begin_inset CommandInset label
LatexCommand label
name "fig:NeffHeff"

\end_inset

.
\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout

\end_layout

\end_inset


\end_layout

\begin_layout Subsection
Time Evolution
\end_layout

\begin_layout Standard
Another method for finding the ground state is imaginary time evolution
 by applying the operator 
\begin_inset Formula $e^{-\beta\mathcal{\hat{H}}}$
\end_inset

 where 
\begin_inset Formula $\beta$
\end_inset

 is real and corresponds to an imaginary time interval.
\begin_inset Formula 
\[
\left|\psi\left(i\beta\right)\right\rangle =e^{-\beta\mathcal{\hat{H}}}\left|\psi\left(0\right)\right\rangle 
\]

\end_inset

In statistical mechanics the limit 
\begin_inset Formula $\beta=\frac{1}{kT}\rightarrow\infty$
\end_inset

 corresponds to the temperature going to zero.
 So it is like we are annealing the wave function towards its ground state.
 This sounds rather hand-waving but it is related to the power method for
 finding the extreme eigen value and eigen vector of a matrix.
 This is known to be a slowly converging method but it works as long as
 the original wave function (or some starting guess) has a non-zero overlap
 with the ground state wave function.
\end_layout

\begin_layout Subsubsection
Trotter Decomposition
\end_layout

\begin_layout Standard
In order to handle the operator 
\begin_inset Formula $e^{-\beta\mathcal{\hat{H}}}$
\end_inset

 we need break the time interval into small but finite intervals 
\begin_inset Formula $\beta=N\tau$
\end_inset

 and take the limit 
\begin_inset Formula $N\rightarrow\infty$
\end_inset

 and 
\begin_inset Formula $\tau\rightarrow0$
\end_inset

.
 For a nearest neighbour interacting system we can express the Hamiltonian
 as a sum of two site operators
\begin_inset Formula 
\[
\mathcal{\hat{H}}=\sum_{a=1}^{L-1}\vec{S}_{a}\cdot\vec{S}_{a+1}=\sum_{a=1}^{L-1}\hat{\mathcal{H}}_{a}
\]

\end_inset

Now the first order decomposition looks like
\begin_inset Formula 
\begin{equation}
e^{-\tau\mathcal{\hat{H}}}=e^{-\tau\mathcal{\hat{H}}_{1}}\otimes e^{-\tau\mathcal{\hat{H}}_{2}}\otimes e^{-\tau\mathcal{\hat{H}}_{3}}\otimes\cdots\otimes e^{-\tau\mathcal{\hat{H}}_{L-1}}+O\left(\tau^{2}\right)\label{eq:Trotter1}
\end{equation}

\end_inset

where 
\begin_inset Formula $\tau^{2}$
\end_inset

 correction arises because the neighbouring Hamiltonian operators do not
 commute
\begin_inset Formula 
\[
\left[\mathcal{\hat{H}}_{i},\mathcal{\hat{H}}_{i+1}\right]\neq0
\]

\end_inset

However further neighbours do commute 
\begin_inset Formula 
\[
\left[\mathcal{\hat{H}}_{i},\mathcal{\hat{H}}_{i+2}\right]=0
\]

\end_inset

Note that I am using tensor products in eq 
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:Trotter1"
plural "false"
caps "false"
noprefix "false"

\end_inset

 to make it clear the we are really building a huge 
\begin_inset Formula $d^{N}$
\end_inset

 matrix from a sequence of 
\begin_inset Formula $d^{2}$
\end_inset

 matrices.
 Since they commute we can group all the even operators and update the even
 sites in one step, and then do the same with the odd sites.
 I call this a spatial decomposition.
 
\begin_inset Formula 
\[
e^{-\tau\mathcal{\hat{H}}}=e^{-\tau\mathcal{\hat{H}}_{odd}}e^{-\tau\mathcal{\hat{H}}_{even}}+O\left(\tau^{2}\right)
\]

\end_inset


\end_layout

\begin_layout Standard
What do we do if there are interactions beyond nearest neighbour? Well if
 there are only a few further neighbour interactions then one can still
 gather the sites into mutually commuting groups, there will just be more
 than two groups that's all.
 But another option is to divide system in spin space
\begin_inset Formula 
\[
\hat{H}=\hat{H}_{x}+\hat{H}_{y}+\hat{H}_{z}
\]

\end_inset

 where for example 
\begin_inset Formula 
\[
\hat{H}_{x}=\sum_{a=1}^{L-1}S_{a}^{x}S_{a+1}^{x}
\]

\end_inset

and
\begin_inset Formula 
\[
e^{-\tau\mathcal{\hat{H}}}=e^{-\tau\mathcal{\hat{H}}_{x}}e^{-\tau\mathcal{\hat{H}}_{y}}e^{-\tau\mathcal{\hat{H}}_{z}}+O\left(\tau^{2}\right)
\]

\end_inset

Can we do better than 
\begin_inset Formula $O\left(\tau^{2}\right)?$
\end_inset

 Absolutely yes, examples of higher order options are 
\begin_inset Formula 
\[
e^{-\tau\mathcal{\hat{H}}}=e^{-\frac{\tau}{2}\mathcal{\hat{H}}_{odd}}e^{-\tau\mathcal{\hat{H}}_{even}}e^{-\frac{\tau}{2}\mathcal{\hat{H}}_{odd}}+O\left(\tau^{3}\right)
\]

\end_inset


\begin_inset Formula 
\[
e^{-\tau\mathcal{\hat{H}}}=U\left(\tau_{1}\right)U\left(\tau_{2}\right)U\left(\tau_{3}\right)U\left(\tau_{2}\right)U\left(\tau_{1}\right)+O\left(\tau^{5}\right)
\]

\end_inset

where
\begin_inset Formula 
\[
U\left(\tau\right)=e^{-\frac{\tau}{2}\mathcal{\hat{H}}_{odd}}e^{-\tau\mathcal{\hat{H}}_{even}}e^{-\frac{\tau}{2}\mathcal{\hat{H}}_{odd}}
\]

\end_inset

and
\begin_inset Formula 
\[
\tau_{1}=\tau_{2}=\frac{1}{4-\sqrt[3]{4}}\tau,\;\tau_{3}=\tau-2\tau_{1}-2\tau_{2}
\]

\end_inset


\end_layout

\begin_layout Subsubsection
MPO representation
\begin_inset CommandInset label
LatexCommand label
name "subsec:MPO-representation"

\end_inset


\end_layout

\begin_layout Standard
A trotter step for all odd bonds on a chain looks like
\begin_inset Formula 
\[
e^{-\tau\mathcal{\hat{H}}_{1}}\otimes e^{-\tau\mathcal{\hat{H}}_{3}}\otimes e^{-\tau\mathcal{\hat{H}}_{5}}\otimes\cdots\otimes e^{-\tau\mathcal{\hat{H}}_{L-1}}\left|\psi\right\rangle 
\]

\end_inset

where I am using the tensor product symbol to make it explicit that each
 term in the product operates on a different sector of the the Hilbert space.
 One bond evolution operator has the form
\begin_inset Formula 
\begin{equation}
e^{-\tau\mathcal{\hat{H}}_{1}}=\sum_{m_{1}m_{2}}\sum_{n_{1}n_{2}}O^{\left(m_{1}m_{2}\right)\left(n_{1}n_{2}\right)}\left|n_{1}n_{2}\right\rangle \left\langle m_{1}m_{2}\right|\label{eq:One Bond Operator}
\end{equation}

\end_inset

and we can think of 
\begin_inset Formula $O$
\end_inset

 as a 
\begin_inset Formula $d^{2}\times d^{2}$
\end_inset

 matrix.
 We need to evaluate matrix elements
\begin_inset Formula 
\[
O^{\left(m_{1}m_{2}\right)\left(n_{1}n_{2}\right)}=\left\langle m_{1}m_{2}\right|e^{-\tau\mathcal{\hat{H}}_{1}}\left|n_{1}n_{2}\right\rangle 
\]

\end_inset

which I suppose we can do by Taylor expansion
\begin_inset Formula 
\[
\left\langle m_{1}m_{2}\right|e^{-\tau\mathcal{\hat{H}}_{1}}\left|n_{1}n_{2}\right\rangle =\left\langle m_{1}m_{2}\right|1-\tau\mathcal{\hat{H}}_{1}\left|n_{1}n_{2}\right\rangle +O\left(\tau^{2}\right)
\]

\end_inset


\begin_inset Formula 
\[
=\delta_{m_{1}n_{1}}\delta_{m_{2}n_{2}}-\tau\left\langle m_{1}m_{2}\right|\mathcal{\hat{H}}_{1}\left|n_{1}n_{2}\right\rangle +O\left(\tau^{2}\right)
\]

\end_inset

This may be fine for first order trotter decomposition since that also throws
 away corrections of 
\begin_inset Formula $O(\tau^{2})$
\end_inset

.
 But what then for higher order decompositions? We can calculate 
\begin_inset Formula $O$
\end_inset

 exactly by and eigen decomposition of 
\begin_inset Formula $\hat{H_{1}}$
\end_inset

 which should be tractable because this is a local 
\begin_inset Formula $d^{2}\times d^{2}$
\end_inset

 Hamiltonian.
\begin_inset Formula 
\[
O^{\left(m_{1}m_{2}\right)\left(n_{1}n_{2}\right)}=O^{ij}=\left\langle i\right|e^{-\tau\mathcal{\hat{H}}_{1}}\left|j\right\rangle 
\]

\end_inset

we can use the identity (see appendix 
\begin_inset CommandInset ref
LatexCommand ref
reference "sec:Exponential-of-an Operator"
plural "false"
caps "false"
noprefix "false"

\end_inset

 )
\begin_inset Formula 
\[
e^{-\tau\mathcal{\hat{H}}_{1}}=Ue^{-\tau\mathcal{\hat{\lambda}}}U^{\dagger}
\]

\end_inset


\begin_inset Formula 
\[
O^{ij}=\sum_{k}U^{ik}e^{-\tau\lambda_{k}}\left(U^{\dagger}\right)^{kj}
\]

\end_inset


\begin_inset Formula 
\begin{equation}
=\sum_{k}U^{ik}e^{-\tau\lambda_{k}}U^{*jk}\label{eq:EigenO}
\end{equation}

\end_inset

This looks like it is factored but it is factored in the wrong direction
 since 
\begin_inset Formula $i=\left(m_{1}m_{2}\right)$
\end_inset

 and 
\begin_inset Formula $j=\left(n_{1}n_{2}\right)$
\end_inset

.
\end_layout

\begin_layout Standard
In order for this to look like an MPO we need to reshape 
\begin_inset Formula $O$
\end_inset

 in the form
\begin_inset Formula 
\[
O^{\left(m_{1}m_{2}\right)\left(n_{1}n_{2}\right)}\Rightarrow O^{\left(n_{1}m_{1}\right)\left(n_{2}m_{2}\right)}
\]

\end_inset

so that it is by site number rather then by bra and ket quantum numbers.
 And then do an SVD decomposition
\begin_inset Formula 
\[
O^{\left(n_{1}m_{1}\right)\left(n_{2}m_{2}\right)}=\sum_{k=1}^{d^{2}}U_{\left(n_{1}m_{1}\right),k}s_{k}\left(V^{\dagger}\right)_{k,\left(n_{2}m_{2}\right)}
\]

\end_inset

and we absorb the singular values in both directions
\begin_inset Formula 
\[
W_{1w}^{m_{1}n_{1}}=U_{\left(n_{1}m_{1}\right),w}\sqrt{s_{w}}
\]

\end_inset


\begin_inset Formula 
\[
W_{w1}^{m_{2}n_{2}}=\sqrt{s_{w}}\left(V^{\dagger}\right)_{w,\left(n_{2}m_{2}\right)}
\]

\end_inset

For lower spins it is easy to calculate these symbolically, but I think
 there is no advantage in this.
 We need only calculate 
\begin_inset Formula $W$
\end_inset

's once for any given value of 
\begin_inset Formula $\tau$
\end_inset

 so we might as well just do them numerically.
 Also one pair of 
\begin_inset Formula $W$
\end_inset

's works for all bonds on the lattice.
 So the algorithm is
\end_layout

\begin_layout Enumerate
Build 
\begin_inset Formula $H_{1}^{\left(m_{1}m_{2}\right)\left(n_{1}n_{2}\right)}=\left\langle m_{1}m_{2}\right|\mathcal{\hat{H}}_{1}\left|n_{1}n_{2}\right\rangle $
\end_inset


\end_layout

\begin_layout Enumerate
Do a full eigen decomposition 
\begin_inset Formula $H_{1}^{\left(m_{1}m_{2}\right)\left(n_{1}n_{2}\right)}=\sum_{k}U^{\left(m_{1}m_{2}\right)k}\lambda_{k}U^{\dagger k\left(n_{1}n_{2}\right)}$
\end_inset

 and cache 
\begin_inset Formula $U,\lambda$
\end_inset

.
\end_layout

\begin_layout Enumerate
For each 
\begin_inset Formula $\tau$
\end_inset

 evaluate 
\begin_inset Formula $O^{\left(m_{1}m_{2}\right)\left(n_{1}n_{2}\right)}\left(\tau\right)=\sum_{k}U^{\left(m_{1}m_{2}\right)k}e^{\lambda_{k}}U^{\dagger k\left(n_{1}n_{2}\right)}$
\end_inset


\end_layout

\begin_layout Enumerate
reshape 
\begin_inset Formula $O^{\left(m_{1}m_{2}\right)\left(n_{1}n_{2}\right)}\Rightarrow O^{\left(n_{1}m_{1}\right)\left(n_{2}m_{2}\right)}$
\end_inset


\end_layout

\begin_layout Enumerate
SVD 
\begin_inset Formula $O^{\left(n_{1}m_{1}\right)\left(n_{2}m_{2}\right)}=\sum_{k=1}^{d^{2}}U_{\left(n_{1}m_{1}\right),k}s_{k}\left(V^{\dagger}\right)_{k,\left(n_{2}m_{2}\right)}$
\end_inset

, note that this a new/different 
\begin_inset Formula $U$
\end_inset


\end_layout

\begin_layout Enumerate
Assign 
\begin_inset Formula $W_{1w}^{m_{1}n_{1}}=U_{\left(n_{1}m_{1}\right),w}\sqrt{s_{w}}$
\end_inset

 and 
\begin_inset Formula $W_{w1}^{m_{2}n_{2}}=\sqrt{s_{w}}\left(V^{\dagger}\right)_{w,\left(n_{2}m_{2}\right)}$
\end_inset


\end_layout

\begin_layout Standard
Steps 1 and 2 can be done once only and the remaining steps need to be repeated
 for each new value of 
\begin_inset Formula $\tau$
\end_inset

, which typically decreases as convergence proceeds.
\end_layout

\begin_layout Subsubsection
SVD compression
\begin_inset CommandInset label
LatexCommand label
name "subsec:SVD-compression"

\end_inset


\end_layout

\begin_layout Standard
If the starting wave function has bond dimension 
\begin_inset Formula $D$
\end_inset

 then after one operation with 
\begin_inset Formula $e^{-\tau\mathcal{\hat{H}}}$
\end_inset

 it will have bond dimension 
\begin_inset Formula $D_{w}D=d^{2}D$
\end_inset

 which is clearly not sustainable over many iterations.
 The simplest option for compressing back down to bond dimension 
\begin_inset Formula $D$
\end_inset

 is truncate the summation in eq, 
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:SVDDecomp"
plural "false"
caps "false"
noprefix "false"

\end_inset


\begin_inset Formula 
\[
M_{(i_{a-1},n_{1})i_{a}}=\boldsymbol{UsV}=\sum_{j_{a}}^{D_{w}D}U_{\left(i_{a-1},n_{a}\right)j_{a}}s_{j_{a}j_{a}}V_{j_{a}i_{a}}
\]

\end_inset


\begin_inset Formula 
\[
\approx\tilde{M}_{(i_{a-1},n_{1})i_{a}}=\sum_{j_{a}}^{D}U_{\left(i_{a-1},n_{a}\right)j_{a}}s_{j_{a}j_{a}}V_{j_{a}i_{a}}
\]

\end_inset

where the 
\begin_inset Formula $\left(d^{2}-1\right)D$
\end_inset

 smallest singular values have been discarded.
 Here were are using the convention that 
\begin_inset Formula $\tilde{M}$
\end_inset

 and 
\begin_inset Formula $\tilde{\psi}$
\end_inset

 symbols are used for the compressed state.
 This can be carried out while right or left normalizing full state by only
 keeping the first 
\begin_inset Formula $D$
\end_inset

 columns when assigning 
\begin_inset Formula $U$
\end_inset

 to 
\begin_inset Formula $A$
\end_inset

 in eq 
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:Uassign"
plural "false"
caps "false"
noprefix "false"

\end_inset

 and eq.
 
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:Uassign1"
plural "false"
caps "false"
noprefix "false"

\end_inset

 and store 
\begin_inset Formula $\tilde{A}$
\end_inset

 separately for the each site.
 And similarly for assigning rows of 
\begin_inset Formula $V$
\end_inset

 to 
\begin_inset Formula $\tilde{B}$
\end_inset

 for right normalization.
 
\end_layout

\begin_layout Standard
Schollwoeck
\begin_inset CommandInset citation
LatexCommand cite
key "schollwoeck_density-matrix_2010"
literal "false"

\end_inset

 (page 108) talks about re-scaling the singular values in order maintain
 normalization but leaves out the details.
 Since the truncation error is defined in terms of squares 
\begin_inset Formula $\epsilon=\sqrt{\sum_{k=D+1}^{D_{w}D}s_{k}^{2}}$
\end_inset

 I can think of three ways to re-scale
\begin_inset Formula 
\[
\tilde{s}_{k}=s_{k}\frac{\sum_{i=1}^{D_{w}D}s_{i}}{\sum_{i=1}^{d}s_{i}}
\]

\end_inset

or
\begin_inset Formula 
\[
\tilde{s}_{k}=s_{k}\frac{\sum_{i=1}^{D_{w}D}s_{i}^{2}}{\sum_{i=1}^{d}s_{i}^{2}}
\]

\end_inset

or
\begin_inset Formula 
\[
\tilde{s}_{k}=s_{k}\frac{\sqrt{\sum_{i=1}^{D_{w}D}s_{i}^{2}}}{\sqrt{\sum_{i=1}^{d}s_{i}^{2}}}
\]

\end_inset


\end_layout

\begin_layout Standard
SVD compression is not optimal, but it provides a good guess for the optimizatio
n algorithm in the section below.
\end_layout

\begin_layout Subsubsection
Optimal compression
\begin_inset CommandInset label
LatexCommand label
name "subsec:Optimal-compression"

\end_inset


\end_layout

\begin_layout Standard
An alternate approach is to minimize the distance in Hilbert space
\begin_inset Formula 
\[
\left\Vert \psi-\tilde{\psi}\right\Vert ^{2}
\]

\end_inset

where 
\begin_inset Formula $\psi$
\end_inset

 has bond dimension 
\begin_inset Formula $D_{w}D$
\end_inset

 and 
\begin_inset Formula $\tilde{\psi}$
\end_inset

 has reduced bond dimension 
\begin_inset Formula $D$
\end_inset

.
 This gives the best possible wave function for a given reduced bond dimension.
 Expanding and differentiating WRT 
\begin_inset Formula $M^{a*}$
\end_inset

 (which only appears in 
\begin_inset Formula $\left\langle \tilde{\psi}\right|$
\end_inset

)
\begin_inset Formula 
\[
\frac{\partial}{\partial\tilde{M}^{a*}}\left(\left\langle \psi|\psi\right\rangle -\left\langle \psi|\tilde{\psi}\right\rangle -\left\langle \tilde{\psi}|\psi\right\rangle +\left\langle \tilde{\psi}|\tilde{\psi}\right\rangle \right)=0
\]

\end_inset


\begin_inset Formula 
\[
\frac{\partial}{\partial\tilde{M}^{a*}}\left(\left\langle \tilde{\psi}|\tilde{\psi}\right\rangle -\left\langle \tilde{\psi}|\psi\right\rangle \right)=0.
\]

\end_inset

This results in a linear system for an improved version of 
\begin_inset Formula $\tilde{M}^{a}$
\end_inset


\begin_inset Formula 
\[
\sum_{j_{a-1}j_{a}}\tilde{O}_{\left(i_{a-1}i_{a}\right)\left(j_{a-1}j_{a}\right)}\tilde{M}_{j_{a-1}j_{a}}^{n_{a}}=O_{i_{a-1}i_{a}}^{n_{a}}
\]

\end_inset

see Schollwoeck page 132-133 for details.
 This can be vastly simplified if we use a normalized state with the 
\begin_inset Formula $\cdots AAAAMBBB\cdots$
\end_inset

 form.
 Then
\begin_inset Formula 
\[
\tilde{M}_{i_{a-1}i_{a}}^{n_{a}}=\sum_{j_{a-1}}^{D_{w}D_{1}}L_{i_{a-1}j_{a-1}}\left(\sum_{j_{a}}^{D_{w}D_{2}}R_{i_{a}j_{a}}M_{j_{a-1}j_{a}}^{n_{a}}\right)
\]

\end_inset

where
\begin_inset Formula 
\[
L_{i_{a-1}j_{a-1}}=\sum_{n_{a-1}}\boldsymbol{\tilde{M}}^{n_{a-1}^{\dagger}}\left(\cdots\left(\sum_{n_{1}}\boldsymbol{\tilde{M}}^{n_{1}^{\dagger}}\boldsymbol{M}^{n_{1}}\right)\cdots\right)\boldsymbol{M}^{n_{a-1}}
\]

\end_inset


\begin_inset Formula 
\[
R_{i_{a}j_{a}}=\sum_{n_{a+1}}\boldsymbol{M}^{n_{a+1}}\left(\cdots\left(\sum_{n_{L}}\boldsymbol{M}^{n_{L}}\boldsymbol{\tilde{M}}^{n_{L}^{\dagger}}\right)\cdots\right)\boldsymbol{\tilde{M}}^{n_{a+1}^{\dagger}}
\]

\end_inset

where 
\begin_inset Formula $L$
\end_inset

should have limits 
\begin_inset Formula $\left(D_{1},D_{w}D_{1}\right)$
\end_inset

 and 
\begin_inset Formula $R$
\end_inset

 should have limits 
\begin_inset Formula $\left(D_{2},D_{w}D_{2}\right)$
\end_inset


\end_layout

\begin_layout Standard
In code this is presented 
\noun on
MatrixProductSite.H
\noun default
 as the function
\begin_inset listings
inline false
status open

\begin_layout Plain Layout

MatrixCT ContractLRM(int na) const;
\end_layout

\end_inset

 This is very similar to the lattice sweeps used in the a ground state calculati
on.
 
\end_layout

\begin_layout Subsubsection
Convergence
\end_layout

\begin_layout Standard
We monitor
\begin_inset Formula 
\[
\left\Vert \psi-\tilde{\psi}\right\Vert ^{2}=\left\langle \psi|\psi\right\rangle -\left\langle \psi|\tilde{\psi}\right\rangle -\left\langle \tilde{\psi}|\psi\right\rangle +\left\langle \tilde{\psi}|\tilde{\psi}\right\rangle 
\]

\end_inset


\begin_inset Formula 
\[
=1-R^{[1]}-L^{[L\}}+\sum_{n_{l}}\boldsymbol{\tilde{M}}^{n_{L}^{\dagger}}\left(\cdots\left(\sum_{n_{1}}\boldsymbol{\tilde{M}}^{n_{1}^{\dagger}}\boldsymbol{\tilde{M}}^{n_{1}}\right)\cdots\right)\boldsymbol{\tilde{M}}^{n_{L}}
\]

\end_inset

It looks like the cross terms vanish.
\end_layout

\begin_layout Subsubsection
Full compression Algorithm
\end_layout

\begin_layout Standard
Finally the full compression algorithm is
\end_layout

\begin_layout Enumerate
Right normalize 
\begin_inset Formula $\left|\psi\right\rangle $
\end_inset

 and at the same time build an SVD compressed version of 
\begin_inset Formula $\left|\tilde{\psi}\right\rangle $
\end_inset

.
 For each site 
\begin_inset Formula $a$
\end_inset

 do
\end_layout

\begin_deeper
\begin_layout Enumerate
Only assign 
\begin_inset Formula $D$
\end_inset

 rows of 
\begin_inset Formula $V^{a}$
\end_inset

 to 
\begin_inset Formula $\tilde{B^{a}}$
\end_inset


\end_layout

\begin_layout Enumerate
For each site 
\begin_inset Formula $a$
\end_inset

 cache
\begin_inset Formula 
\[
\tilde{L}_{i_{a-1}i_{a}}=\sum_{n_{a-1}}\boldsymbol{\tilde{M}}^{n_{a-1}^{\dagger}}\left(\cdots\left(\sum_{n_{1}}\boldsymbol{\tilde{M}}^{n_{1}^{\dagger}}\boldsymbol{M}^{n_{1}}\right)\cdots\right)\boldsymbol{M}^{n_{a-1}}
\]

\end_inset


\begin_inset Formula 
\[
\tilde{R}_{i_{a}i_{a+1}}=\sum_{n_{a+1}}\boldsymbol{M}^{n_{a+1}}\left(\cdots\left(\sum_{n_{L}}\boldsymbol{M}^{n_{L}}\boldsymbol{\tilde{M}}^{n_{L}^{\dagger}}\right)\cdots\right)\boldsymbol{\tilde{M}}^{n_{a+1}^{\dagger}}
\]

\end_inset


\end_layout

\end_deeper
\begin_layout Enumerate
Perform a second sweep through the lattice and optimize 
\begin_inset Formula $\left|\tilde{\psi}\right\rangle $
\end_inset

 with
\begin_inset Formula 
\begin{equation}
\tilde{M}_{i_{a-1}i_{a}}^{n_{a}}=\sum_{j_{a-1}}\tilde{L}_{i_{a-1}j_{a-1}}\left(\sum_{j_{a}}\tilde{R}_{i_{a}j_{a}}M_{j_{a-1}j_{a}}^{n_{a}}\right)\label{eq:Mtilda}
\end{equation}

\end_inset


\end_layout

\begin_layout Enumerate
Check convergence of
\begin_inset Formula 
\[
\left\Vert \psi-\tilde{\psi}\right\Vert ^{2}=1-\sum_{\left\{ n\right\} }Tr\left(\tilde{M}^{n_{a}\dagger}\tilde{M}^{n_{a}}\right)
\]

\end_inset


\end_layout

\begin_layout Enumerate
Loop to step 2
\end_layout

\begin_layout Enumerate
Normalize 
\begin_inset Formula $\left|\tilde{\psi}\right\rangle $
\end_inset


\begin_inset Formula 
\[
\left|\tilde{\psi}\right\rangle =\frac{1}{\sum_{\left\{ n\right\} }Tr\left(\tilde{M}^{n_{a}\dagger}\tilde{M}^{n_{a}}\right)}\left|\tilde{\psi}\right\rangle 
\]

\end_inset


\end_layout

\begin_layout Subsection
Time Evolved Block Decimation
\end_layout

\begin_layout Standard
We start with the canonical form but with a two site center
\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
\Gamma^{n_{1}}\lambda^{[1]}\Gamma^{n_{2}}\lambda^{[2]}\ldots\lambda^{[a]}\Gamma^{n_{a+1}}\lambda^{[a+1]}\Gamma^{n_{a+2}}\lambda^{[a+2]}\ldots\lambda^{[L-1]}\Gamma^{n_{L}}
\]

\end_inset

and we can apply the local evolution operator (
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:One Bond Operator"
plural "false"
caps "false"
noprefix "false"

\end_inset

)
\begin_inset Formula 
\[
\Phi_{i_{a}i_{a+2}}^{m_{a+1}m_{a+2}}=\sum_{n_{a+1}n_{a+2}}\sum_{i_{a+1}}\hat{O}^{\left(n_{a+1}m_{a+1}\right)\left(n_{a+2}m_{a+2}\right)}\lambda_{i_{a}}^{[a]}\Gamma_{i_{a}i_{a+1}}^{n_{a+1}}\lambda_{i_{a+1}}^{[a+1]}\Gamma_{i_{a+1}i_{a+2}}^{n_{a+2}}\lambda_{i_{a+2}}^{[a+2]}
\]

\end_inset

Or using the MPO representation
\begin_inset Formula 
\[
\Phi_{i_{a}i_{a+2}}^{m_{a+1}m_{a+2}}=\sum_{n_{a+1}n_{a+2}}\sum_{i_{a+1}}\sum_{w}W_{1,w}^{n_{a+1}m_{a+1}}W_{w,1}^{n_{a+2}m_{a+2}}\lambda_{i_{a}}^{[a]}\Gamma_{i_{a}i_{a+1}}^{n_{a+1}}\lambda_{i_{a+1}}^{[a+1]}\Gamma_{i_{a+1}i_{a+2}}^{n_{a+2}}\lambda_{i_{a+2}}^{[a+2]}
\]

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\begin_inset Graphics
	filename TEBD1.png
	scale 50

\end_inset


\begin_inset Caption Standard

\begin_layout Plain Layout
Two site MPO acting on sites 
\begin_inset Formula $a+1$
\end_inset

 and 
\begin_inset Formula $a+2$
\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout

\end_layout

\end_inset


\end_layout

\begin_layout Section
Infinite Lattice Systems
\end_layout

\begin_layout Standard
In order to estimate physics for infinite systems one must somehow extrapolate
 both 
\begin_inset Formula $L\rightarrow\infty$
\end_inset

 and 
\begin_inset Formula $D\rightarrow\infty$
\end_inset

.
 Another approach is to represent the wave function as an infinite product
 of some repeating unit cell.
 For example if the unit cell is four lattice sites (corresponding to a
 wave vector 
\begin_inset Formula $k=\nicefrac{1}{4}$
\end_inset

) the matrix product would look like
\begin_inset Formula 
\[
\ldots\boldsymbol{M}^{[1]n_{1}}\boldsymbol{M}^{[2]n_{2}}\boldsymbol{M}^{[3]n_{3}}\boldsymbol{M}^{[4]n_{4}}\boldsymbol{M}^{[1]n_{5}}\boldsymbol{M}^{[2]n_{6}}\boldsymbol{M}^{[3]n_{7}}\boldsymbol{M}^{[4]n_{8}}\ldots
\]

\end_inset

where the ellipsis represent infinite repeat of the unit cell to the left
 and right.
 Notice there are only four distinct matrices but the quantum numbers 
\begin_inset Formula $n_{i}$
\end_inset

 do not repeat, there are infinitely many 
\begin_inset Formula $n_{i}$
\end_inset

.
 Hence the need for proper site labels 
\begin_inset Formula $[a]$
\end_inset

 in the square brackets.
 In this example the site labels to the left could take on negative values.
 Standard notation is put the repeating unit cell in brackets
\begin_inset Formula 
\begin{equation}
\ldots\left(\boldsymbol{M}^{[1]n_{1}}\boldsymbol{M}^{[2]n_{2}}\boldsymbol{M}^{[3]n_{3}}\boldsymbol{M}^{[4]n_{4}}\right)\ldots\label{eq:iMPS1}
\end{equation}

\end_inset

the corresponding wave function is
\begin_inset Formula 
\begin{equation}
\left|\psi\right\rangle =\sum_{\ldots n_{1}n_{2}n_{3}n_{4}\ldots}\ldots\left(\boldsymbol{M}^{[1]n_{1}}\boldsymbol{M}^{[2]n_{2}}\boldsymbol{M}^{[3]n_{3}}\boldsymbol{M}^{[4]n_{4}}\right)\ldots\left|\ldots n_{1}n_{2}n_{3}n_{4}\ldots\right\rangle \label{eq:iMPSWF}
\end{equation}

\end_inset

One draw back of this idea is that part of the answer is already built into
 the choice unit cell.
 So for a ferromagnet we know in advance that a one site unit cell is sufficient
 to the present the answer.
 For an unfrustrated antiferromagnet we know in advance that a two site
 unit cell should suffice.
 But if there are any competing interactions the choice of unit cell become
 non-trivial.
 In this case I think it is prudent to see what(which) wave vector(s) is(are)
 selected by minimizing the Fourier transformed Hamiltonian and use that
 as a starting point for the quantum problem.
 Hopefully the ordering wave vector is a rational number!!
\end_layout

\begin_layout Standard
So far what we have above is called iMPS.
 The two common approaches to finding a ground state using iMPS are iDMRG
 and iTBED.
 
\end_layout

\begin_layout Section
Infinite Lattice Contractions
\end_layout

\begin_layout Standard
In this section I will use a two site unit cell iMPS.
 The extension to other unit cell size should be trivial.
\end_layout

\begin_layout Subsection
Overlap
\end_layout

\begin_layout Standard
The diagram for the overlap of a two site unit cell iMPS is shown in figure
 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:iMPS Overlap"
plural "false"
caps "false"
noprefix "false"

\end_inset

a.
\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout

\end_layout

\begin_layout Plain Layout
\begin_inset Graphics
	filename iMPS1.png
	scale 50

\end_inset


\begin_inset Graphics
	filename iMPSTransfer.png
	scale 50

\end_inset


\begin_inset Caption Standard

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "fig:iMPS Overlap"

\end_inset

a) iMPS for a 2 site unit cell in canonical form.
 b) Transfer matrix for site 1
\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout

\end_layout

\end_inset


\end_layout

\begin_layout Standard
The transfer matrix for site 
\begin_inset Formula $1$
\end_inset

 (figure 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:iMPS Overlap"
plural "false"
caps "false"
noprefix "false"

\end_inset

b) is
\begin_inset Formula 
\[
E_{r\left(i_{1}j_{1}\right)\left(i_{2}j_{2}\right)}=\sum_{n}M_{i_{i}i_{2}}^{n}\left(M_{j_{2}j_{1}}^{n}\right)^{\dagger}=\sum_{n_{1}}\varGamma_{i_{1}i_{2}}^{n}\lambda_{i_{2}}\left(\varGamma_{j_{2}j_{1}}^{n}\lambda_{j_{1}}\right)^{\dagger}=\sum_{n_{1}}\varGamma_{i_{1}i_{2}}^{n}\lambda_{i_{2}}\left(\lambda_{j_{1}}\varGamma_{j_{1}j_{2}}^{n}\right)^{*}
\]

\end_inset

where the indices are grouped to shape this as a 
\begin_inset Formula $D^{2}\times D^{2}$
\end_inset

 matrix, as opposed to a rank four tensor.
 Now the overlap can be expressed as a matrix product
\begin_inset Formula 
\[
\left\langle \psi|\psi\right\rangle =\ldots\boldsymbol{E}^{1}\boldsymbol{E}^{2}\boldsymbol{E}^{1}\boldsymbol{E}^{2}\ldots
\]

\end_inset

Strictly speaking this expression is not a scalar but just wait.
 To proceed we can do an eigen decomposition of the repeating product 
\begin_inset Formula $\boldsymbol{E}^{1}\boldsymbol{E}^{2}=\boldsymbol{U}_{R}^{-1}\boldsymbol{e}\boldsymbol{U}_{R}$
\end_inset


\begin_inset Formula 
\[
\left\langle \psi|\psi\right\rangle =\boldsymbol{U}_{R}^{-1}\lim_{N\rightarrow\infty}\boldsymbol{e}^{N}\boldsymbol{U}_{R}
\]

\end_inset

which is matrix of eigen values to the high power.
 Of course all the eigen modes are irrelevant except for dominant one so
 the 
\begin_inset Formula $U$
\end_inset

s cancel and in the end we get 
\begin_inset Formula 
\[
\left\langle \psi|\psi\right\rangle =\lim_{N\rightarrow\infty}e_{max}^{N}
\]

\end_inset

So we can easily normalize an iMPS by re-scaling the 
\begin_inset Formula $\varGamma$
\end_inset

 matrices
\begin_inset Formula 
\[
\varGamma\rightarrow\frac{1}{\sqrt{e_{max}}}\varGamma
\]

\end_inset

which should ensure that the new 
\begin_inset Formula $e_{max}=1$
\end_inset

.
\end_layout

\begin_layout Subsection
Infinite Matrix Product Operator (iMPO)
\end_layout

\begin_layout Standard
In its simplest form and iMPO is just a infinite product of one MPO with
 the only thing distinguishing sites is the label of the physical indices.
\begin_inset Formula 
\[
\hat{O}=\cdots\hat{\boldsymbol{W}}^{m_{1}n_{1}}\hat{\boldsymbol{W}}^{m_{2}n_{2}}\hat{\boldsymbol{W}}^{m_{3}n_{3}}\cdots
\]

\end_inset

where the internal indices 
\begin_inset Formula $W_{ij}$
\end_inset

 have been suppressed.
 This is what I would call a one site unit cell iMPO and extension to two
 or more sites is also possible.
 
\end_layout

\begin_layout Standard
The literature on iMPOs is relatively recent and starts with
\begin_inset CommandInset citation
LatexCommand cite
key "McCulloch2008"
literal "false"

\end_inset

 which mostly about improving iDMRG but also describes how one goes about
 a recursive calculation the expectation of a lower triangular operator
 with edge vectors
\begin_inset Formula 
\[
\hat{O}=\hat{\boldsymbol{l}}\hat{\boldsymbol{W}}^{m_{1}n_{1}}\hat{\boldsymbol{W}}^{m_{2}n_{2}}\hat{\boldsymbol{W}}^{m_{3}n_{3}}\hat{\boldsymbol{r}}
\]

\end_inset

which we should be able to apply to an orthogonalized iMPS where the edge
 vectors are unity.
 
\begin_inset CommandInset citation
LatexCommand cite
key "Michel2010"
literal "false"

\end_inset

 describes finding fixed points of recursion relations for triangular MPOs.
 This includes Hamiltonian MPOs but excludes time evolution operators like
 
\begin_inset Formula $\exp\left(-\tau\hat{H}\right)$
\end_inset

.
 
\end_layout

\begin_layout Standard
In same year 
\begin_inset CommandInset citation
LatexCommand cite
key "Pirvu2010"
literal "false"

\end_inset

 describes construction of translationally invariant MPOs suitable for time
 evolution.
 The focus is on the transverse Ising model using a spin space space Trotter
 decomposition in order to preserve translational symmetry.
 Next up is 
\begin_inset CommandInset citation
LatexCommand cite
key "Crosswhite2014"
literal "false"

\end_inset

 which is a rather mathematical exposition on iMPS focusing on different
 types of divergences.
 Zaletel et.
 al.
 
\begin_inset CommandInset citation
LatexCommand cite
key "Zaletel2015"
literal "false"

\end_inset

 make the first attempt to build higher order Trotter decompositions as
 iMPOs with some specific examples we can code from.
 
\begin_inset CommandInset citation
LatexCommand cite
key "Chan2016"
literal "false"

\end_inset

 talks about iMPOs but mostly from a QChem point of view.
 Hubig et.
 al.
 
\begin_inset CommandInset citation
LatexCommand cite
key "Hubig2017"
literal "false"

\end_inset

 describe some general methods for building MPOs by combining single site
 operators using direct addition and direct multiplication of MPOs.
 They are the first address the pitfalls one encounters when one try's to
 SVD compress an MPO.
 They suggested at a minimum re-scaling singular values so that all the
 weight of the MPO does not bunched up at one end of the lattice.
 They go on to describe more robust de-linearization and (a hard to follow)
 de-parallelization algorithms for compressing.
 The names here suggest the equivalent of throwing out singular redundancies
 that accumulate when combining MPOs.
 Finally the most recent contribution is 
\begin_inset CommandInset citation
LatexCommand cite
key "Parker2019"
literal "false"

\end_inset

 which describes why standard SVD compression is unreliable or non-optimal
 for iMPOs because extensive Schmidt values are mixed in with intensive
 ones.
 These need to be separated out before compression of the intensive SVs.
 In order to learn about all this stuff we should go through the relevant
 parts in each paper, and the see how to combine it all into the reusable
 software module.
\end_layout

\begin_layout Subsubsection
Infinite size density matrix renormalization group, revisited
\begin_inset CommandInset citation
LatexCommand cite
key "McCulloch2008"
literal "false"

\end_inset


\end_layout

\begin_layout Paragraph
MPO Background
\end_layout

\begin_layout Standard
The most general 
\begin_inset Formula $D_{w}=2$
\end_inset

 lower triangular MPO matrix looks like
\begin_inset Formula 
\[
W=\begin{bmatrix}C & 0\\
B & A
\end{bmatrix}
\]

\end_inset

which when multiplied with itself gives
\begin_inset Formula 
\[
WW=\begin{bmatrix}C & 0\\
B & A
\end{bmatrix}\begin{bmatrix}C & 0\\
B & A
\end{bmatrix}=\begin{bmatrix}C^{2} & 0\\
BC+AB & A^{2}
\end{bmatrix}
\]

\end_inset


\begin_inset Formula 
\[
W^{3}=\begin{bmatrix}C^{2} & 0\\
BC+AB & A^{2}
\end{bmatrix}\begin{bmatrix}C & 0\\
B & A
\end{bmatrix}=\begin{bmatrix}C^{3} & 0\\
BC^{2}+ABC+A^{2}B & A^{3}
\end{bmatrix}
\]

\end_inset

We see all the action is in the lower left corner where we get a sum of
 all strings with 
\begin_inset Formula $A$
\end_inset

s on the left one 
\begin_inset Formula $B$
\end_inset

 in the middle and 
\begin_inset Formula $C$
\end_inset

s on the right, like
\begin_inset Formula 
\[
B\otimes C\otimes C\otimes C\cdots+A\otimes B\otimes C\otimes C\cdots+A\otimes A\otimes B\otimes C\otimes C\cdots+\cdots+\cdots A\otimes A\otimes A\otimes B\otimes C+\cdots A\otimes A\otimes A\otimes B
\]

\end_inset

Typically 
\begin_inset Formula $A=C=1$
\end_inset

 and for example 
\begin_inset Formula $B=h\hat{s}_{z}$
\end_inset

 so we get tensor sum of spin operators for each site.
\end_layout

\begin_layout Standard
For 
\begin_inset Formula $D_{w}=3$
\end_inset

 we can start to represent bond operators
\begin_inset Formula 
\[
W=\begin{bmatrix}E & 0 & 0\\
D & C & 0\\
0 & B & A
\end{bmatrix}
\]

\end_inset


\begin_inset Formula 
\[
WW=\begin{bmatrix}E & 0 & 0\\
D & C & 0\\
0 & B & A
\end{bmatrix}\begin{bmatrix}E & 0 & 0\\
D & C & 0\\
0 & B & A
\end{bmatrix}=\begin{bmatrix}E^{2} & 0 & 0\\
DE+CD & C^{2} & 0\\
BD & BC+AB & A^{2}
\end{bmatrix}
\]

\end_inset


\begin_inset Formula 
\[
W^{3}=\begin{bmatrix}E^{2} & 0 & 0\\
DE+CD & C^{2} & 0\\
BD & BC+AB & A^{2}
\end{bmatrix}\begin{bmatrix}E & 0 & 0\\
D & C & 0\\
0 & B & A
\end{bmatrix}=\begin{bmatrix}E^{3} & 0 & 0\\
DE^{2}+CDE+C^{2}D & C^{3} & 0\\
BDE+BCD+ABD & BC^{2}+ABC+A^{2}B & A^{3}
\end{bmatrix}
\]

\end_inset

which give a sum of all string like terms
\begin_inset Formula 
\[
A\otimes\cdots\otimes A\otimes B\otimes C\otimes\cdots\otimes C\otimes D\otimes E\otimes\cdots\otimes E
\]

\end_inset

again typically 
\begin_inset Formula $A=E=1$
\end_inset

, 
\begin_inset Formula $B$
\end_inset

 and 
\begin_inset Formula $D$
\end_inset

 are spin operators and 
\begin_inset Formula $C<1$
\end_inset

 decides how they interact giving a power law decay with distance on the
 lattice.
\end_layout

\begin_layout Standard
It is well known that the transverse Ising model
\begin_inset Formula 
\[
H=\sum_{i}\hat{S}_{i}^{z}\hat{S}_{i+1}^{z}+h\sum_{i}\hat{S}_{i}^{x}
\]

\end_inset

can be compactly represented with 
\begin_inset Formula 
\[
W=\begin{bmatrix}1 & 0 & 0\\
\hat{S}^{z} & 0 & 0\\
h\hat{S}^{x} & \hat{S}^{z} & 1
\end{bmatrix}
\]

\end_inset


\end_layout

\begin_layout Standard
Non triangular MPOs show up in the Trotter decomposition of 
\begin_inset Formula $\exp\left(-\tau\hat{H}\right)\simeq\exp\left(-\tau\hat{H}_{even}\right)\exp\left(-\tau\hat{H}_{odd}\right)$
\end_inset

 where the MPO for example 
\begin_inset Formula $\exp\left(-\tau\hat{H}_{even}\right)$
\end_inset

 has a two site unit cell with alternating 
\begin_inset Formula $1\times D_{w}$
\end_inset

 and 
\begin_inset Formula $D_{w}\times1$
\end_inset

 matrices.
 The product 
\begin_inset Formula $\exp\left(-\tau\hat{H}_{even}\right)\exp\left(-\tau\hat{H}_{odd}\right)$
\end_inset

 will then be a sequence of 
\begin_inset Formula $D_{w}\times D_{w}$
\end_inset

 MPOs which are not lower triangular.
 This operator falls into the class of exponential MPO‚Äôs, with an expectation
 value of the form 
\begin_inset Formula $\lambda^{L}$
\end_inset

 for 
\begin_inset Formula $L$
\end_inset

 sites, where 
\begin_inset Formula $\lambda$
\end_inset

 is the eigenvalue corresponding to the fixed point 
\begin_inset Formula $E^{\alpha}$
\end_inset

 eigenmatrices (see below).
\end_layout

\begin_layout Paragraph
Iterative Contraction
\end_layout

\begin_layout Standard
For a finite system the expectation of an MPO can be contracted recursively
 from the left to right.
 At lattice site 
\begin_inset Formula $a$
\end_inset

 (putting back in suppressed indices in the paper)
\begin_inset Formula 
\[
E_{aj_{2}i_{2}}^{w_{2}}=\sum_{m_{a}n_{a}}\sum_{i_{1}j_{1}}\sum_{w_{2}}W_{w_{1}w_{2}}^{m_{a}n_{a}}A_{j_{1}j_{2}}^{m_{a}\dagger}E_{a-1j_{1}i_{1}}^{w_{1}}A_{i_{1}i_{2}}^{n_{a}}.
\]

\end_inset

To kick off the recursion for 
\begin_inset Formula $a=0$
\end_inset

 we use
\begin_inset Formula 
\[
E_{0j_{1}i_{1}}^{w_{1}}=\delta_{D_{w},w_{1}}I_{left}=\delta_{D_{w},w_{1}}\delta_{i_{1},1}\delta_{j_{1},1}
\]

\end_inset

Similarly one iterate from the right edge
\begin_inset Formula 
\[
F_{ai_{1}j_{1}}^{w_{1}}=\sum_{m_{a}n_{a}}\sum_{i_{1}j_{1}}\sum_{w_{2}}W_{w_{1}w_{2}}^{m_{a}n_{a}}B_{i_{1}i_{2}}^{m_{a}}E_{a+1i_{2}j_{2}}^{w_{2}}B_{j_{1}j_{2}}^{n_{a}\dagger}
\]

\end_inset

with
\begin_inset Formula 
\[
F_{L}^{w_{L}}=\delta_{w_{L},1}\delta_{i_{L},1}\delta_{j_{L},1}
\]

\end_inset


\end_layout

\begin_layout Paragraph
Limit as 
\begin_inset Formula $L\rightarrow\infty$
\end_inset

 for a one site unit cell
\end_layout

\begin_layout Standard
We can think of 
\begin_inset Formula $E_{aj_{2}i_{2}}^{w_{2}}$
\end_inset

 is being 
\begin_inset Formula $D_{w}$
\end_inset

 different matrices living on site 
\begin_inset Formula $a$
\end_inset

 and in the thermodynamic limit 
\begin_inset Formula $L\rightarrow\infty$
\end_inset

 we should have
\begin_inset Formula 
\[
E_{aj_{2}i_{2}}^{w_{2}}=E_{a-1j_{2}i_{2}}^{w_{2}}=\sum_{m_{a}n_{a}}\sum_{i_{1}j_{1}}\sum_{w_{1}}W_{w_{1}w_{2}}^{m_{a}n_{a}}A_{j_{1}j_{2}}^{m_{a}\dagger}E_{a-1j_{1}i_{1}}^{w_{1}}A_{i_{1}i_{2}}^{n_{a}}
\]

\end_inset

i.e.
 they are site independent or translationally invariant.
 Removing site labels
\begin_inset Formula 
\[
E_{j_{2}i_{2}}^{w_{2}}=\sum_{mn}\sum_{i_{1}j_{1}}\sum_{w_{1}}W_{w_{1}w_{2}}^{mn}A_{j_{1}j_{2}}^{m\dagger}E_{j_{1}i_{1}}^{w_{1}}A_{i_{1}i_{2}}^{n}
\]

\end_inset

In the paper they have
\begin_inset Formula 
\begin{equation}
E_{j_{2}i_{2}}^{w_{2}}=\sum_{mn}\sum_{i_{1}j_{1}}\sum_{w_{1}}W_{w_{1}w_{2}}^{mn}A_{j_{1}j_{2}}^{m\dagger}E_{j_{1}i_{1}}^{w_{1}}A_{i_{1}i_{2}}^{n}-E_{0}\delta_{w_{2},1}\label{eq:Erecursion}
\end{equation}

\end_inset

where 
\begin_inset Formula $E_{0}$
\end_inset

 is the expectation per site.
\end_layout

\begin_layout Standard
At this point we need to invoke the structural constraints on 
\begin_inset Formula $\hat{W}$
\end_inset

 which for NN interactions has the form
\begin_inset Formula 
\[
\hat{W}=\begin{bmatrix}\hat{1} & 0 & \cdots & 0 & 0 & 0\\
\hat{W}_{21} & 0 & \cdots & 0 & 0 & 0\\
\hat{W}_{31} & 0 & \cdots & 0 & 0 & 0\\
\vdots & 0 & \iddots & \vdots & \vdots & \vdots\\
\hat{W}_{D_{w}-1,1} & 0 & 0 & 0 & 0 & 0\\
\hat{W}_{D_{w}1} & \hat{W}_{D_{w}2} & \cdots & \hat{W}_{D_{w}D_{w}-2} & \hat{W}_{D_{w}D_{w}-1} & \hat{1}
\end{bmatrix}
\]

\end_inset


\end_layout

\begin_layout Standard
In the paper 
\begin_inset CommandInset citation
LatexCommand cite
key "McCulloch2007,Michel2010"
literal "false"

\end_inset

 he talks about a lower triangular MPO and starting the evaluation at 
\begin_inset Formula $E^{D_{w}}$
\end_inset

 since the bottom right is the identity operator, and eq.
 
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:Erecursion"
plural "false"
caps "false"
noprefix "false"

\end_inset

 is then a sum over rows in column 
\begin_inset Formula $D_{w}$
\end_inset

 which is a column of zeros with a 
\begin_inset Formula $\hat{1}$
\end_inset

 at the end.
 
\end_layout

\begin_layout Standard
Working one index at a time
\begin_inset Formula 
\[
E_{j_{2}i_{2}}^{D_{w}}=\sum_{mn}\sum_{i_{1}j_{1}}\sum_{w_{1}}W_{w_{1}D_{w}w_{2}}^{mn}A_{j_{2}j_{1}}^{m\dagger}E_{j_{1}i_{1}}^{w_{1}}A_{i_{1}i_{2}}^{n}=\sum_{mn}\sum_{i_{1}j_{1}}W_{D_{w}D_{w}}^{mn}A_{j_{2}j_{1}}^{m\dagger}E_{j_{1}i_{1}}^{D_{w}}A_{i_{1}i_{2}}^{n}
\]

\end_inset


\begin_inset Formula 
\[
=\sum_{i_{1}j_{1}}\sum_{mn}\hat{1}^{mn}A_{j_{2}j_{1}}^{m\dagger}E_{j_{1}i_{1}}^{D_{w}}A_{i_{1}i_{2}}^{n}
\]

\end_inset


\begin_inset Formula 
\[
=\sum_{m}\sum_{i_{1}j_{1}}A_{j_{2}j_{1}}^{m\dagger}E_{j_{1}i_{1}}^{D_{w}}A_{i_{1}i_{2}}^{m}
\]

\end_inset

On a finite lattice the 
\begin_inset Formula $A$
\end_inset

s are left normalized and on an infinite lattice they are orthogonalized,
 so the solution to the recursion is simply
\begin_inset Formula 
\[
E_{ji}^{D_{w}}=\delta_{j,i}
\]

\end_inset

which gives
\begin_inset Formula 
\[
\delta_{j_{2},i_{2}}=\sum_{n}\sum_{i_{1}j_{1}}A_{j_{2}j_{1}}^{n\dagger}\delta_{j_{1}i_{1}}A_{i_{1}i_{2}}^{n}=\sum_{n}\sum_{i_{1}}A_{j_{2}i_{1}}^{n\dagger}A_{i_{1}i_{2}}^{n}=\sum_{n}\sum_{i_{1}}A_{i_{1}j_{2}}^{n*}A_{i_{1}i_{2}}^{n}
\]

\end_inset

or in iTEBD langauge where 
\begin_inset Formula $A^{n_{a}}=\lambda^{B}\Gamma^{n_{a}}$
\end_inset

, 
\begin_inset Formula $B^{n_{b}}=\Gamma^{n_{b}}\lambda^{B}$
\end_inset


\begin_inset Formula 
\[
\delta_{j_{2},i_{2}}=\sum_{n}\sum_{i_{1}}\Gamma_{i_{1}j_{2}}^{n*}\lambda_{i_{1}}^{B^{2}}\Gamma_{i_{1}i_{2}}^{n}
\]

\end_inset


\end_layout

\begin_layout Standard
The next matrix is 
\begin_inset Formula 
\[
E_{j_{2}i_{2}}^{D_{w}-1}=\sum_{mn}\sum_{i_{1}j_{1}}\sum_{w_{1}=1}^{D_{w}}W_{w_{1}D_{w}-1}^{mn}A_{j_{2}j_{1}}^{m\dagger}E_{j_{1}i_{1}}^{w_{1}}A_{i_{1}i_{2}}^{n}
\]

\end_inset


\begin_inset Formula 
\[
=\sum_{mn}\sum_{i_{1}j_{1}}W_{D_{w}D_{w}-1}^{mn}A_{j_{2}j_{1}}^{m\dagger}E_{j_{1}i_{1}}^{D_{w}}A_{i_{1}i_{2}}^{n}
\]

\end_inset


\begin_inset Formula 
\[
=\sum_{mn}\sum_{i_{1}j_{1}}W_{D_{w}D_{w}-1}^{mn}A_{j_{2}j_{1}}^{m\dagger}\delta_{j_{1},i_{1}}A_{i_{1}i_{2}}^{n}
\]

\end_inset


\begin_inset Formula 
\[
=\sum_{mn}\sum_{i_{1}j_{1}}W_{D_{w}D_{w}-1}^{mn}A_{j_{2}i_{1}}^{m\dagger}A_{i_{1}i_{2}}^{n}
\]

\end_inset

Similarly
\begin_inset Formula 
\[
E_{j_{2}i_{2}}^{D_{w}-2}=\sum_{mn}\sum_{i_{1}j_{1}}W_{D_{w}D_{w}-2}^{mn}A_{i_{1}j_{2}}^{m\dagger}A_{i_{1}i_{2}}^{n}
\]

\end_inset

Finally the last row of 
\begin_inset Formula $\hat{W}$
\end_inset

 has no zeros so this last evaluation is non trivial
\begin_inset Formula 
\[
E_{j_{2}i_{2}}^{1}=\sum_{mn}\sum_{i_{1}j_{1}}\sum_{w_{1}=1}^{D_{w}}W_{w_{1}1}^{mn}A_{j_{2}j_{1}}^{m\dagger}E_{j_{1}i_{1}}^{w_{1}}A_{i_{1}i_{2}}^{n}-E_{0}
\]

\end_inset


\begin_inset Formula 
\[
E_{j_{2}i_{2}}^{1}=\sum_{mn}\sum_{i_{1}j_{1}}\left(W_{11}^{mn}A_{j_{2}j_{1}}^{m\dagger}E_{j_{1}i_{1}}^{1}A_{i_{1}i_{2}}^{n}+\sum_{w_{1}=2}^{D_{w}}W_{w_{1}1}^{mn}A_{j_{2}j_{1}}^{m\dagger}E_{j_{1}i_{1}}^{w_{1}}A_{i_{1}i_{2}}^{n}\right)-E_{0}
\]

\end_inset


\begin_inset Formula 
\[
E_{j_{2}i_{2}}^{1}=\sum_{m}\sum_{i_{1}j_{1}}A_{j_{2}j_{1}}^{m\dagger}E_{j_{1}i_{1}}^{1}A_{i_{1}i_{2}}^{m}+C_{j_{2}i_{2}}-E_{0}
\]

\end_inset

Now they claim 
\begin_inset CommandInset citation
LatexCommand cite
key "McCulloch2008"
literal "false"

\end_inset

 the 
\begin_inset Formula $E_{0}$
\end_inset

 is defined as the trace of 
\begin_inset Formula $C$
\end_inset


\begin_inset Formula 
\[
E_{0}=\sum\lambda_{i}^{2}C_{ii}
\]

\end_inset

so we don't need to solve for 
\begin_inset Formula $E^{1}$
\end_inset

 if we only need to expectation value.
\end_layout

\begin_layout Paragraph
Version from Inifnity boundary condiditons for MPS calculations
\begin_inset CommandInset citation
LatexCommand cite
key "Phien2012"
literal "false"

\end_inset


\end_layout

\begin_layout Standard
In general for lower triangular with a diagonal unit operator
\begin_inset Formula 
\[
E^{w_{2}}=\sum_{mn}\sum_{w_{1}=w_{2}}^{D_{w}}W_{w_{1}w_{2}}^{mn}A^{\dagger m}E^{w_{1}}A^{n}
\]

\end_inset


\begin_inset Formula 
\[
=\sum_{mn}W_{w_{2}w_{2}}^{mn}A^{\dagger m}E^{w_{1}}A^{n}+\sum_{mn}\sum_{w_{1}=w_{2}+1}^{D_{w}}W_{w_{1}w_{2}}^{mn}A^{\dagger m}E^{w_{1}}A^{n}
\]

\end_inset

usually 
\begin_inset Formula $W_{w_{1}w_{1}}^{mn}=0$
\end_inset

 but in some cases 
\begin_inset Formula $W_{w_{1}w_{1}}^{mn}=\delta^{mn}$
\end_inset

 
\begin_inset Formula 
\[
E^{w_{2}}=\sum_{mn}\delta^{mn}A^{\dagger m}E^{w_{2}}A^{n}+\sum_{mn}\sum_{w_{1}=w_{2}+1}^{D_{w}}W_{w_{1}w_{2}}^{mn}A^{\dagger m}E^{w_{1}}A^{n}
\]

\end_inset


\begin_inset Formula 
\[
E^{w_{2}}=\sum_{m}A^{\dagger m}E^{w_{2}}A^{m}+C^{w_{2}}
\]

\end_inset

where
\begin_inset Formula 
\[
C_{i_{2}j_{2}}^{w_{2}}=\sum_{mn}\sum_{w_{1}=w_{2}+1}^{D_{w}}W_{w_{1}w_{2}}^{mn}A^{\dagger m}E^{w_{1}}A^{n}
\]

\end_inset


\begin_inset Formula 
\[
E_{i_{2}j_{2}}^{w_{2}}=\sum_{i_{1}j_{1}}\sum_{m}A_{i_{2}i_{1}}^{\dagger m}E_{i_{1}j_{1}}^{w_{2}}A_{j_{1}j_{2}}^{m}+C_{i_{2}j_{2}}^{w_{2}}
\]

\end_inset


\begin_inset Formula 
\[
E_{i_{2}j_{2}}^{w_{2}}=\sum_{i_{1}j_{1}}\left(\sum_{m}A_{i_{2}i_{1}}^{\dagger m}A_{j_{1}j_{2}}^{m}\right)E_{i_{1}j_{1}}^{w_{2}}+C_{i_{2}j_{2}}^{w_{2}}
\]

\end_inset


\begin_inset Formula 
\begin{equation}
E_{i_{2}j_{2}}^{w_{2}}=\sum_{i_{1}j_{1}}T_{\left(i_{2}j_{2}\right)\left(i_{1}j_{1}\right)}E_{i_{1}j_{1}}^{w_{2}}+C_{i_{2}j_{2}}^{w_{2}}\label{eq:ETClinear}
\end{equation}

\end_inset

Reshape 
\begin_inset Formula $k_{2}=\left(i_{2}j_{2}\right),\;k_{1}=\left(i_{1}j_{1}\right)$
\end_inset


\begin_inset Formula 
\[
E_{k_{2}}^{w_{2}}=\sum_{k_{1}}\left(\sum_{m}\boldsymbol{A}^{\dagger m}\boldsymbol{A}^{m}\right)_{k_{2}k_{1}}E_{k_{1}}^{w_{2}}+C_{k_{2}}^{w_{2}}
\]

\end_inset


\begin_inset Formula 
\[
\sum_{k_{1}}\left\{ ùïÄ-\sum_{m}\boldsymbol{A}^{\dagger m}\boldsymbol{A}^{m}\right\} _{k_{2}k_{1}}E_{k_{1}}^{w_{2}}=C_{k_{2}}^{w_{2}}
\]

\end_inset


\begin_inset Formula 
\[
\sum_{k_{1}}\left\{ ùïÄ-\boldsymbol{T}\right\} _{k_{2}k_{1}}E_{k_{1}}^{w_{2}}=C_{k_{2}}^{w_{2}}
\]

\end_inset

In 
\begin_inset CommandInset citation
LatexCommand cite
key "Michel2010"
literal "false"

\end_inset

 they point out that becuase 
\begin_inset Formula $\boldsymbol{T}$
\end_inset

has eigen value 
\begin_inset Formula $1$
\end_inset

, 
\begin_inset Formula $ùïÄ-\boldsymbol{T}$
\end_inset

is therefore singular.
 So we must decompose 
\begin_inset Formula $E$
\end_inset

 and 
\begin_inset Formula $C$
\end_inset

 into components that are parallel and perpendicular to the identity
\begin_inset Formula 
\[
\boldsymbol{E}=e\boldsymbol{ùïÄ}+\boldsymbol{E}_{\bot}
\]

\end_inset


\begin_inset Formula 
\[
\boldsymbol{C}=c\boldsymbol{ùïÄ}+\boldsymbol{C}_{\bot}
\]

\end_inset

I think 
\begin_inset Formula $c=\frac{1}{D}\sum_{i}C_{ii}=\frac{1}{D}Tr\left(C\right)$
\end_inset

.
 Pluggin these into 
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:ETClinear"
plural "false"
caps "false"
noprefix "false"

\end_inset


\begin_inset Formula 
\[
e\boldsymbol{ùïÄ}+\boldsymbol{E}_{\bot}=e\sum_{i_{1}j_{1}}T_{\left(i_{2}j_{2}\right)\left(i_{1}j_{1}\right)}\delta_{i_{1}j_{1}}+\sum_{i_{1}j_{1}}T_{\left(i_{2}j_{2}\right)\left(i_{1}j_{1}\right)}E_{\bot i_{1}j_{1}}^{w_{2}}+c\boldsymbol{ùïÄ}+\boldsymbol{C}_{\bot}
\]

\end_inset


\begin_inset Formula 
\[
e\boldsymbol{ùïÄ}+\boldsymbol{E}_{\bot}=e\sum_{i_{1}}T_{\left(i_{2}j_{2}\right)\left(i_{1}i_{1}\right)}+\sum_{i_{1}j_{1}}T_{\left(i_{2}j_{2}\right)\left(i_{1}j_{1}\right)}E_{\bot i_{1}j_{1}}^{w_{2}}+c\boldsymbol{ùïÄ}+\boldsymbol{C}_{\bot}
\]

\end_inset

Can we just isolate the perpendiculat parts?
\begin_inset Formula 
\[
\boldsymbol{E}_{\bot}=\sum_{i_{1}j_{1}}T_{\left(i_{2}j_{2}\right)\left(i_{1}j_{1}\right)}E_{\bot i_{1}j_{1}}^{w_{2}}+\boldsymbol{C}_{\bot}
\]

\end_inset

w need to use the eigen vector property
\begin_inset Formula 
\[
T\boldsymbol{ùïÄ}=\lambda\boldsymbol{ùïÄ}=\boldsymbol{ùïÄ}
\]

\end_inset

so
\begin_inset Formula 
\[
\left(ùïÄ-\boldsymbol{T}\right)\left(e\boldsymbol{ùïÄ}+\boldsymbol{E}_{\bot}\right)=c\boldsymbol{ùïÄ}+\boldsymbol{C}_{\bot}
\]

\end_inset


\begin_inset Formula 
\[
=eùïÄùïÄ-eTùïÄ+ùïÄ\boldsymbol{E}_{\bot}-\boldsymbol{T}\boldsymbol{E}_{\bot}=c\boldsymbol{ùïÄ}+\boldsymbol{C}_{\bot}
\]

\end_inset


\begin_inset Formula 
\[
=ùïÄ\boldsymbol{E}_{\bot}-\boldsymbol{T}\boldsymbol{E}_{\bot}=c\boldsymbol{ùïÄ}+\boldsymbol{C}_{\bot}
\]

\end_inset

I think 
\begin_inset Formula $ùïÄ\boldsymbol{E}_{\bot}=0$
\end_inset

 by definition of 
\begin_inset Formula $\boldsymbol{E}_{\bot}$
\end_inset

.
 Similarly the 
\begin_inset Formula $c\boldsymbol{ùïÄ}$
\end_inset

 can be removed since it is perpendicular to everything else that is left
\begin_inset Formula 
\[
-\boldsymbol{T}\boldsymbol{E}_{\bot}=\boldsymbol{C}_{\bot}
\]

\end_inset

But how can dtermine 
\begin_inset Formula $e$
\end_inset

 so that we can reassemble
\begin_inset Formula 
\[
\boldsymbol{E}=e\boldsymbol{\mathbb{I}}+\boldsymbol{E}_{\bot}
\]

\end_inset

the only info we have is
\begin_inset Formula 
\[
0e=c
\]

\end_inset

We still seem to be stuck unless 
\begin_inset Formula $Tr\left(\boldsymbol{C}\right)=0$
\end_inset


\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
E^{w_{2}}\left(a+1\right)=\sum_{mn}\sum_{w_{1}=1}^{D_{w}}W_{w_{1}w_{2}}^{mn}A^{\dagger m}E^{w_{1}}\left(a\right)A^{n}
\]

\end_inset


\begin_inset Formula 
\[
E^{w_{2}}\left(a+1\right)=\sum_{mn}\sum_{w_{1}=w_{2}}^{D_{w}}W_{w_{1}w_{2}}^{mn}A^{\dagger m}E^{w_{1}}\left(a\right)A^{n}
\]

\end_inset

The last component 
\begin_inset Formula $w_{2}=D_{w}=5$
\end_inset

 is
\begin_inset Formula 
\[
E^{5}\left(a+1\right)=\sum_{mn}\sum_{w_{1}=5}^{D_{w}}W_{w_{1}5}^{mn}A^{\dagger m}E^{w_{1}}\left(a\right)A^{n}
\]

\end_inset


\begin_inset Formula 
\[
=\sum_{mn}W_{55}^{mn}A^{\dagger m}E^{5}\left(a\right)A^{n}
\]

\end_inset


\begin_inset Formula 
\[
=\sum_{mn}\hat{ùïÄ}^{mn}A^{\dagger m}E^{5}\left(a\right)A^{n}
\]

\end_inset


\begin_inset Formula 
\[
=\sum_{m}A^{\dagger m}E^{5}\left(a\right)A^{m}
\]

\end_inset

Which is just the orthonognality condition when 
\begin_inset Formula $E^{5}=ùïÄ$
\end_inset

.
 Next in line is
\begin_inset Formula 
\[
E^{4}\left(a+1\right)=\sum_{mn}\sum_{w_{1}=4}^{D_{w}}W_{w_{1}4}^{mn}A^{\dagger m}E^{w_{1}}\left(a\right)A^{n}
\]

\end_inset


\begin_inset Formula 
\[
=\sum_{mn}W_{44}^{mn}A^{\dagger m}E^{4}\left(a\right)A^{n}+\sum_{mn}W_{54}^{mn}A^{\dagger m}A^{n}
\]

\end_inset


\begin_inset Formula 
\[
=\sum_{mn}\delta_{mn}A^{\dagger m}E^{4}\left(a\right)A^{n}+\sum_{mn}W_{54}^{mn}A^{\dagger m}A^{n}
\]

\end_inset


\begin_inset Formula 
\[
=\sum_{m}A^{\dagger m}E^{4}\left(a\right)A^{m}+\sum_{mn}W_{54}^{mn}A^{\dagger m}A^{n}
\]

\end_inset


\begin_inset Formula 
\[
=\sum_{mn}S_{z}^{mn}A^{\dagger m}A^{n}
\]

\end_inset


\begin_inset Formula 
\[
=\left\langle S_{z}\right\rangle 
\]

\end_inset

Same for 
\begin_inset Formula $E^{3}$
\end_inset

 and 
\begin_inset Formula $E^{2}$
\end_inset

.
 Finally the hard one
\begin_inset Formula 
\[
E^{1}\left(a+1\right)=\sum_{mn}\sum_{w_{2}}W_{w_{2}1}^{mn}A^{\dagger m}E^{w_{2}}\left(a\right)A^{n}
\]

\end_inset


\begin_inset Formula 
\[
=\sum_{m}A^{\dagger m}E^{1}\left(a\right)A^{m}+\sum_{mn}\sum_{w_{2}=2}^{4}W_{w_{2}1}^{mn}A^{\dagger m}E^{w_{2}}\left(a\right)A^{n}+\sum_{mn}W_{51}^{mn}A^{\dagger m}E^{5}\left(a\right)A^{n}
\]

\end_inset


\begin_inset Formula 
\[
=\sum_{m}A^{\dagger m}E^{1}\left(a\right)A^{m}+C
\]

\end_inset

They call 
\begin_inset Formula $C$
\end_inset

a constant, but it is really a 
\begin_inset Formula $D\times D$
\end_inset

 constant matrix.
 They define for lattice site zero 
\begin_inset Formula $E^{1}\left(0\right)=0$
\end_inset

 then
\begin_inset Formula 
\[
E^{1}\left(1\right)=C
\]

\end_inset


\begin_inset Formula 
\[
E^{1}\left(2\right)=\sum_{m}A^{\dagger m}E^{1}\left(1\right)A^{m}+C=\sum_{m}A^{\dagger m}CA^{m}+C=T\left(C\right)+C
\]

\end_inset


\begin_inset Formula 
\[
E^{1}\left(3\right)=T\left(E^{1}\left(2\right)\right)+C=T\left(T\left(C\right)+C\right)+C=T\left(T\left(C\right)\right)+T\left(C\right)+C
\]

\end_inset


\begin_inset Formula 
\[
E^{1}\left(n\right)=T\left(E^{1}\left(n-1\right)\right)+C=\sum_{k=0}^{n-1}T^{k}\left(C\right)=C+T\left(C\right)+T\left(T\left(C\right)\right)+\cdots
\]

\end_inset

which is a geometric series
\begin_inset Formula 
\[
E^{1}\left(n\right)=\frac{\left(ùïÄ-T^{n}\right)\left(C\right)}{\left(ùïÄ-T\right)\left(C\right)}
\]

\end_inset

which is divergent, so we devide 
\begin_inset Formula $E^{1}\left(n\right)$
\end_inset

 into two components 
\begin_inset Formula 
\[
E^{1}\left(n\right)=H_{L}-E_{0}nùïÄ
\]

\end_inset

where 
\begin_inset Formula $H_{L}$
\end_inset

 contains all terms perpendiculr to the identity and is acutally the effective
 Hamiltonian for the left infinite chain.
 It also removes the constant constribution to the energy (
\begin_inset Formula $E_{0}nùïÄ$
\end_inset

) which diverges in the thermo limit.
 If we sub this into
\begin_inset Formula 
\[
E^{1}\left(n+1\right)=T\left(E^{1}\left(n\right)\right)+C
\]

\end_inset


\begin_inset Formula 
\[
H_{L}-E_{0}\left(n+1\right)ùïÄ=T\left(H_{L}-E_{0}nùïÄ\right)+C=T\left(H_{L}\right)-T\left(E_{0}nùïÄ\right)+C
\]

\end_inset


\begin_inset Formula 
\[
H_{L}-T\left(H_{L}\right)=-E_{0}ùïÄ+C
\]

\end_inset

and
\begin_inset Formula 
\[
E_{0}=Tr\left(\rho C\right)
\]

\end_inset

which should be
\begin_inset Formula 
\[
E_{0}=\sum_{i=1}^{D}\lambda_{i}^{2}C_{ii}
\]

\end_inset


\end_layout

\begin_layout Paragraph
Limit as 
\begin_inset Formula $L\rightarrow\infty$
\end_inset

 for a two site unit cell
\end_layout

\begin_layout Standard
One approach is to contract horizontally first,
\begin_inset Formula 
\[
A_{i_{1}i_{3}}^{n}=A_{i_{1}i_{3}}^{\left(n_{a},n_{a+1}\right)}=\sum_{i_{2}}A_{i_{1}i_{2}}^{n_{a}}A_{i_{2}i_{3}}^{n_{a+1}}
\]

\end_inset

and
\begin_inset Formula 
\[
W_{w_{1}w_{3}}^{mn}=W_{w_{1}w_{3}}^{\left(m_{a}m_{a+1}\right)\left(n_{a}n_{a+1}\right)}=\sum_{w_{2}}W_{w_{1}w_{2}}^{m_{a}n_{a}}W_{w_{2}w_{3}}^{m_{a+1}n_{a+1}}
\]

\end_inset

and now define
\begin_inset Formula 
\[
E_{aj_{3}i_{3}}^{w_{3}}=\sum_{n,m}W_{w_{3}w_{1}}^{mn}A_{j_{3}j_{1}}^{m\dagger}E_{a-2j_{1}i_{1}}^{w_{1}}A_{i_{1}i_{3}}^{n}
\]

\end_inset

Because 
\begin_inset Formula $W^{mn}$
\end_inset

 has the same structure as before, everything proceeds as before.
\end_layout

\begin_layout Subsection
Matrix product operator representations
\begin_inset CommandInset citation
LatexCommand cite
key "Pirvu2010"
literal "false"

\end_inset


\end_layout

\begin_layout Standard
This paper has Frank Verstraete on it and one can therefore expect it to
 be hard to follow for us non-geniuses:).
 Anyway let's give it a go ...
 this is yet another paper using the transverse Ising model for examples.
 In general I don't like any example that assumes a one site unit cell.
 However if they explicitly state that extension to multi site unit cells
 is trivial then at least I have confidence that if I work through the math
 I won't hit a brick wall.
 The Hamiltonian is
\begin_inset Formula 
\[
\hat{H}=-\sum_{i}\hat{S}_{i}^{z}\hat{S}_{i+1}^{z}-h\sum_{i}\hat{S}_{i}^{x}=\hat{H}_{z}+\hat{H}_{x}
\]

\end_inset

and they do a spin space Trotter decomposition
\begin_inset Formula 
\[
\exp\left(\epsilon\hat{H}\right)=\exp\left(\epsilon\hat{H}_{z}\right)\exp\left(\epsilon\hat{H}_{x}\right)+O\left(\epsilon^{2}\right).
\]

\end_inset

Now
\begin_inset Formula 
\[
\exp\left(\epsilon\hat{S}_{i}^{z}\hat{S}_{i+1}^{z}\right)=\exp\left(\epsilon\begin{bmatrix}\frac{1}{4} & 0 & 0 & 0\\
0 & -\frac{1}{4} & 0 & 0\\
0 & 0 & -\frac{1}{4} & 0\\
0 & 0 & 0 & \frac{1}{4}
\end{bmatrix}\right)
\]

\end_inset

They claim this is the same as
\begin_inset Formula 
\[
\cosh\left(\epsilon\right)\begin{bmatrix}1 & 0 & 0 & 0\\
0 & 1 & 0 & 0\\
0 & 0 & 1 & 0\\
0 & 0 & 0 & 1
\end{bmatrix}+\sinh\left(\epsilon\right)\begin{bmatrix}\frac{1}{4} & 0 & 0 & 0\\
0 & -\frac{1}{4} & 0 & 0\\
0 & 0 & -\frac{1}{4} & 0\\
0 & 0 & 0 & \frac{1}{4}
\end{bmatrix}
\]

\end_inset


\begin_inset Formula 
\[
=\frac{\left(e^{\epsilon}+e^{-\epsilon}\right)}{2}\begin{bmatrix}1 & 0 & 0 & 0\\
0 & 1 & 0 & 0\\
0 & 0 & 1 & 0\\
0 & 0 & 0 & 1
\end{bmatrix}+\frac{\left(e^{\epsilon}-e^{-\epsilon}\right)}{2}\begin{bmatrix}\frac{1}{4} & 0 & 0 & 0\\
0 & -\frac{1}{4} & 0 & 0\\
0 & 0 & -\frac{1}{4} & 0\\
0 & 0 & 0 & \frac{1}{4}
\end{bmatrix}
\]

\end_inset


\begin_inset Formula 
\[
e^{\epsilon}\begin{bmatrix}\frac{3}{4} & 0 & 0 & 0\\
0 & \frac{1}{4} & 0 & 0\\
0 & 0 & \frac{1}{4} & 0\\
0 & 0 & 0 & \frac{3}{4}
\end{bmatrix}+e^{-\epsilon}\begin{bmatrix}\frac{1}{4} & 0 & 0 & 0\\
0 & \frac{3}{4} & 0 & 0\\
0 & 0 & \frac{3}{4} & 0\\
0 & 0 & 0 & \frac{1}{4}
\end{bmatrix}
\]

\end_inset

OK ...
 so I am already lost on the first equation ...
 as predicted.
 Next......
\end_layout

\begin_layout Subsection
Time-evolving a matrix product state with long-ranged interactions
\begin_inset CommandInset citation
LatexCommand cite
key "Zaletel2015"
literal "false"

\end_inset


\end_layout

\begin_layout Standard
They start by dividing the system into left and right half's, centered on
 the bond between sites 
\begin_inset Formula $i$
\end_inset

 and 
\begin_inset Formula $i+1$
\end_inset

.
 The Hamiltonian is then
\begin_inset Formula 
\[
\hat{H}=\hat{H}_{L_{i}}\otimesùïÄ_{R_{i}}+ùïÄ_{L_{i}}\otimes\hat{H}_{R_{i}}+\sum_{a_{i}=1}^{N_{i}}\hat{h}_{L_{i},a_{i}}\otimes\hat{h}_{R_{i},a_{i}}
\]

\end_inset

where the sum is over the 
\begin_inset Formula $N_{i}$
\end_inset

 interaction terms across the bond.
 For example a Heisenberg interactions would look like
\begin_inset Formula 
\[
\sum_{a_{i}=1}^{N_{i}}\hat{h}_{L_{i},a_{i}}\otimes\hat{h}_{R_{i},a_{i}}=\hat{S}_{i}^{x}\hat{S}_{i+1}^{x}+\hat{S}_{i}^{y}\hat{S}_{i+1}^{y}+\hat{S}_{i}^{z}\hat{S}_{i+1}^{z}.
\]

\end_inset

The is a recursion relationship between the bond at 
\begin_inset Formula $i$
\end_inset

 and 
\begin_inset Formula $i-1$
\end_inset


\begin_inset Formula 
\[
\begin{bmatrix}\hat{H}_{R_{i-1}}\\
\hat{h}_{R_{i-1},a_{i-1}}\\
ùïÄ_{R_{i-1}}
\end{bmatrix}=\begin{bmatrix}\hat{ùïÄ} & \hat{C} & \hat{B}\\
0 & \hat{A} & \hat{D}\\
0 & 0 & \hat{ùïÄ}
\end{bmatrix}\begin{bmatrix}\hat{H}_{R_{i}}\\
\hat{h}_{R_{i},a_{i}}\\
ùïÄ_{R_{i}}
\end{bmatrix}
\]

\end_inset

where the block matrix in the middle is the MPO for site 
\begin_inset Formula $i$
\end_inset

, 
\begin_inset Formula $\hat{W}_{i}$
\end_inset

.
\end_layout

\begin_layout Subsection
Generic construction of efficient matrix product operators
\begin_inset CommandInset citation
LatexCommand cite
key "Hubig2017"
literal "false"

\end_inset


\end_layout

\begin_layout Standard
This paper describes how to build up arbitrary MPOs by adding and multiplying
 simple MPO with one site operators.
 When one does this more often than not, resulting MPO representation is
 reducible.
 In other words under SVD compression there will be many zero singular values,
 and the MPO can be compressed without making any approximations.
 As an example adding an MPO to itself will result in an MPO with dimension
 
\begin_inset Formula $2D_{w}$
\end_inset

 but we know that multiplying the same MPO 
\begin_inset Formula $\times2$
\end_inset

 will give an MPO with dimension 
\begin_inset Formula $D_{w}$
\end_inset

, so the added version must compress from 
\begin_inset Formula $2D_{w}$
\end_inset

 down to 
\begin_inset Formula $D_{w}$
\end_inset

 with no approximations.
\end_layout

\begin_layout Standard
The paper then explores applying standard MPS compression techniques
\begin_inset CommandInset citation
LatexCommand cite
key "Froewis2010,schollwoeck_density-matrix_2010"
literal "false"

\end_inset

 to MPOs.
 They claim some modifications are necessary in order to avoid numerical
 instabilities.
 Starting with any MPO tensor, we group the indices and SVD
\begin_inset Formula 
\[
W_{w_{1}w_{2}}^{nm}\rightarrow W_{\left(w_{1}mn\right),w_{2}}\rightarrow\sum_{k=1}^{d^{2}D_{w}}U_{\left(w_{1}mn\right),k}s_{kk}V_{w_{2}}^{\dagger}\rightarrow\sum_{k=1}^{d^{2}D_{w}}\tilde{W}_{w_{1}k}^{mn}s_{kk}V_{w_{2}}^{\dagger}
\]

\end_inset

and as usual 
\begin_inset Formula $s_{kk}V_{w_{2}}^{\dagger}$
\end_inset

 get transferred over to the next site.
 Usually one sweeps left to right and back again to complete the compression
 across the lattice.
\end_layout

\begin_layout Standard
If you try this for a mid sized lattice 
\begin_inset Formula $L=20-40$
\end_inset

 you will find that singular values get extremely large, reference 
\begin_inset CommandInset citation
LatexCommand cite
key "Parker2019"
literal "false"

\end_inset

 explains why.
 A simple work around is to simply re-scale the SVs with arithmetic average
\begin_inset Formula 
\[
a_{s}=\frac{\sum_{k=1}^{d^{2}D_{w}}s_{kk}}{d^{2}D_{w}}
\]

\end_inset

and re-scale
\begin_inset Formula 
\[
s_{kk}\rightarrow\frac{1}{a_{s}}s_{kk},\quad\tilde{W}_{w_{1}k}^{mn}\rightarrow a_{s}\tilde{W}_{w_{1}k}^{mn}.
\]

\end_inset

They go on to recommend de-linearization and de-parallelization algorithms
 to replace SVD in certain situations where even re-scaled SVD fails.
 But the necessity of using these algorithm may be eclipsed by the deeper
 understanding of where large SVs come from as described in the next paper.
\end_layout

\begin_layout Subsection
Local Matrix Product Operators:Canonical Form, Compression, and Control
 Theory
\begin_inset CommandInset citation
LatexCommand cite
key "Parker2019"
literal "false"

\end_inset


\end_layout

\begin_layout Standard
Following 
\begin_inset CommandInset citation
LatexCommand cite
key "Zaletel2015"
literal "false"

\end_inset

 they start with an 
\begin_inset Formula $L/R$
\end_inset

 partitioned Hamiltonian
\begin_inset Formula 
\begin{equation}
\hat{H}=\hat{H}_{L_{i}}\otimesùïÄ_{R_{i}}+ùïÄ_{L_{i}}\otimes\hat{H}_{R_{i}}+\sum_{ab=1}^{\chi}M_{ab}\hat{h}_{L}^{a}\otimes\hat{h}_{R}^{b}\label{eq:PartitionedHamiltonian}
\end{equation}

\end_inset

The first two terms are extensive, and the third local term is intensive.
 In this paper they use 
\begin_inset Formula $\chi=D_{w}-2$
\end_inset

, which counts the 
\emph on
intensive
\emph default
 degrees of freedom in the MPO.
 The key idea is to SVD the intensive part only and leave the extensive
 parts untouched.
 In order to make the SVD compression optimal they also purpose bringing
 the MPO into canonical form such that
\begin_inset Formula 
\[
Tr\left(\hat{h}_{L/R}^{a}\hat{h}_{L/R}^{b}\right)\propto\delta_{ab}
\]

\end_inset

Eq.
 
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:PartitionedHamiltonian"
plural "false"
caps "false"
noprefix "false"

\end_inset

 can be re-written as
\begin_inset Formula 
\begin{equation}
\hat{H}=\begin{bmatrix}\hat{ùïÄ}_{L} & \hat{\boldsymbol{h}}_{L} & \hat{H}_{L}\end{bmatrix}\begin{bmatrix}1\\
 & \boldsymbol{M}\\
 &  & 1
\end{bmatrix}\begin{bmatrix}\hat{ùïÄ}_{R}\\
\hat{\boldsymbol{h}}_{R}\\
\hat{H}_{R}
\end{bmatrix}\label{eq:HPartition1}
\end{equation}

\end_inset

Where 
\begin_inset Formula $\boldsymbol{M}$
\end_inset

 is a 
\begin_inset Formula $\chi\times\chi$
\end_inset

 matrix.
 As usual I need a hard example.
 So for a simple Heisenberg interaction we would have
\begin_inset Formula 
\[
\hat{\boldsymbol{h}}_{L}=\begin{bmatrix}\hat{S}_{i}^{x} & \hat{S}_{i}^{y} & \hat{S}_{i}^{z}\end{bmatrix}
\]

\end_inset


\begin_inset Formula 
\[
\hat{\boldsymbol{h}}_{R}=\begin{bmatrix}\hat{S}_{i+1}^{x} & \hat{S}_{i+1}^{y} & \hat{S}_{i+1}^{z}\end{bmatrix}
\]

\end_inset


\begin_inset Formula 
\[
\boldsymbol{M}=\begin{bmatrix}J & 0 & 0\\
0 & J & 0\\
0 & 0 & J
\end{bmatrix}
\]

\end_inset

In this case 
\begin_inset Formula $\boldsymbol{M}$
\end_inset

 is already diagonal and requires no compression.
 OK enough operators, lets start talking MPOs:
\end_layout

\begin_layout Subsubsection
Finite MPO Left Canoncial Form
\end_layout

\begin_layout Standard
They define a 
\emph on
regular
\emph default
 MPO as having the form
\begin_inset Formula 
\[
\hat{W}=\begin{bmatrix}\hat{ùïÄ} & \hat{\boldsymbol{c}} & \hat{d}\\
0 & \hat{\boldsymbol{A}} & \hat{\boldsymbol{b}}\\
0 & 0 & \hat{ùïÄ}
\end{bmatrix}
\]

\end_inset

where 
\begin_inset Formula $\hat{\boldsymbol{c}}$
\end_inset

 and 
\begin_inset Formula $\hat{\boldsymbol{b}}$
\end_inset

 are operator valued vectors of length 
\begin_inset Formula $\chi$
\end_inset

 and 
\begin_inset Formula $\hat{\boldsymbol{A}}$
\end_inset

 is an upper triangular operator valued 
\begin_inset Formula $\chi\times\chi$
\end_inset

 matrix.
 This MPO is said to be in left canonical form if it's upper left block
\begin_inset Formula 
\begin{equation}
\hat{V}=\begin{bmatrix}\hat{ùïÄ} & \hat{\boldsymbol{c}}\\
0 & \hat{\boldsymbol{A}}
\end{bmatrix}\label{eq:WupperLeft}
\end{equation}

\end_inset

has orthogonal columns
\begin_inset Formula 
\[
\sum_{a=0}^{\chi}\left\langle \hat{W}_{ab},\hat{W}_{ac}\right\rangle =\frac{\sum_{a=0}^{\chi}Tr\left[\hat{W}_{ab}^{\dagger}\hat{W}_{ac}\right]}{Tr\left[\hat{ùïÄ}\right]}=\delta_{bc}
\]

\end_inset

The right canonical form is the 
\emph on
mirror
\emph default
 of this.
 If the MPO is in left canonical form the eq.
 
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:HPartition1"
plural "false"
caps "false"
noprefix "false"

\end_inset

 simplifies to
\begin_inset Formula 
\[
\hat{H}=\begin{bmatrix}\hat{ùïÄ}_{L} & \hat{\boldsymbol{h}}_{L} & \hat{H}_{L}\end{bmatrix}\begin{bmatrix}\hat{ùïÄ}_{R}\\
\hat{\boldsymbol{h}}_{R}\\
\hat{H}_{R}
\end{bmatrix}
\]

\end_inset

in addition the operators on neigbouring sites are related by recursion
\begin_inset Formula 
\[
\begin{bmatrix}\hat{ùïÄ}_{L}^{n-1} & \hat{\boldsymbol{h}}_{L}^{n-1}\end{bmatrix}\hat{V}^{n}=\begin{bmatrix}\hat{ùïÄ}_{L}^{n} & \hat{\boldsymbol{h}}_{L}^{n}\end{bmatrix}
\]

\end_inset

So how do we get into left canonical form? MPOs have a similar guage freedom
 as MPSs, so we need to find a guage transformation that brings the MPO
 into left canoncial form.
 Suppose 
\begin_inset Formula $\hat{W}$
\end_inset

 is an MPO with internal dimensions 
\begin_inset Formula $D_{w}\times D_{w}=\left(1+\chi+1\right)\times\left(1+\chi+1\right)$
\end_inset

 with 
\begin_inset Formula $\hat{V}$
\end_inset

 as in eq.
 
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:WupperLeft"
plural "false"
caps "false"
noprefix "false"

\end_inset

 then we can group the indices and reshape 
\begin_inset Formula $V$
\end_inset

 as
\begin_inset Formula 
\[
V_{w_{1}w_{2}}^{mn}\rightarrow V_{\left(w_{1}mn\right),w_{2}}
\]

\end_inset

which is a 
\begin_inset Formula $d^{2}\left(1+\chi\right)\times\left(1+\chi\right)$
\end_inset

 matrix.
 In the paper do a thin QR decomposition
\begin_inset Formula 
\[
V_{\left(w_{1}mn\right),w_{2}}=\sum_{k=1}^{\left(1+\chi\right)}Q_{\left(w_{1}mn\right),k}R_{k,w_{2}}=\begin{bmatrix}\hat{ùïÄ} & \hat{\boldsymbol{c}}^{\prime}\\
0 & \hat{\boldsymbol{A}}^{\prime}
\end{bmatrix}\begin{bmatrix}1 & t\\
0 & \mathsf{R}
\end{bmatrix}
\]

\end_inset

where 
\begin_inset Formula $R$
\end_inset

 is upper triangular.
 They now define block respectiong QR decomposition of 
\begin_inset Formula $\hat{W}$
\end_inset

 as
\begin_inset Formula 
\[
QR\left(\hat{W}\right)=\hat{Q}R=\begin{bmatrix}\hat{ùïÄ} & \hat{\boldsymbol{c}}^{\prime} & \hat{d}\\
0 & \hat{\boldsymbol{A}}^{\prime} & \hat{\boldsymbol{b}}\\
0 & 0 & \hat{ùïÄ}
\end{bmatrix}\begin{bmatrix}1 & t & 0\\
0 & \mathsf{R} & 0\\
0 & 0 & 1
\end{bmatrix}
\]

\end_inset

In this context, block respecting just means ignore the last column and
 row for the QR decomposition.
 Now one can sweep throught the lattice
\begin_inset Formula 
\[
\boldsymbol{l}\hat{W}^{1}\hat{W}^{2}\hat{W}^{2}\cdots
\]

\end_inset


\begin_inset Formula 
\[
=\boldsymbol{l}\hat{Q}^{1}R^{1}\hat{W}^{2}\hat{W}^{2}\cdots
\]

\end_inset


\begin_inset Formula 
\[
=\boldsymbol{l}\hat{Q}^{1}\hat{W}^{2\prime}\hat{W}^{2}\cdots
\]

\end_inset


\begin_inset Formula 
\[
=\boldsymbol{l}\hat{Q}^{1}\hat{Q}^{2}R^{2}\hat{W}^{2}\cdots
\]

\end_inset


\end_layout

\begin_layout Paragraph
Lower triangular version
\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
\hat{W}=\begin{bmatrix}\hat{ùïÄ} & 0 & 0\\
\hat{\boldsymbol{c}} & \hat{\boldsymbol{A}} & 0\\
\hat{d} & \hat{\boldsymbol{b}} & \hat{ùïÄ}
\end{bmatrix}
\]

\end_inset

in general 
\begin_inset Formula $\hat{\boldsymbol{A}}$
\end_inset

 is lower triangular.
 
\begin_inset Formula 
\begin{equation}
\hat{V}=\begin{bmatrix}\hat{ùïÄ} & 0\\
\hat{\boldsymbol{c}} & \hat{\boldsymbol{A}}
\end{bmatrix}\label{eq:WlowerLeft}
\end{equation}

\end_inset

we still group
\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
V_{w_{1}w_{2}}^{mn}\rightarrow V_{\left(w_{1}mn\right),w_{2}}
\]

\end_inset


\begin_inset Formula 
\[
=\begin{bmatrix}\begin{array}{cc}
\hat{ùïÄ}^{00} & 0\\
\hat{\boldsymbol{c}}^{00} & \hat{\boldsymbol{A}}^{00}\\
\hat{ùïÄ}^{10} & 0\\
\hat{\boldsymbol{c}}^{10} & \hat{\boldsymbol{A}}^{10}\\
\vdots & \vdots\\
\hat{ùïÄ}^{mn} & 0\\
\hat{\boldsymbol{c}}^{mn} & \hat{\boldsymbol{A}}^{m,n}
\end{array}\end{bmatrix}
\]

\end_inset


\end_layout

\begin_layout Subsubsection
Finite MPO Compression
\end_layout

\begin_layout Standard
We start with a right canonical MPO
\begin_inset Formula 
\[
\hat{H}=\boldsymbol{l}\hat{W}_{R}\hat{W}_{R}\hat{W}_{R}\cdots
\]

\end_inset

and QR the first 
\begin_inset Formula $W$
\end_inset


\begin_inset Formula 
\[
\hat{H}=\boldsymbol{l}\hat{W}_{L}R\hat{W}_{R}\hat{W}_{R}\cdots
\]

\end_inset

where 
\begin_inset Formula $R$
\end_inset

 always has the block structure 
\begin_inset Formula 
\[
R=\begin{bmatrix}1 & t & 0\\
0 & \mathsf{R} & 0\\
0 & 0 & 1
\end{bmatrix}
\]

\end_inset

which can be decomposed as
\begin_inset Formula 
\[
R=MR^{\prime}=\begin{bmatrix}1 & 0 & 0\\
0 & \mathsf{M} & 0\\
0 & 0 & 1
\end{bmatrix}\begin{bmatrix}1 & t & 0\\
0 & ùïÄ & 0\\
0 & 0 & 1
\end{bmatrix}=\begin{bmatrix}1 & t & 0\\
0 & \mathsf{M} & 0\\
0 & 0 & 1
\end{bmatrix}
\]

\end_inset

So 
\begin_inset Formula $\mathsf{M}=\mathsf{R}$
\end_inset

 so why did they introduce 
\begin_inset Formula $\mathsf{M}$
\end_inset

 at all??!? Any way the secret sauce here is to just SVD compress 
\begin_inset Formula $\mathsf{R}$
\end_inset


\begin_inset Formula 
\[
\mathsf{R}=UsV^{\dagger}
\]

\end_inset

which gives us 
\begin_inset Formula $\chi$
\end_inset

 singular values to look at and cull.
 These should all be intensive, i.e.
 not grow exponentially with system size.
 We can absorbe 
\begin_inset Formula $U$
\end_inset

 to the left 
\begin_inset Formula $\hat{W}_{L}^{\prime}=\hat{W}_{L}U$
\end_inset

 and maintain canonical form, and similarly we can absorb 
\begin_inset Formula $sV^{\dagger}$
\end_inset

 and 
\begin_inset Formula $R^{\prime}$
\end_inset

 to the right 
\begin_inset Formula $\hat{W}_{R}^{\prime}=sV^{\dagger}R^{\prime}\hat{W}_{R}$
\end_inset

.
 We can truncate 
\begin_inset Formula $s$
\end_inset

 and drop the corresponding rows of 
\begin_inset Formula $\hat{W}_{L}^{\prime}$
\end_inset

 and columns of 
\begin_inset Formula $\hat{W}_{R}^{\prime}$
\end_inset

.
\end_layout

\begin_layout Standard
A version for two site unit cell appears in 
\begin_inset CommandInset citation
LatexCommand cite
key "Soejima2020"
literal "false"

\end_inset


\end_layout

\begin_layout Subsection
Contracting iTEBD state with an iMPO
\end_layout

\begin_layout Standard
In order for the resulting singular values to be interpreted as Schmidt
 coefficients we need contract a symmetric state like 
\begin_inset Formula $\cdots\boldsymbol{\lambda}^{A}\boldsymbol{\Gamma}^{m_{b}}\boldsymbol{\lambda}^{B}\boldsymbol{\Gamma}^{m_{a}}\boldsymbol{\lambda}^{A}\cdots$
\end_inset

 (with hindsight we start backwards with 
\begin_inset Formula $\lambda^{B}$
\end_inset

 in the middle).
 But in the second step we need a repeating unit cell like 
\begin_inset Formula $\cdots\boldsymbol{\lambda}^{A}\boldsymbol{\Gamma}^{m_{b}}\boldsymbol{\lambda}^{B}\boldsymbol{\Gamma}^{m_{a}}\cdots$
\end_inset

.
 The solution is to start with 
\begin_inset Formula $\cdots\boldsymbol{\lambda}^{A}\boldsymbol{\Gamma}^{m_{b}}\boldsymbol{\lambda}^{B}\boldsymbol{\Gamma}^{m_{a}}\boldsymbol{\lambda}^{A}\frac{1}{\boldsymbol{\lambda}^{A}}\cdots$
\end_inset

 and only contract the symmetric part in the first step.
 But before we proceed with contraction note that the 
\begin_inset Formula $\frac{1}{\boldsymbol{\lambda}^{A}}$
\end_inset

 factor on the right has dimension 
\begin_inset Formula $D$
\end_inset

 and is only connected to the internal iMPS index, and is not connected
 to the 
\begin_inset Formula $D_{w}$
\end_inset

 internal indices of the iMPO.
 
\end_layout

\begin_layout Standard
We wish to contract 
\begin_inset Formula $\cdots\boldsymbol{\lambda}^{A}\boldsymbol{\Gamma}^{m_{b}}\boldsymbol{\lambda}^{B}\boldsymbol{\Gamma}^{m_{a}}\boldsymbol{\lambda}^{A}\cdots$
\end_inset

 with an iMPO
\begin_inset Formula 
\[
\Theta^{BA}=\Theta_{\left(i_{1}w_{1}\right)\left(i_{3}w_{3}\right)}^{BA\left(n_{b}n_{a}\right)}=\sum_{m_{b}m_{a}=0}^{d-1}\sum_{i_{2}=1}^{D}\sum_{w_{2}=1}^{D_{w}}\lambda_{i_{1}}^{A}\Gamma_{i_{1}i_{2}}^{m_{b}}\lambda_{i_{2}}^{B}\Gamma_{i_{2}i_{3}}^{m_{a}}\lambda_{i_{3}}^{A}W_{w_{1}w_{2}}^{m_{b}n_{b}}W_{w_{2}w_{3}}^{m_{a}n_{a}}
\]

\end_inset

where 
\begin_inset Formula $\Theta^{BA}$
\end_inset

 has two physical indecies each with dimension 
\begin_inset Formula $d$
\end_inset

 and two combined internal indices with dimension 
\begin_inset Formula $DD_{w}$
\end_inset

.
 We can reshape it to get a 
\begin_inset Formula $dDD_{w}\times dDD_{w}$
\end_inset

 matrix which then ready to be subjected to SVD 
\begin_inset Formula 
\[
\Theta_{\left(i_{1}w_{1}\right)\left(i_{3}w_{3}\right)}^{BA\left(n_{b}n_{a}\right)}\rightarrow\Theta_{\left(i_{1}w_{1}n_{b}\right)\left(i_{3}w_{3}n_{a}\right)}^{BA}=\sum_{k=1}^{dDD_{w}}U_{\left(i_{1}w_{1}n_{b}\right)k}\tilde{\lambda}_{k}^{B}V_{k\left(i_{3}w_{3}n_{a}\right)}^{\dagger}.
\]

\end_inset


\begin_inset Formula 
\[
\approx\sum_{k=1}^{D}\tilde{U}_{\left(i_{1}w_{1}n_{b}\right)k}\tilde{\lambda}_{k}^{B}\tilde{V}_{k\left(i_{3}w_{3}n_{a}\right)}^{\dagger}=\tilde{\Theta}_{\left(i_{1}w_{1}n_{b}\right)\left(i_{3}w_{3}n_{a}\right)}^{BA}
\]

\end_inset

This gives us singular values that are interpreted as an updated 
\begin_inset Formula $\boldsymbol{\lambda}^{B}$
\end_inset

 which we mark with a tilde, 
\begin_inset Formula $\tilde{\boldsymbol{\lambda}}^{B}$
\end_inset

.
 We then compress 
\begin_inset Formula $\tilde{\boldsymbol{\lambda}}^{B}$
\end_inset

 from dimension 
\begin_inset Formula $dDD_{w}$
\end_inset

 down to 
\begin_inset Formula $D$
\end_inset

.
 
\begin_inset Formula $\tilde{U}$
\end_inset

 now has 
\begin_inset Formula $D$
\end_inset

columns and 
\begin_inset Formula $\tilde{V}^{\dagger}$
\end_inset

 has 
\begin_inset Formula $D$
\end_inset

 rows.
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout

\end_layout

\begin_layout Plain Layout
\begin_inset Graphics
	filename iMPOiTBED1.png
	lyxscale 60
	scale 50

\end_inset


\begin_inset Caption Standard

\begin_layout Plain Layout
Contraction and SVD of an iMPO with an iTEBD state, both having a two site
 unit cell.
 Line thickness is a rough indication of the dimension of each external
 and internal index.
\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout

\end_layout

\end_inset

 At this point our repeating state vector looks like
\begin_inset Formula 
\[
\cdots\tilde{\Theta}_{\left(i_{1}w_{1}n_{b}\right)\left(i_{3}w_{3}n_{a}\right)}^{BA}\frac{1}{\lambda_{i_{3}}^{A}}\tilde{\Theta}_{\left(i_{3}w_{3}n_{b+1}\right)\left(i_{5}w_{5}n_{a+1}\right)}^{BA}\frac{1}{\lambda_{i_{5}}^{A}}\cdots=\cdots\tilde{\boldsymbol{U}}^{n_{b}}\tilde{\boldsymbol{\lambda}}^{B}\boldsymbol{\tilde{V}}^{\dagger n_{a}}\frac{1}{\boldsymbol{\lambda}^{A}}\tilde{\boldsymbol{U}}^{n_{b+1}}\tilde{\boldsymbol{\lambda}}^{B}\boldsymbol{\tilde{V}}^{\dagger n_{a+1}}\frac{1}{\boldsymbol{\lambda}^{A}}\cdots
\]

\end_inset

We need to contract 
\begin_inset Formula 
\[
\Theta^{AB}=\tilde{\boldsymbol{\lambda}}^{B}\tilde{\boldsymbol{V}}^{\dagger n_{a}}\frac{1}{\boldsymbol{\lambda}^{A}}\tilde{\boldsymbol{U}}^{n_{b}}\tilde{\boldsymbol{\lambda}}^{B}
\]

\end_inset

or with all indices
\begin_inset Formula 
\[
\Theta_{i_{1}i_{3}}^{AB\left(n_{a}n_{b}\right)}=\sum_{i_{2}=1}^{D}\sum_{w_{2}=1}^{D_{w}}\tilde{\lambda}_{i_{1}}^{B}V_{i_{1}\left(i_{2}w_{2}\right)}^{\dagger n_{a}}\frac{1}{\lambda_{i_{2}}^{A}}U_{\left(i_{2}w_{2}\right)i_{3}}^{n_{b}}\tilde{\lambda}_{i_{3}}^{B},\;1\leq i_{1},i_{3}\leq D
\]

\end_inset


\begin_inset Formula 
\[
=
\]

\end_inset

Notice again that 
\begin_inset Formula $\lambda_{i_{2}}^{A}$
\end_inset

 has no 
\begin_inset Formula $w_{2}$
\end_inset

 index.
 In software we can make a diagonal 
\begin_inset Formula $\frac{1}{\lambda_{i_{2}w_{2}}^{A}}$
\end_inset

 matrix which is just 
\begin_inset Formula $D_{w}$
\end_inset

 copies of 
\begin_inset Formula $\frac{1}{\lambda_{i_{2}}^{A}}$
\end_inset

.
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout

\end_layout

\begin_layout Plain Layout
\begin_inset Graphics
	filename iMPOiTBED2.png
	lyxscale 50
	scale 40

\end_inset


\begin_inset Graphics
	filename iMPOiTBED3.png
	lyxscale 50
	scale 50

\end_inset


\begin_inset Caption Standard

\begin_layout Plain Layout
a) The repeating unit after SVD, b) the repeating unit after rotating the
 center, c) Stage two contraction and SVD in order to restore the iTEBD
 state structure.
\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout

\end_layout

\end_inset

 Before proceeding with a second SVD we need to reshape 
\begin_inset Formula $V^{\dagger}$
\end_inset

 and 
\begin_inset Formula $U$
\end_inset

.
 The key here is to move the physical indices from the inside to the outside
 of the 
\begin_inset Formula $VU$
\end_inset

 matrix product.)
\begin_inset Formula 
\[
U_{\left(i_{1}wn_{b}\right)i_{2}}\rightarrow U_{\left(i_{1}w\right)i_{2}}^{n_{b}}\rightarrow U_{\left(i_{1}w\right)\left(i_{2}n_{b}\right)},\quad DD_{w}d\times D\rightarrow DD_{w}\times Dd
\]

\end_inset


\begin_inset Formula 
\[
V_{i_{1}\left(i_{2}wn_{a}\right)}^{\dagger}\rightarrow V_{i_{1}\left(i_{2}w\right)}^{\dagger n_{a}}\rightarrow V_{\left(i_{1}n_{a}\right)\left(i_{2}w\right)}^{\dagger},\quad D\times DD_{w}d\rightarrow Dd\times DD_{w}
\]

\end_inset

and define
\begin_inset Formula 
\[
\Theta_{\left(i_{1}n_{a}\right)\left(i_{3}n_{b}\right)}^{AB}=\sum_{i_{2}=1}^{D_{A}}\sum_{w_{2}=1}^{D_{w}}V_{\left(i_{1}n_{a}\right)\left(i_{2}w_{2}\right)}^{\dagger}\frac{1}{\lambda_{i_{2}}^{A}}U_{\left(i_{2}w_{2}\right)\left(i_{3}n_{b}\right)}
\]

\end_inset


\end_layout

\begin_layout Standard
Now we proceed as before and SVD/compress 
\begin_inset Formula $\Gamma$
\end_inset

 (which has dimensions 
\begin_inset Formula $Dd\times Dd$
\end_inset

)
\begin_inset Formula 
\[
\Gamma_{\left(i_{1}n_{a}\right)\left(i_{3}n_{b}\right)}=\sum_{k=1}^{D_{x}d}P_{i_{1}k}^{n_{a}}\tilde{\lambda}_{k}^{A}Q_{ki_{3}}^{\dagger n_{b}}\approx\sum_{k=1}^{D}\tilde{P}_{i_{1}k}^{n_{a}}\tilde{\lambda}_{k}^{A}\tilde{Q}_{ki_{3}}^{\dagger n_{b}}.
\]

\end_inset

Now we can recover
\begin_inset Formula 
\[
\tilde{\Gamma}_{ik}^{n_{a}}=\frac{\tilde{P}_{ik}^{n_{a}}}{\tilde{\lambda}_{i}^{B}},\;\tilde{\Gamma}_{kj}^{n_{b}}=\frac{V_{kj}^{\dagger n_{b}}}{\tilde{\lambda}_{j}^{B}}
\]

\end_inset


\end_layout

\begin_layout Section
Infinite Time Evolved Block Decimation (iTBED)
\begin_inset CommandInset label
LatexCommand label
name "subsec:Infinite-Time-Evolved"

\end_inset


\end_layout

\begin_layout Subsection
Original algorithm 
\begin_inset CommandInset citation
LatexCommand cite
key "Vidal2007"
literal "false"

\end_inset


\end_layout

\begin_layout Standard
This technique usually starts Vidal's canonical form, eq.
 
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:Vidal Canonical"
plural "false"
caps "false"
noprefix "false"

\end_inset

 adapted for a repeating unit 2-site cell
\begin_inset Formula 
\[
\ldots\left(\Gamma^{n_{A}}\lambda^{A}\Gamma^{n_{B}}\lambda^{B}\right)\ldots
\]

\end_inset

For the time evolution we will have two Trotter gates 
\begin_inset Formula $U^{AB}=e^{-\tau H^{AB}}$
\end_inset

 and 
\begin_inset Formula $U^{BA}$
\end_inset


\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\begin_inset Graphics
	filename iTEBD-1.png
	lyxscale 50
	scale 30

\end_inset


\begin_inset Caption Standard

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "fig:Vidals-original-iTEBD"

\end_inset

Vidal's original iTEBD algorithm for a 1D lattice with a two site unit cell
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
The algorithm is shown in Figure 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:Vidals-original-iTEBD"
plural "false"
caps "false"
noprefix "false"

\end_inset

 for the 
\begin_inset Formula $U^{AB}$
\end_inset

gate.
 We see that the first step involves contracting 
\begin_inset Formula $\lambda^{B}$
\end_inset

 on the left into 
\begin_inset Formula $\Gamma^{n_{A}}$
\end_inset

 and 
\begin_inset Formula $\lambda^{A}$
\end_inset

 on the right into 
\begin_inset Formula $\Gamma^{n_{B}}$
\end_inset

.
 So we should write out the steps in more detail as follows
\end_layout

\begin_layout Enumerate
Start with the structure 
\begin_inset Formula $\lambda^{B}\Gamma^{n_{a}}\lambda^{A}\Gamma^{n_{b}}\lambda^{B}$
\end_inset


\end_layout

\begin_layout Enumerate
For 
\begin_inset Formula $A^{n_{a}}=\lambda^{B}\Gamma^{n_{a}}$
\end_inset

, 
\begin_inset Formula $B^{n_{b}}=\Gamma^{n_{b}}\lambda^{B}$
\end_inset


\end_layout

\begin_layout Enumerate
Contract 
\begin_inset Formula $\varTheta_{i_{a}i_{b}}^{m_{a}m_{b}}=\sum_{n_{a}n_{b}k}A_{i_{a}k}^{n_{a}}\lambda_{k}^{A}B_{ki_{b}}^{n_{b}}U_{m_{a}m_{b}}^{n_{a}n_{b}}$
\end_inset


\end_layout

\begin_layout Enumerate
SVD 
\begin_inset Formula $\varTheta_{i_{a}i_{b}}^{m_{a}m_{b}}=\sum_{k=1}^{dD}U_{\left(i_{a}m_{a}\right),k}s_{k}\left(V^{\dagger}\right)_{k,\left(i_{b}m_{b}\right)}$
\end_inset


\end_layout

\begin_layout Enumerate
Do SVD compression the throw out 
\begin_inset Formula $\left(d-1\right)D$
\end_inset

 columns of 
\begin_inset Formula $U$
\end_inset

 and rows of 
\begin_inset Formula $V^{\dagger}$
\end_inset

.
\end_layout

\begin_layout Enumerate
Now 
\begin_inset Formula $\tilde{\lambda}^{A}=s_{k}$
\end_inset

, 
\begin_inset Formula $\tilde{\Gamma}_{i_{a}i_{a+1}}^{n_{a}}=\frac{1}{\lambda_{i_{a}}^{B}}U_{\left(i_{a}n_{a}\right),i_{a+1}}$
\end_inset

, 
\begin_inset Formula $\tilde{\Gamma}_{i_{b-1}i_{b}}^{n_{b}}=\left(V^{\dagger}\right)_{i_{b-1},\left(i_{b}n_{b}\right)}\frac{1}{\lambda_{i_{b}}^{B}}$
\end_inset

 
\end_layout

\begin_layout Enumerate
This leave us with he structure 
\begin_inset Formula $\lambda^{B}\tilde{\Gamma}^{n_{a}}\tilde{\lambda}^{A}\tilde{\Gamma}^{n_{b}}\lambda^{B}$
\end_inset

 with everything but 
\begin_inset Formula $\lambda^{B}$
\end_inset

 updated.
\end_layout

\begin_layout Enumerate
Repeat steps 2-7 with the structure 
\begin_inset Formula $\tilde{\lambda}^{A}\tilde{\Gamma}^{n_{b}}\lambda^{B}\tilde{\Gamma}^{n_{a}}\tilde{\lambda}^{A}$
\end_inset


\end_layout

\begin_layout Subsubsection
Second order Trotter version
\end_layout

\begin_layout Standard
In order to adapt this for the a second order trotter approximation we can
 define
\begin_inset Formula 
\[
\hat{U}^{AB}=\exp\left(-\frac{\tau}{2}\hat{H}^{AB}\right)
\]

\end_inset


\begin_inset Formula 
\[
\hat{U}^{BA}=\exp\left(-\tau\hat{H}^{AB}\right)
\]

\end_inset

We need to do:
\end_layout

\begin_layout Enumerate
Start with the structure 
\begin_inset Formula $\lambda^{B}\Gamma^{n_{a}}\lambda^{A}\Gamma^{n_{b}}\lambda^{B}$
\end_inset


\end_layout

\begin_layout Enumerate
For 
\begin_inset Formula $A^{n_{a}}=\lambda^{B}\Gamma^{n_{a}}$
\end_inset

, 
\begin_inset Formula $B^{n_{b}}=\Gamma^{n_{b}}\lambda^{B}$
\end_inset


\end_layout

\begin_layout Enumerate
Contract 
\begin_inset Formula $\boldsymbol{\varTheta}^{m_{a}m_{b}}=\sum_{n_{a}n_{b}}\boldsymbol{A}^{n_{a}}\boldsymbol{\lambda}^{A}\boldsymbol{B}^{n_{b}}U_{m_{a}m_{b}}^{ABn_{a}n_{b}}$
\end_inset


\end_layout

\begin_layout Enumerate
SVD 
\begin_inset Formula $\varTheta_{i_{a}i_{b}}^{m_{a}m_{b}}=\sum_{k=1}^{dD}U_{\left(i_{a}m_{a}\right),k}s_{k}\left(V^{\dagger}\right)_{k,\left(i_{b}m_{b}\right)}$
\end_inset


\end_layout

\begin_layout Enumerate
Now 
\begin_inset Formula $\tilde{\lambda}^{A}=s_{k}$
\end_inset

, 
\begin_inset Formula $\tilde{\Gamma}_{i_{a}i_{a+1}}^{n_{a}}=\frac{1}{\lambda_{i_{a}}^{B}}U_{\left(i_{a}n_{a}\right),i_{a+1}}$
\end_inset

, 
\begin_inset Formula $\tilde{\Gamma}_{i_{b-1}i_{b}}^{n_{b}}=\left(V^{\dagger}\right)_{i_{b-1},\left(i_{b}n_{b}\right)}\frac{1}{\lambda_{i_{b}}^{B}}$
\end_inset

 
\end_layout

\begin_layout Enumerate
Contract 
\begin_inset Formula $\boldsymbol{\varTheta}^{m_{a}m_{b}}=\sum_{n_{a}n_{b}}\boldsymbol{B}^{n_{a}}\boldsymbol{\lambda}^{B}A^{n_{b}}U_{m_{a}m_{b}}^{BAn_{a}n_{b}}$
\end_inset


\end_layout

\begin_layout Enumerate
Now 
\begin_inset Formula $\tilde{\lambda}^{B}=s_{k}$
\end_inset

, 
\begin_inset Formula $\tilde{\Gamma}_{i_{b}i_{b+1}}^{n_{b}}=\frac{1}{\lambda_{i_{b}}^{A}}U_{\left(i_{b}n_{b}\right),i_{b+1}}$
\end_inset

, 
\begin_inset Formula $\tilde{\Gamma}_{i_{a-1}i_{a}}^{n_{a}}=\left(V^{\dagger}\right)_{i_{a-1},\left(i_{a}n_{a}\right)}\frac{1}{\lambda_{i_{a}}^{A}}$
\end_inset


\end_layout

\begin_layout Enumerate
Contract 
\begin_inset Formula $\boldsymbol{\varTheta}^{m_{a}m_{b}}=\sum_{n_{a}n_{b}}\boldsymbol{A}^{n_{a}}\boldsymbol{\lambda}^{A}\boldsymbol{B}^{n_{b}}U_{m_{a}m_{b}}^{ABn_{a}n_{b}}$
\end_inset


\end_layout

\begin_layout Enumerate
Now 
\begin_inset Formula $\tilde{\lambda}^{A}=s_{k}$
\end_inset

, 
\begin_inset Formula $\tilde{\Gamma}_{i_{a}i_{a+1}}^{n_{a}}=\frac{1}{\lambda_{i_{a}}^{B}}U_{\left(i_{a}n_{a}\right),i_{a+1}}$
\end_inset

, 
\begin_inset Formula $\tilde{\Gamma}_{i_{b-1}i_{b}}^{n_{b}}=\left(V^{\dagger}\right)_{i_{b-1},\left(i_{b}n_{b}\right)}\frac{1}{\lambda_{i_{b}}^{B}}$
\end_inset


\end_layout

\begin_layout Enumerate
Do SVD compression the throw out 
\begin_inset Formula $\left(d^{3}-1\right)D$
\end_inset

 columns of 
\begin_inset Formula $U$
\end_inset

 and rows of 
\begin_inset Formula $V^{\dagger}$
\end_inset

.
\end_layout

\begin_layout Enumerate
Repeat steps 2-10.
\end_layout

\begin_layout Standard
This looks tedious.
 We should be able SVD 
\begin_inset Formula $\hat{U}^{AB}$
\end_inset

 and 
\begin_inset Formula $\hat{U}^{BA}$
\end_inset

 into iMPOs and avoid 2/3s the SVDs during the iterations.
 If that works then we should also be able the Combine the MPOs into one
 MPO and apply that.
 If the works then we should be able to compress the combined iMPO and still
 get a meaningful second order iteration.
 Somewhere in this chain of reasoning, the second order effect seems to
 vanish, but where?
\end_layout

\begin_layout Subsection
Maintaining Orthogonality
\end_layout

\begin_layout Standard
If we keep the full SVD in step 4 above then we would always keep orthonormality
\begin_inset Formula 
\[
U^{\dagger}U=VV^{\dagger}=1
\]

\end_inset

in terms of lambda-gamma we have
\begin_inset Formula 
\[
U^{\dagger}U=\sum_{n_{a}}\left(\lambda^{B}\Gamma^{n_{a}}\right)^{\dagger}\lambda^{B}\Gamma^{n_{a}}=\sum_{n_{a}}\Gamma_{ik}^{*n_{a}}\lambda_{k}^{B}\lambda_{k}^{B}\Gamma_{k,j}^{n_{a}}=\sum_{n_{a}}\Gamma_{ik}^{*n_{a}}\rho_{kk}^{B}\Gamma_{k,j}^{n_{a}}=\delta_{ij}
\]

\end_inset


\begin_inset Formula 
\[
VV^{\dagger}=\sum_{n_{b}}\Gamma^{n_{b}}\lambda^{B}\left(\Gamma^{n_{b}}\lambda^{B}\right)^{\dagger}=\sum_{n_{b}}\Gamma_{ik}^{n_{b}}\lambda_{k}^{B}\lambda_{k}^{B}\Gamma_{k,j}^{*n_{b}}=\sum_{n_{b}}\Gamma_{ik}^{n_{b}}\rho_{kk}^{B}\Gamma_{k,j}^{*n_{b}}=\delta_{ij}.
\]

\end_inset

Similarly with the structure in 8 we get
\begin_inset Formula 
\[
U^{\dagger}U=\sum_{n_{b}}\left(\lambda^{A}\Gamma^{n_{b}}\right)^{\dagger}\lambda^{A}\Gamma^{n_{b}}=\sum_{n_{b}}\Gamma_{ik}^{*n_{b}}\rho_{kk}^{A}\Gamma_{kj}^{n_{b}}=\delta_{ij}
\]

\end_inset


\begin_inset Formula 
\[
VV^{\dagger}=\sum_{n_{a}}\Gamma^{n_{a}}\lambda^{A}\left(\Gamma^{n_{a}}\lambda^{A}\right)^{\dagger}=\sum_{n_{a}}\Gamma_{ik}^{n_{a}}\rho_{kk}^{A}\Gamma_{kj}^{*n_{a}}=\delta_{ij}
\]

\end_inset

In step 5 we truncate the singular values, after witch the orthonormality
 no longer holds true.
 The canonical form is by definition when the Schmidt decomposition about
 any bond 
\begin_inset Formula $A$
\end_inset

 is
\begin_inset Formula 
\[
\left|\psi\right\rangle =\sum_{i=1}^{D}\lambda_{i}^{A}\left|\Phi_{i}^{L}\right\rangle \left|\Phi_{i}^{R}\right\rangle 
\]

\end_inset

with 
\begin_inset Formula 
\[
\left|\Phi_{i}^{L}\right\rangle =\cdots\lambda^{A}\Gamma^{n_{b-2}}\lambda^{B}\Gamma^{n_{a-1}}\lambda^{A}\Gamma_{kj}^{n_{b-1}}\lambda_{j}^{B}\Gamma_{ji}^{n_{a0}}
\]

\end_inset


\begin_inset Formula 
\[
\left|\Phi_{i}^{R}\right\rangle =\Gamma_{ij}^{n_{b0}}\lambda_{j}^{B}\Gamma_{jk}^{n_{a1}}\lambda^{A}\Gamma^{n_{b1}}\lambda^{B}\Gamma^{n_{a2}}\cdots
\]

\end_inset

and the right and left wave functions are orthonormal
\begin_inset Formula 
\[
\left\langle \Phi_{i}^{L}|\Phi_{j}^{L}\right\rangle =\delta_{ij}=\sum_{n_{a}n_{b}}\left(\lambda^{A}\Gamma_{kj}^{n_{b}}\lambda_{j}^{B}\Gamma_{ji}^{n_{a}}\right)^{\dagger}\lambda^{A}\Gamma_{kj}^{n_{b}}\lambda_{j}^{B}\Gamma_{ji}^{n_{a}}
\]

\end_inset


\begin_inset Formula 
\[
L_{ikk'i'}=\sum_{n_{a}n_{b}}\Gamma_{ij}^{*n_{a}}\lambda_{j}^{B}\Gamma_{jk}^{*n_{b}}\lambda_{k}^{A}\lambda_{k'}^{A}\Gamma_{k'j'}^{n_{b}}\lambda_{j'}^{B}\Gamma_{j'i'}^{n_{a}}
\]

\end_inset


\begin_inset Formula 
\[
\left\langle \Phi_{i}^{R}|\Phi_{j}^{R}\right\rangle =\delta_{ij}
\]

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout

\end_layout

\begin_layout Plain Layout
\begin_inset Graphics
	filename Canonical1.png
	lyxscale 50
	scale 30

\end_inset


\begin_inset Caption Standard

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "fig:Canonical One SIte"

\end_inset

Procedure for getting an iTEBD state into canonical form, which also restores
 orthogonality.
 
\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout

\end_layout

\end_inset


\end_layout

\begin_layout Subsubsection
One site unit cell, direct
\end_layout

\begin_layout Standard
The algorithm for orthogonalizing a system with a one site unit cell is
 reusable for larger unit cells
\begin_inset CommandInset citation
LatexCommand cite
key "Orus2008"
literal "false"

\end_inset

.
 The steps are (figure 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:Canonical One SIte"
plural "false"
caps "false"
noprefix "false"

\end_inset

)
\end_layout

\begin_layout Enumerate
Calculate the right and left transfer matrices
\begin_inset Formula 
\[
R_{\left(i_{1}j_{1}\right)\left(i_{2}j_{2}\right)}=\sum_{n}\left(\varGamma_{i_{1}i_{2}}^{n}\lambda_{i_{2}}\right)\left(\varGamma_{j_{1}j_{2}}^{*n}\lambda_{j_{2}}\right)
\]

\end_inset


\begin_inset Formula 
\[
L_{\left(i_{1}j_{1}\right)\left(i_{2}j_{2}\right)}=\sum_{n}\left(\lambda_{i_{1}}\varGamma_{i_{1}i_{2}}^{n}\right)\left(\lambda_{j_{1}}\varGamma_{j_{1}j_{2}}^{*n}\right)
\]

\end_inset


\end_layout

\begin_layout Enumerate
Calculate the eigen matrices by solving
\begin_inset Formula 
\[
\sum_{i_{1}j_{1}}V_{i_{1}j_{1}}^{LT}L_{\left(i_{1}j_{1}\right)\left(i_{3}j_{3}\right)}=\eta_{L}V_{i_{3}j_{3}}^{LT}
\]

\end_inset


\begin_inset Formula 
\[
\sum_{i_{3}j_{3}}R_{\left(i_{1}j_{1}\right)\left(i_{3}j_{3}\right)}V_{i_{3}j_{3}}^{R}=\eta_{R}V_{i_{1}j_{1}}^{R}
\]

\end_inset


\end_layout

\begin_layout Enumerate
Factor 
\begin_inset Formula $V^{R}$
\end_inset

 and 
\begin_inset Formula $V^{L}$
\end_inset


\begin_inset Formula 
\[
V^{R}=UdU^{\dagger}=U\sqrt{d}\sqrt{d}U^{\dagger}=XX^{\dagger}
\]

\end_inset


\begin_inset Formula 
\[
V^{LT}=UdU^{\dagger}=U\sqrt{d}\sqrt{d}U^{\dagger}=Y^{\dagger T}Y^{T}
\]

\end_inset


\end_layout

\begin_layout Enumerate
now sandwich identities into
\begin_inset Formula 
\[
\lambda\varGamma^{n}\lambda\rightarrow Y^{T-1}Y^{T}\lambda XX^{-1}\varGamma^{n}Y^{T-1}Y^{T}\lambda XX^{-1}
\]

\end_inset

and group as follows
\begin_inset Formula 
\[
=Y^{T-1}\left(Y^{T}\lambda X\right)\left(X^{-1}\varGamma^{n}Y^{T-1}\right)\left(Y^{T}\lambda X\right)X^{-1}
\]

\end_inset


\end_layout

\begin_layout Enumerate
now SVD 
\begin_inset Formula 
\[
Y^{T}\lambda X=U\lambda^{\prime}V^{\dagger}
\]

\end_inset

giving
\begin_inset Formula 
\[
\lambda\varGamma\lambda\rightarrow Y^{T^{-1}}\left(U\lambda^{\prime}V^{\dagger}\right)\left(X^{-1}\varGamma Y^{T^{-1}}\right)\left(U\lambda^{\prime}V^{\dagger}\right)X^{-1}
\]

\end_inset


\end_layout

\begin_layout Enumerate
We can define the new 
\begin_inset Formula $\varGamma$
\end_inset

 as
\begin_inset Formula 
\begin{equation}
\Gamma^{\prime}=V^{\dagger}X^{-1}\varGamma Y^{T^{-1}}U\label{eq:CononicalGammap}
\end{equation}

\end_inset

After this procedure the new transfer matrices
\begin_inset Formula 
\[
R_{\left(i_{1}j_{1}\right)\left(i_{2}j_{2}\right)}^{\prime}=\sum_{n}\left(\varGamma_{i_{1}i_{2}}^{\prime n}\lambda_{i_{2}}^{\prime}\right)\left(\varGamma_{j_{1}j_{2}}^{*\prime n}\lambda_{j_{2}}^{\prime}\right)
\]

\end_inset


\begin_inset Formula 
\[
L_{\left(i_{1}j_{1}\right)\left(i_{2}j_{2}\right)}^{\prime}=\sum_{n}\left(\lambda_{i_{1}}^{\prime}\varGamma_{i_{1}i_{2}}^{\prime n}\right)\left(\lambda_{j_{1}}^{\prime}\varGamma_{j_{1}j_{2}}^{*\prime n}\right)
\]

\end_inset

should have the unit matrix as eigen matrices
\begin_inset Formula 
\[
\sum_{i_{1}j_{1}}\delta_{i_{1}j_{1}}L_{\left(i_{1}j_{1}\right)\left(i_{3}j_{3}\right)}^{\prime}=\eta_{L}\delta_{i_{3}j_{3}}
\]

\end_inset


\begin_inset Formula 
\[
\sum_{i_{3}j_{3}}R_{\left(i_{1}j_{1}\right)\left(i_{3}j_{3}\right)}^{\prime}\delta_{i_{3}j_{3}}=\eta_{R}\delta_{i_{1}j_{1}}
\]

\end_inset


\end_layout

\begin_layout Subsubsection
One site unit cell, iterative
\begin_inset CommandInset label
LatexCommand label
name "subsec:One-site-unit-cell"

\end_inset


\end_layout

\begin_layout Standard
In order to avoid large scale eigen vector calculations one can also use
 an iterative method to get and orthogonal state
\begin_inset CommandInset citation
LatexCommand cite
key "Phien2015"
literal "false"

\end_inset

.
 Again for one site per unit cell we do
\end_layout

\begin_layout Enumerate
Evaluate
\begin_inset Formula 
\[
V_{ij}^{L}=\sum_{nk}\left(\lambda_{k}\varGamma_{ki}^{n}\right)\left(\lambda_{k}\varGamma_{kj}^{n}\right)^{\dagger}=\sum_{kn}\varGamma_{jk}^{*n}\lambda_{k}^{2}\varGamma_{ki}^{n}
\]

\end_inset


\begin_inset Formula 
\[
V_{ij}^{R}=\sum_{nk}\left(\varGamma_{ik}^{n}\lambda_{k}\right)\left(\varGamma_{jk}^{n}\lambda_{k}\right)^{\dagger}=\sum_{nk}\varGamma_{ik}^{n}\lambda_{k}^{2}\varGamma_{kj}^{*n}
\]

\end_inset


\end_layout

\begin_layout Enumerate
As above we factor 
\begin_inset Formula $V^{R}$
\end_inset

 and 
\begin_inset Formula $V^{L}$
\end_inset


\begin_inset Formula 
\[
V^{R}=UdU^{\dagger}=U\sqrt{d}\sqrt{d}U^{\dagger}=XX^{\dagger}
\]

\end_inset


\begin_inset Formula 
\[
V^{L}=UdU^{\dagger}=U\sqrt{d}\sqrt{d}U^{\dagger}=Y^{\dagger}Y
\]

\end_inset


\end_layout

\begin_layout Enumerate
Insert the resolutions into
\begin_inset Formula 
\[
\lambda\varGamma^{n}\lambda\rightarrow Y^{T-1}Y^{T}\lambda XX^{-1}\varGamma^{n}Y^{T-1}Y^{T}\lambda XX^{-1}
\]

\end_inset


\end_layout

\begin_layout Enumerate
SVD to get 
\begin_inset Formula $\lambda^{\prime}$
\end_inset


\begin_inset Formula 
\[
Y^{T}\lambda X=U\lambda^{\prime}V^{\dagger}
\]

\end_inset


\end_layout

\begin_layout Enumerate
Evaluate
\begin_inset Formula 
\[
\Gamma^{\prime}=V^{\dagger}X^{-1}\varGamma Y^{T^{-1}}U
\]

\end_inset


\end_layout

\begin_layout Enumerate
Go back to step 1 until converged.
\end_layout

\begin_layout Subsubsection
Orthogonalization of two site unit cell
\begin_inset CommandInset label
LatexCommand label
name "subsec:Orthogonalization-of-two-site"

\end_inset


\end_layout

\begin_layout Standard
See figure 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:Canonical-2-site-unitcell"
plural "false"
caps "false"
noprefix "false"

\end_inset

 for diagrams.
\end_layout

\begin_layout Enumerate
We start with the structure 
\begin_inset Formula $\varGamma^{n_{a}}\lambda^{A}\varGamma^{n_{b}}\lambda^{B}$
\end_inset

 and define
\begin_inset Formula 
\[
\Gamma^{n}=\varGamma^{n_{a}}\lambda^{A}\varGamma^{n_{b}}
\]

\end_inset

where 
\begin_inset Formula $n$
\end_inset

 spans the 
\begin_inset Formula $d^{2}$
\end_inset

 Hilbert space of 
\begin_inset Formula $\left(n_{a}n_{b}\right).$
\end_inset

 
\end_layout

\begin_layout Enumerate
Now do steps 
\begin_inset Formula $1\rightarrow6$
\end_inset

 above with 
\begin_inset Formula $\lambda=\lambda^{B}$
\end_inset

.
 The output is 
\begin_inset Formula $\Gamma^{\prime n}$
\end_inset

and 
\begin_inset Formula $\lambda^{\prime}=\lambda^{\prime B}$
\end_inset

.
\end_layout

\begin_layout Enumerate
Reshape 
\begin_inset Formula $\Gamma_{ij}^{n\prime}\rightarrow\Gamma_{\left(in_{a}\right)\left(jn_{b}\right)}^{\prime}$
\end_inset

which has rank 
\begin_inset Formula $dD$
\end_inset

 and SVD
\begin_inset Formula 
\[
\lambda_{i}^{\prime B}\Gamma_{\left(in_{a}\right)\left(jn_{b}\right)}^{\prime}\lambda_{j}^{\prime B}\;\overrightarrow{svd}\;\sum_{k=1}^{dD}P_{\left(n_{a}i\right)k}\lambda_{kk}^{\prime A}Q_{k\left(n_{b}j\right)}\sim\sum_{k=1}^{D}P_{\left(n_{a}i\right)k}\lambda_{kk}^{\prime A}Q_{k\left(n_{b}j\right)}
\]

\end_inset


\end_layout

\begin_layout Enumerate
Calculate
\begin_inset Formula 
\[
\Gamma_{ik}^{\prime n_{a}}=\lambda_{i}^{\prime B^{-1}}P_{ik}^{n_{a}},
\]

\end_inset


\begin_inset Formula 
\[
\Gamma_{kj}^{\prime n_{b}}=Q_{kj}^{n_{b}}\lambda_{j}^{\prime B^{-1}}
\]

\end_inset


\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout
\begin_inset Graphics
	filename Canonical2.png
	lyxscale 50
	scale 30

\end_inset


\begin_inset Caption Standard

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "fig:Canonical-2-site-unitcell"

\end_inset

Canonical form for 
\begin_inset Formula $n=2$
\end_inset

 unit cell.
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Subsubsection
Orthogonalization of two site unit cell with gate
\end_layout

\begin_layout Standard
The published diagrams for this are shown in figure 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:2SiteOrthogII"
plural "false"
caps "false"
noprefix "false"

\end_inset

, but there is some uncertainty about accuracy of these diagrams.
 We also need to orthogonalize after applying a two site operator/gate like
 
\begin_inset Formula $g_{\left(m_{a}m_{b}\right)\left(n_{a}n_{b}\right)}=\exp\left(-\tau H_{\left(m_{a}m_{b}\right)\left(n_{a}n_{b}\right)}\right)$
\end_inset

.
 
\end_layout

\begin_layout Enumerate
Defining
\begin_inset Formula 
\[
\Theta_{i_{1}i_{3}}^{n}=\Theta_{i_{1}i_{3}}^{n_{a}n_{b}}=\sum_{m_{a}m_{b}}g_{\left(m_{a}m_{b}\right)\left(n_{a}n_{b}\right)}\sum_{i_{2}}\varGamma_{i_{1}i_{2}}^{m_{a}}\lambda_{i_{2}}^{A}\varGamma_{i_{2}i_{3}}^{m_{b}}
\]

\end_inset


\end_layout

\begin_layout Enumerate
Now do steps 
\begin_inset Formula $1\rightarrow6$
\end_inset

 in section 
\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:One-site-unit-cell"
plural "false"
caps "false"
noprefix "false"

\end_inset

 above with 
\begin_inset Formula $\Gamma^{n}=\Theta^{n}$
\end_inset

 and 
\begin_inset Formula $\lambda=\lambda^{B}$
\end_inset

.
 The output is 
\begin_inset Formula $\Gamma^{\prime n}$
\end_inset

and 
\begin_inset Formula $\lambda^{\prime}=\lambda^{\prime B}$
\end_inset

.
\end_layout

\begin_layout Enumerate
Now do steps 3 and 4 from section 
\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:Orthogonalization-of-two-site"
plural "false"
caps "false"
noprefix "false"

\end_inset


\end_layout

\begin_layout Standard
This is at odds with figure 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:2SiteOrthogII"
plural "false"
caps "false"
noprefix "false"

\end_inset

 where they define 
\begin_inset Formula $Y^{T}X=U\lambda^{B\prime}V^{\dagger}\neq Y^{T}\lambda^{B}X$
\end_inset

 and they define 
\begin_inset Formula 
\[
\Theta^{n}=\lambda^{B}\sum_{m_{a}m_{b}}g_{\left(m_{a}m_{b}\right)\left(n_{a}n_{b}\right)}\sum_{i_{2}}\varGamma_{i_{1}i_{2}}^{m_{a}}\lambda_{i_{2}}^{A}\varGamma_{i_{2}i_{3}}^{m_{b}}\lambda^{B}
\]

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout

\end_layout

\begin_layout Plain Layout
\begin_inset Graphics
	filename Orthogonal1.png
	lyxscale 50
	scale 20

\end_inset


\begin_inset Caption Standard

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "fig:2SiteOrthogII"

\end_inset

Details of the orthogonalized iTEBD procedure for a system with two sites
 in the unit cell.
\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout

\end_layout

\end_inset


\end_layout

\begin_layout Subsubsection
McCulloch's version
\end_layout

\begin_layout Standard
In 
\begin_inset CommandInset citation
LatexCommand cite
key "McCulloch2008"
literal "false"

\end_inset

 Ian McCulloch propose and alternate method for the orthogonalizing, that
 does not required inverted matrices.
 However he uses iDMRG language which we must translate to our notation
 used herein.
 Some translations are shown in the table.
\begin_inset Float table
wide false
sideways false
status open

\begin_layout Plain Layout

\end_layout

\begin_layout Plain Layout
\begin_inset Tabular
<lyxtabular version="3" rows="9" columns="3">
<features tabularvalignment="middle">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<row>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
iDMRG
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
iTEBD
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Description
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $A_{n}^{s}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\lambda^{B}\Gamma^{n_{a}}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Left normalized site tensor
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $B_{n}^{s}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\Gamma^{n_{b}}\lambda^{B}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Right normalized site tensor
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\Lambda_{n}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\lambda^{A}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Center matrix, Bond singular values
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\Lambda_{n-1}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\lambda^{B}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
?
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $A_{n}^{s'}\Lambda_{n}B_{n}^{s}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\lambda^{B}\Gamma^{n_{a}}\lambda^{A}\Gamma^{n_{b}}\lambda^{B}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
iDMRG central unit cell
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $A_{n-1}^{s'_{n-1}}A_{n}^{s'_{n}}\Lambda_{n}B_{n}^{s_{n}}B_{n-1}^{s_{n-1}}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\lambda^{A}\Gamma^{n_{a-1}}\lambda^{B}\Gamma^{n_{a}}\lambda^{A}\Gamma^{n_{b}}\lambda^{B}\Gamma^{n_{b-1}}\lambda^{A}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
iDMRG two interations, or double cell
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $U_{n}^{s'}\Lambda_{n}^{L}V^{\dagger}\Lambda_{n}B_{n}^{s}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\begin_inset Caption Standard

\begin_layout Plain Layout
Translation between iDMRG and iTEBD language
\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout

\end_layout

\end_inset


\end_layout

\begin_layout Standard
Starting with the central unit cell
\begin_inset Formula 
\[
A_{n}^{s}\Lambda_{n}B_{n}^{s'}=\left(\lambda^{B}\Gamma^{n_{a}}\right)\lambda^{A}\left(\Gamma^{n_{b}}\lambda^{B}\right)
\]

\end_inset

the actual repeating unit is
\begin_inset Formula 
\[
A_{n}^{s}\Lambda_{n}B_{n}^{s'}\frac{1}{\Lambda_{n-1}}=\left(\lambda^{B}\Gamma^{n_{a}}\right)\lambda^{A}\left(\Gamma^{n_{b}}\lambda^{B}\right)\frac{1}{\lambda^{B}}=\lambda^{B}\Gamma^{n_{a}}\lambda^{A}\Gamma^{n_{b}}
\]

\end_inset

which is much easier to see in the iTEBD language.
 The first step is rotate the center to the right by decomposing
\begin_inset Formula 
\[
\Lambda_{n}B_{n}^{s'}=U_{\left(s'n\right)}sV^{\dagger}=A_{n+1}^{s_{n+1}^{\prime}}\Lambda_{n}^{R}
\]

\end_inset

.
 The non-trivial catch here is that 
\begin_inset Formula $\Lambda_{n}^{R}=sV^{\dagger}$
\end_inset

 is NOT diagonal.
 Putting it all together we have
\begin_inset Formula 
\[
A_{n}^{s}\Lambda_{n}B_{n}^{s'}\frac{1}{\Lambda_{n-1}}\longrightarrow A_{n}^{s_{n}}A_{n+1}^{s_{n+1}^{\prime}}\Lambda_{n}^{R}\frac{1}{\Lambda_{n-1}}=A_{n}^{s_{n}}A_{n+1}^{s_{n+1}^{\prime}}P
\]

\end_inset

where we have defined 
\begin_inset Formula $P=\Lambda_{n}^{R}\frac{1}{\Lambda_{n-1}}.$
\end_inset

 The iMPS state is now
\begin_inset Formula 
\[
\cdots A_{n}^{s_{n}}A_{n+1}^{s_{n+1}^{\prime}}PA_{n}^{s_{n+2}}A_{n+1}^{s_{n+3}^{\prime}}PA_{n}^{s_{n+4}}A_{n+1}^{s_{n+5}^{\prime}}P\cdots
\]

\end_inset

As with standard Orthogonalization we still need to decompose the transfer
 matrix eigen vectors
\begin_inset Formula 
\[
V^{L}=XX^{\dagger}
\]

\end_inset


\begin_inset Formula 
\[
V^{R}=Y^{\dagger}Y
\]

\end_inset

notice 
\begin_inset Formula $X$
\end_inset

and 
\begin_inset Formula $Y$
\end_inset

are swapped relative to the previous versions above.
 Now the orthogonal state is given by
\begin_inset Formula 
\[
A_{n}^{s_{1}}\rightarrow XA_{n}^{s_{1}}=\tilde{A}_{n}^{s_{1}}
\]

\end_inset


\begin_inset Formula 
\[
B_{n+1}^{s_{2}}\rightarrow YB_{n+1}^{s_{2}}=\tilde{B}_{n+1}^{s_{2}}
\]

\end_inset


\begin_inset Formula 
\[
\Lambda_{n-1}\rightarrow X\Lambda_{n-1}Y=\tilde{\Lambda}_{n-1}
\]

\end_inset


\begin_inset Formula 
\[
\Lambda_{n}^{R}\rightarrow\Lambda_{n}^{R}Y
\]

\end_inset


\begin_inset Formula 
\[
\Lambda_{n}^{L}\rightarrow X\Lambda_{n}^{L}
\]

\end_inset

It looks like 
\begin_inset Formula $\tilde{\Lambda}_{n-1}$
\end_inset

 is no longer diagonal, which complicates things.
 The new unit cell is now
\begin_inset Formula 
\[
\tilde{A}_{n}^{s_{1}}\Lambda_{n}\tilde{B}_{n+1}^{s_{2}}\frac{1}{\tilde{\Lambda}_{n-1}}=\tilde{\lambda}^{B}\tilde{\Gamma}^{n_{a}}\lambda^{A}\tilde{\Gamma}^{n_{b}}
\]

\end_inset

How can we translate this into iTEBD language? We get
\begin_inset Formula 
\[
\lambda^{B}\Gamma^{n_{a}}\rightarrow X\lambda^{B}\Gamma^{n_{a}}=\tilde{\lambda}^{B}\tilde{\Gamma}^{n_{a}}
\]

\end_inset


\begin_inset Formula 
\[
\Gamma^{n_{b}}\rightarrow Y\Gamma^{n_{b}}=\tilde{\Gamma}^{n_{b}}
\]

\end_inset


\begin_inset Formula 
\[
\lambda^{B}\rightarrow X\lambda^{B}Y=\tilde{\lambda}^{B}
\]

\end_inset

if 
\begin_inset Formula $\tilde{\lambda}^{B}$
\end_inset

 is diagonal then it is easy to extract 
\begin_inset Formula $\tilde{\Gamma}^{n_{a}}$
\end_inset

 using the inverse.
 If it is not then we need to decompose it
\begin_inset Formula 
\[
\tilde{\lambda}^{B}=U\tilde{\tilde{\lambda}}^{B}V^{\dagger}
\]

\end_inset

and absorb 
\begin_inset Formula $U$
\end_inset

 and 
\begin_inset Formula $V^{\dagger}$
\end_inset

 by defining
\begin_inset Formula 
\[
\tilde{\tilde{\Gamma}}^{n_{a}}=V^{\dagger}\tilde{\Gamma}^{n_{a}}
\]

\end_inset


\begin_inset Formula 
\[
\tilde{\tilde{\Gamma}}^{n_{b}}=\tilde{\Gamma}^{n_{b}}U
\]

\end_inset

To get 
\begin_inset Formula $\tilde{\tilde{\Gamma}}^{n_{a}}$
\end_inset

 we need to solve
\begin_inset Formula 
\[
X\lambda^{B}\Gamma^{n_{a}}=\tilde{\lambda}^{B}\tilde{\Gamma}^{n_{a}}=U\tilde{\tilde{\lambda}}^{B}V^{\dagger}\tilde{\Gamma}^{n_{a}}=U\tilde{\tilde{\lambda}}^{B}\tilde{\tilde{\Gamma}}^{n_{a}}
\]

\end_inset

or
\begin_inset Formula 
\[
\frac{1}{\tilde{\tilde{\lambda}}^{B}}U^{\dagger}X\lambda^{B}\Gamma^{n_{a}}=\tilde{\tilde{\Gamma}}^{n_{a}}
\]

\end_inset


\end_layout

\begin_layout Subsection
Apply iMPO operator
\end_layout

\begin_layout Standard
An MPO operator no external virtual legs.
 In other words the internal dimension 
\begin_inset Formula $D_{w}$
\end_inset

 at the edges of the lattice is one.
 However and iMPO has 
\begin_inset Formula $D_{w}>1$
\end_inset

 at the edges of the iMPS unit cell, as the operator must connect to the
 next unit cell in each direction.
 This means that when we contract and iMPO with a iMPS we get a tensor with
 dimension 
\begin_inset Formula $DD_{w}$
\end_inset

 on each internal leg.
 For example for one site
\begin_inset Formula 
\[
\Theta_{\left(w_{1}i_{1}\right)\left(w_{2}i_{2}\right)}^{m_{a}}=\sum_{n_{a}}g_{w_{1}w_{2}}^{m_{a}n_{a}}A_{0i_{1}i_{2}}^{n_{a}}
\]

\end_inset


\begin_inset Formula 
\[
\Theta_{\left(w_{2}i_{2}\right)\left(w_{3}i_{3}\right)}^{m_{b}}=\sum_{n_{b}}g_{w_{2}3_{2}}^{m_{b}n_{b}}B_{0i_{2}i_{3}}^{n_{b}}
\]

\end_inset

and for the two sites
\begin_inset Formula 
\[
\Theta_{\left(w_{1}i_{1}\right)\left(w_{3}i_{3}\right)}^{m_{a}m_{b}}=\sum_{i_{2}=1}^{D}\sum_{w_{2}=1}^{D_{w}}\Theta_{\left(w_{1}i_{1}\right)\left(w_{2}i_{2}\right)}^{m_{a}}\Theta_{\left(w_{2}i_{2}\right)\left(w_{3}i_{3}\right)}^{m_{b}}
\]

\end_inset


\end_layout

\begin_layout Standard
The best strategy is to orthogonalize first and then SVD compress.
 At the end of the orthogonalization process we have 
\begin_inset Formula $\lambda^{\prime B}$
\end_inset

 with dimension 
\begin_inset Formula $DD_{w}$
\end_inset

 and 
\begin_inset Formula $\Gamma^{\prime m}$
\end_inset

 with dimension 
\begin_inset Formula $DD_{w}\times DD_{w}$
\end_inset

 we need a way to SVD compress these down 
\begin_inset Formula $D$
\end_inset

 and 
\begin_inset Formula $D\times D$
\end_inset

 respectively before doing the unpack process whihc involes one more level
 of compression.
\end_layout

\begin_layout Subsubsection
Direct Orthogonalization
\end_layout

\begin_layout Standard
In direct orthogonalization algorithm we end up with 
\begin_inset Formula 
\[
Y^{T}\lambda X=U\lambda^{\prime}V^{\dagger}
\]

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
\Gamma^{\prime m}=V^{\dagger}X^{-1}\varGamma^{m}Y^{T^{-1}}U
\]

\end_inset

so if we simply compress 
\begin_inset Formula $\left(U,\lambda^{\prime},V^{\dagger}\right)$
\end_inset

 together we will end up with a compressed 
\begin_inset Formula $\Gamma^{\prime}$
\end_inset

 because 
\begin_inset Formula $U$
\end_inset

 and 
\begin_inset Formula $V$
\end_inset

 are now rectangular.
\end_layout

\begin_layout Subsubsection
Iterative Orthogonalization
\end_layout

\begin_layout Standard
Things appear not so simple in the iterative scheme since the transforms
 are iterated many time and we don't want compress until right at the end.
 The odd thing is that at the end of iterations the transform matrix all
 approach unity, 
\begin_inset Formula $Y\approx X\approx U\approx V\approx I$
\end_inset

.
 AS a result compressing 
\begin_inset Formula $\Gamma^{\prime}$
\end_inset

 simply corresponds to keeping the first 
\begin_inset Formula $D$
\end_inset

 rows and columns of 
\begin_inset Formula $\Gamma^{\prime m}$
\end_inset

.
 No need to group the physical indices into the mix.
\end_layout

\begin_layout Subsubsection
No Orthogonalization
\end_layout

\begin_layout Standard
There may be situation where went to do a number of fast iteration with
 no orthogonalization.
 Starting from 
\begin_inset Formula $\Theta_{\left(w_{1}i_{1}\right)\left(w_{3}i_{3}\right)}^{m_{a}m_{b}}=\Theta_{\left(w_{1}i_{1}\right)\left(w_{3}i_{3}\right)}^{m}$
\end_inset

 we need SVD 
\begin_inset Formula 
\[
\lambda^{e}\Theta^{m}\lambda^{e}\rightarrow U^{m_{a}}sV^{\dagger m_{b}}
\]

\end_inset

where 
\begin_inset Formula $\lambda^{e}$
\end_inset

 is the extended version with 
\begin_inset Formula $D_{w}$
\end_inset

 copies of 
\begin_inset Formula $\lambda^{B}$
\end_inset

 inside.
\end_layout

\begin_layout Subsection
Environment Recycling: One site Cell
\end_layout

\begin_layout Standard
This is described in 
\begin_inset CommandInset citation
LatexCommand cite
key "Phien2015"
literal "false"

\end_inset

 section V.
 They use a MPO version of applying 
\begin_inset Formula $\exp\left(-\tau H\right)$
\end_inset

 this is achieved by doing a standard SVD decomposition of two site gate
 they call 
\begin_inset Formula $g$
\end_inset

.
\begin_inset Formula 
\[
g_{w_{1}w_{3}}^{m_{a}n_{a}m_{b}n_{b}}=\sum_{w_{2}}g_{w_{1}w_{2}}^{m_{a}n_{a}}g_{w_{2}w_{3}}^{m_{b}n_{b}}
\]

\end_inset

As usual they do everything for a one site unit which makes it almost useless
 for real iTEBD.
 In addition they omit all physical indices from 
\begin_inset Formula $A$
\end_inset

 and 
\begin_inset Formula $\Theta$
\end_inset

 so that we cannot tell how the physical indices are incorporated in reshaping
 for SVD.
 Starting with a wave function
\begin_inset Formula 
\[
\left|\psi_{A_{0}}\right\rangle =\cdots A_{0i_{1}i_{2}}^{n_{a}}\cdots=\cdots\lambda_{0i_{1}}^{A}\varGamma_{0i_{1}i_{2}}^{n_{a}}\cdots
\]

\end_inset

after operating with one gate
\begin_inset Formula 
\[
\Theta_{\left(w_{1}i_{1}\right)\left(w_{2}i_{2}\right)}^{m_{a}}=\sum_{n_{a}}g_{w_{1}w_{2}}^{m_{a}n_{a}}A_{0i_{1}i_{2}}^{n_{a}}
\]

\end_inset

if we SVD 
\begin_inset Formula $\Theta=UsV^{\dagger}$
\end_inset

 and truncate
\begin_inset Formula 
\[
\Theta_{\left(w_{1}i_{1}\right)\left(w_{2}i_{2}\right)}^{m_{a}}=\Theta_{\left(m_{a}w_{1}i_{1}\right)\left(w_{2}i_{2}\right)}=\sum_{k=1}^{DD_{w}}U_{\left(m_{a}w_{1}i_{1}\right)k}s_{kk}V_{k\left(w_{2}i_{2}\right)}^{\dagger}\sim\sum_{k=1}^{D}U_{\left(w_{1}i_{1}\right)k}^{m_{a}}s_{kk}V_{k\left(w_{2}i_{2}\right)}^{\dagger}
\]

\end_inset

On an infinite lattice this sequence repeats so we can move 
\begin_inset Formula $V$
\end_inset

 and 
\begin_inset Formula $\sqrt{s}$
\end_inset

 over to the left 
\begin_inset Formula 
\[
\sqrt{s_{kk}}V_{k\left(w_{2}i_{2}\right)}^{\dagger}U_{\left(w_{1}i_{1}\right)k_{2}}^{m_{a}}\sqrt{s_{k_{2}k_{2}}}
\]

\end_inset

and define
\begin_inset Formula 
\[
\tilde{A}^{m_{a}}=\sum_{i_{2}=1}^{DD_{w}}\sqrt{s_{i_{1}i_{1}}}V_{i_{1}i_{2}}^{\dagger}U_{i_{2}i_{3}}^{m_{a}}\sqrt{s_{i_{3}i_{3}}}=\sqrt{\tilde{\lambda}}\tilde{\varGamma}^{m_{a}}\sqrt{\tilde{\lambda}}
\]

\end_inset

where 
\begin_inset Formula $i_{1}$
\end_inset

 and 
\begin_inset Formula $i_{3}$
\end_inset

 range from 1 to 
\begin_inset Formula $D$
\end_inset

 (not 
\begin_inset Formula $DD_{w}$
\end_inset

).
 This truncation is equivalent to finding matrices 
\begin_inset Formula $Q$
\end_inset

 and 
\begin_inset Formula $P$
\end_inset

 such than
\begin_inset Formula 
\[
\tilde{A}^{m_{a}}=Q\Theta^{m_{a}}P
\]

\end_inset

 where 
\begin_inset Formula $Q$
\end_inset

 is a 
\begin_inset Formula $D\times DD_{w}$
\end_inset

 matrix and 
\begin_inset Formula $P$
\end_inset

 is 
\begin_inset Formula $DD_{w}\times D$
\end_inset

.These matrices are said to carry information about the environment.
 The article fails to mention how one finds 
\begin_inset Formula $Q$
\end_inset

 and 
\begin_inset Formula $P$
\end_inset

.
 If we define 
\begin_inset Formula $s^{\prime}$
\end_inset

 as the compressed version 
\begin_inset Formula $s$
\end_inset

 and substitute
\begin_inset Formula 
\[
\tilde{A}^{m_{a}}=s^{\prime}V^{\dagger}U^{m_{a}}=QU^{m_{a}}sV^{\dagger}P
\]

\end_inset

or
\begin_inset Formula 
\[
s^{\prime}=QUsV^{\dagger}PU^{\dagger}V
\]

\end_inset


\begin_inset Formula 
\[
s^{\prime}=Q^{\prime}sP^{\prime}
\]

\end_inset


\begin_inset Formula 
\[
s_{ii}^{\prime}=\sum_{k}Q_{ik}^{\prime}s_{kk}P_{ki}^{\prime}
\]

\end_inset

we can see that
\begin_inset Formula 
\[
Q_{ik}^{\prime}=\begin{cases}
\delta_{ik} & k\leq D\\
0 & k>D
\end{cases}
\]

\end_inset


\begin_inset Formula 
\[
P_{ki}^{\prime}=\begin{cases}
\delta_{ki} & k\leq D\\
0 & k>D
\end{cases}
\]

\end_inset

and we get
\begin_inset Formula 
\[
Q=Q^{\prime}U^{\dagger}
\]

\end_inset


\begin_inset Formula 
\[
P=VP^{\prime}V^{\dagger}U
\]

\end_inset

On the other hand if we are using 
\begin_inset Formula $A=\sqrt{s^{\prime}}V^{\dagger}U\sqrt{s^{\prime}}$
\end_inset

 then it gets a little more complicated
\begin_inset Formula 
\[
\sqrt{s^{\prime}}V^{\dagger}U\sqrt{s^{\prime}}=QUsV^{\dagger}P
\]

\end_inset


\begin_inset Formula 
\[
I_{D}=V\frac{1}{\sqrt{s^{\prime}}}QUsV^{\dagger}P\frac{1}{\sqrt{s^{\prime}}}U^{\dagger}=V\frac{1}{\sqrt{s^{\prime}}}QU\sqrt{s}I_{DD_{w}}\sqrt{s}V^{\dagger}P\frac{1}{\sqrt{s^{\prime}}}U^{\dagger}
\]

\end_inset


\begin_inset Formula 
\[
I_{D}=Q^{\prime}I_{DD_{w}}P^{\prime}
\]

\end_inset

where 
\begin_inset Formula $Q^{\prime}$
\end_inset

 and 
\begin_inset Formula $P^{\prime}$
\end_inset

 have the same definition as above.
 Now
\begin_inset Formula 
\[
Q=\sqrt{s^{\prime}}V^{\dagger}Q^{\prime}\frac{1}{\sqrt{s}}U^{\dagger}
\]

\end_inset


\begin_inset Formula 
\[
P=V\frac{1}{\sqrt{s}}P^{\prime}U\sqrt{s^{\prime}}
\]

\end_inset


\end_layout

\begin_layout Standard
Proceeding in an optimistic fog the next step is to run 
\begin_inset Formula $\tilde{\lambda}\tilde{\varGamma}^{m_{a}}$
\end_inset

 through the orthogonalization mill to get 
\begin_inset Formula 
\[
\tilde{\lambda}\tilde{\varGamma}^{m_{a}}\underset{\longrightarrow}{orth}\tilde{\lambda}_{1}\tilde{\varGamma}_{1}^{m_{a}}
\]

\end_inset

and define
\begin_inset Formula 
\[
\tilde{A}_{1}=\sqrt{\tilde{\lambda}_{1}}\tilde{\varGamma}_{1}^{m_{a}}\sqrt{\tilde{\lambda}_{1}}=Q_{c}\tilde{A}P_{c}
\]

\end_inset

where 
\begin_inset Formula $Q_{c}$
\end_inset

 and 
\begin_inset Formula $P_{c}$
\end_inset

 are both 
\begin_inset Formula $D\times D$
\end_inset

.
 Now we use eq 
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:CononicalGammap"
plural "false"
caps "false"
noprefix "false"

\end_inset

 (which implies usage the direct orthogonalization as opposed to the iterative
 one)
\begin_inset Formula 
\[
\sqrt{\tilde{\lambda}_{1}}\tilde{\varGamma}_{1}^{m_{a}}\sqrt{\tilde{\lambda}_{1}}=\sqrt{\tilde{\lambda}_{1}}V^{\dagger}X^{-1}\tilde{\varGamma}^{m_{a}}Y^{T^{-1}}U\sqrt{\tilde{\lambda}_{1}}
\]

\end_inset


\begin_inset Formula 
\[
=\sqrt{\tilde{\lambda}_{1}}V^{\dagger}X^{-1}\tilde{\lambda}^{-\nicefrac{1}{2}}\tilde{A}^{m_{a}}\tilde{\lambda}^{-\nicefrac{1}{2}}Y^{T^{-1}}U\sqrt{\tilde{\lambda}_{1}}
\]

\end_inset

from which we can read off
\begin_inset Formula 
\[
Q_{c}=\sqrt{\tilde{\lambda}_{1}}V^{\dagger}X^{-1}\tilde{\lambda}^{-\nicefrac{1}{2}}
\]

\end_inset

and
\begin_inset Formula 
\[
P_{c}=\tilde{\lambda}^{-\nicefrac{1}{2}}Y^{T^{-1}}U\sqrt{\tilde{\lambda}_{1}}
\]

\end_inset

The next step is to relate
\begin_inset Formula 
\[
\tilde{A}_{1}=UA_{0}U^{\dagger}
\]

\end_inset

From section III B1 of 
\begin_inset CommandInset citation
LatexCommand cite
key "Phien2015"
literal "false"

\end_inset

 we know that 
\begin_inset Formula $U$
\end_inset

 is just the dominant eigen matrix of the transfer matrix
\begin_inset Formula 
\[
E=\sum_{m_{a}}\left(\tilde{A}_{1}^{m_{a}}\right)^{\dagger}A_{0}^{m_{a}}
\]

\end_inset


\begin_inset Formula 
\[
E_{\left(i_{1}j_{1}\right)\left(i_{2}j_{2}\right)}=\sum_{m_{a}}\tilde{A}_{1j_{1}j_{2}}^{*m_{a}}A_{0i_{1}i_{2}}^{m_{a}}
\]

\end_inset

Finally we combine everything into a gate
\begin_inset Formula 
\[
G=U^{\dagger}Q_{c}QgPP_{c}U
\]

\end_inset

which from the diagram 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:The-renormalized-gate"
plural "false"
caps "false"
noprefix "false"

\end_inset

 has 6 indices
\begin_inset Formula 
\[
G_{i_{1}i_{1}j_{1}j_{2}}^{m_{a}n_{a}}=U^{\dagger}Q_{c}Qg^{m_{a}n_{a}}PP_{c}U
\]

\end_inset


\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout

\end_layout

\begin_layout Plain Layout
\begin_inset Graphics
	filename RenormalizedGate.png
	scale 40

\end_inset


\begin_inset Caption Standard

\begin_layout Plain Layout
\begin_inset CommandInset label
LatexCommand label
name "fig:The-renormalized-gate"

\end_inset

The renormalized gate used for environment recycling in 
\begin_inset CommandInset citation
LatexCommand cite
key "Phien2015"
literal "false"

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout

\end_layout

\end_inset


\end_layout

\begin_layout Subsubsection
Environment Recycling: Two site unit cell
\end_layout

\begin_layout Paragraph
Try and create two gates
\end_layout

\begin_layout Standard
I think it makes sense to make separate renormalized gates for sites A and
 B.
 Let's see what happens when we do this:
\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
\left|\psi_{A_{0}B_{0}}\right\rangle =\cdots A_{0i_{1}i_{2}}^{n_{a}}B_{0i_{2}i_{3}}^{n_{b}}\cdots=\cdots\lambda_{0i_{1}}^{A}\varGamma_{0i_{1}i_{2}}^{n_{a}}\lambda_{0i_{2}}^{B}\varGamma_{0i_{2}i_{3}}^{n_{b}}\cdots
\]

\end_inset

after operating with one gate
\begin_inset Formula 
\[
\Theta_{\left(w_{1}i_{1}\right)\left(w_{2}i_{2}\right)}^{m_{a}}=\sum_{n_{a}}g_{w_{1}w_{2}}^{m_{a}n_{a}}A_{0i_{1}i_{2}}^{n_{a}}
\]

\end_inset


\begin_inset Formula 
\[
\Theta_{\left(2_{1}i_{2}\right)\left(w_{3}i_{3}\right)}^{m_{b}}=\sum_{n_{b}}g_{w_{2}3_{2}}^{m_{b}n_{b}}B_{0i_{2}i_{3}}^{n_{b}}
\]

\end_inset

if we SVD 
\begin_inset Formula $\Theta=UsV^{\dagger}$
\end_inset

 and truncate
\begin_inset Formula 
\[
\Theta_{\left(w_{1}i_{1}\right)\left(w_{2}i_{2}\right)}^{m_{a}}=\Theta_{\left(m_{a}w_{1}i_{1}\right)\left(w_{2}i_{2}\right)}=\sum_{k=1}^{DD_{w}}U_{\left(m_{a}w_{1}i_{1}\right)k}s_{kk}^{A}V_{k\left(w_{2}i_{2}\right)}^{A\dagger}\sim\sum_{k=1}^{D}U_{\left(w_{1}i_{1}\right)k}^{m_{a}}s_{kk}^{\prime A}V_{k\left(w_{2}i_{2}\right)}^{A\dagger}
\]

\end_inset


\begin_inset Formula 
\[
\Theta_{\left(w_{2}i_{2}\right)\left(w_{3}i_{3}\right)}^{m_{b}}=\Theta_{\left(m_{b}w_{2}i_{2}\right)\left(w_{3}i_{3}\right)}=\sum_{k=1}^{DD_{w}}U_{\left(m_{b}w_{2}i_{2}\right)k}s_{kk}^{B}V_{k\left(w_{3}i_{3}\right)}^{A\dagger}\sim\sum_{k=1}^{D}U_{\left(w_{1}i_{1}\right)k}^{m_{b}}s_{kk}^{\prime B}V_{k\left(w_{3}i_{3}\right)}^{B\dagger}
\]

\end_inset

On an infinite lattice we new have two sequences repeating
\begin_inset Formula 
\[
U^{m_{a}}s^{\prime A}V^{A\dagger}U^{m_{b}}s^{\prime B}V^{B\dagger}
\]

\end_inset

whihc means we end up rotating 
\begin_inset Formula $\sqrt{s^{\prime B}}V^{B\dagger}$
\end_inset

 over to the left side
\begin_inset Formula 
\[
\sqrt{s^{\prime B}}V^{B\dagger}U^{m_{a}}\sqrt{s^{\prime A}}\sqrt{s^{\prime A}}V^{A\dagger}U^{m_{b}}\sqrt{s^{\prime B}}
\]

\end_inset

which shows us that
\begin_inset Formula 
\[
\tilde{A}^{m_{a}}=\sqrt{s^{\prime B}}V^{B\dagger}U^{m_{a}}\sqrt{s^{\prime A}}=\sqrt{\tilde{\lambda}^{B}}\tilde{\varGamma}^{m_{a}}\sqrt{\tilde{\lambda}^{A}}
\]

\end_inset


\begin_inset Formula 
\[
\tilde{B}^{m_{b}}=\sqrt{s^{\prime A}}V^{A\dagger}U^{m_{b}}\sqrt{s^{\prime B}}=\sqrt{\tilde{\lambda}^{A}}\tilde{\varGamma}^{m_{b}}\sqrt{\tilde{\lambda}^{B}}
\]

\end_inset

This truncation is equivalent to finding matrices 
\begin_inset Formula $Q$
\end_inset

 and 
\begin_inset Formula $P$
\end_inset

 such than
\begin_inset Formula 
\[
\tilde{A}^{m_{a}}=Q^{A}\Theta^{m_{a}}P^{A}
\]

\end_inset


\begin_inset Formula 
\[
\sqrt{s^{\prime B}}V^{B\dagger}U^{m_{a}}\sqrt{s^{\prime A}}=Q^{A}U^{m_{a}}s^{A}V^{A\dagger}P^{A}
\]

\end_inset


\begin_inset Formula 
\[
I_{D}=V^{B}\frac{1}{\sqrt{s^{\prime B}}}Q^{A}U^{m_{a}}sV^{A\dagger}P^{A}\frac{1}{\sqrt{s^{\prime A}}}U^{\dagger m_{a}}=V^{B}\frac{1}{\sqrt{s^{\prime B}}}Q^{A}U^{m_{a}}\sqrt{s^{A}}I_{DD_{w}}\sqrt{s^{A}}V^{A\dagger}P^{A}\frac{1}{\sqrt{s^{A\prime}}}U^{\dagger m_{a}}
\]

\end_inset


\begin_inset Formula 
\[
I_{D}=Q^{A\prime}I_{DD_{w}}P^{A\prime}
\]

\end_inset

where 
\begin_inset Formula $Q^{\prime}$
\end_inset

 and 
\begin_inset Formula $P^{\prime}$
\end_inset

 have the same definition as above.
 Now
\begin_inset Formula 
\[
Q^{A}=\sqrt{s^{B\prime}}V^{B\dagger}Q^{A\prime}\frac{1}{\sqrt{s^{A}}}U^{\dagger m_{a}}
\]

\end_inset


\begin_inset Formula 
\[
P^{A}=V^{A}\frac{1}{\sqrt{s^{A}}}P^{A\prime}U^{m_{a}}\sqrt{s^{A\prime}}
\]

\end_inset

similarly we find
\begin_inset Formula 
\[
\tilde{B}^{m_{a}}=Q^{B}\Theta^{m_{b}}P^{B}
\]

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
\sqrt{s^{\prime A}}V^{A\dagger}U^{m_{b}}\sqrt{s^{\prime B}}=Q^{B}U^{m_{b}}s^{B}V^{B\dagger}P^{B}
\]

\end_inset


\begin_inset Formula 
\[
I_{D}=V^{A}\frac{1}{\sqrt{s^{\prime A}}}Q^{B}U^{m_{b}}\sqrt{s^{B}}I_{DD_{w}}\sqrt{s^{B}}V^{B\dagger}P^{B}\frac{1}{\sqrt{s^{\prime B}}}U^{\dagger m_{b}}=Q^{B\prime}I_{DD_{w}}P^{B\prime}
\]

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
Q^{B}=\sqrt{s^{A\prime}}V^{A\dagger}Q^{\prime}\frac{1}{\sqrt{s^{B}}}U^{\dagger m_{b}}
\]

\end_inset


\begin_inset Formula 
\[
P^{B}=V^{B}\frac{1}{\sqrt{s^{B}}}P^{\prime}U^{m_{b}}\sqrt{s^{B\prime}}
\]

\end_inset

The next step is to orthogonalize the whole unite cell
\begin_inset Formula 
\[
\tilde{\varGamma}^{m_{a}}\tilde{\lambda}^{A}\tilde{\varGamma}^{m_{b}}\tilde{\lambda}^{B}
\]

\end_inset

which achieved by grouping 
\begin_inset Formula $\tilde{\varGamma}^{m}=\tilde{\varGamma}^{m_{a}}\tilde{\lambda}^{A}\tilde{\varGamma}^{m_{b}}$
\end_inset

 and orthogonalizing 
\begin_inset Formula $\tilde{\varGamma}^{m}\tilde{\lambda}^{B}$
\end_inset

 yielding 
\begin_inset Formula $\tilde{\varGamma_{1}}^{m}\tilde{\lambda}_{1}^{B}$
\end_inset

 which must then be unpacked to get 
\begin_inset Formula $\tilde{\varGamma}_{1}^{m_{a}}\tilde{\lambda}_{1}^{A}\tilde{\varGamma}_{1}^{m_{b}}\tilde{\lambda_{1}}^{B}$
\end_inset

.
\begin_inset Formula 
\[
\tilde{A}_{1}=\sqrt{\tilde{\lambda}_{1}^{B}}\tilde{\varGamma}_{1}^{m_{a}}\sqrt{\tilde{\lambda}_{1}^{A}}=Q_{c}^{A}\tilde{A}P_{c}^{A}
\]

\end_inset


\begin_inset Formula 
\[
\tilde{B}_{1}=\sqrt{\tilde{\lambda}_{1}^{A}}\tilde{\varGamma}_{1}^{m_{b}}\sqrt{\tilde{\lambda}_{1}^{B}}=Q_{c}^{B}\tilde{B}P_{c}^{B}
\]

\end_inset

From the unpacking process we have 
\begin_inset Formula 
\[
\tilde{\varGamma}_{1}^{m_{a}}=\frac{1}{\tilde{\lambda}_{1}^{B}}P^{n_{a}},
\]

\end_inset


\begin_inset Formula 
\[
\tilde{\varGamma}_{1}^{m_{b}}=Q^{n_{b}}\frac{1}{\tilde{\lambda}_{1}^{B}}
\]

\end_inset

where we now have all too many 
\begin_inset Formula $Ps$
\end_inset

and Qs.
 I think this is dead end because for example 
\begin_inset Formula $P^{n_{a}}$
\end_inset

 is not a function of 
\begin_inset Formula $\tilde{A}$
\end_inset

.
 This where we need to think about a two site gate (whihc can possible be
 decomposed via SVD into the two one site gates.
 Define
\begin_inset Formula 
\[
\tilde{A}_{1}\tilde{B}_{1}=Q_{c}\tilde{A}\tilde{B}P_{c}
\]

\end_inset


\begin_inset Formula 
\[
\sqrt{\tilde{\lambda}_{1}^{B}}\tilde{\varGamma_{1}}^{m}\sqrt{\tilde{\lambda}_{1}^{B}}=Q_{c}\tilde{A}\tilde{B}P_{c}
\]

\end_inset


\begin_inset Formula 
\[
\sqrt{\tilde{\lambda}_{1}^{B}}V^{\dagger}X^{-1}\tilde{\varGamma}^{m}Y^{T^{-1}}U\sqrt{\tilde{\lambda}_{1}^{B}}=Q_{c}\tilde{A}\tilde{B}P_{c}
\]

\end_inset


\begin_inset Formula 
\[
\sqrt{\tilde{\lambda}_{1}^{B}}V^{\dagger}X^{-1}\tilde{\varGamma}^{m_{a}}\tilde{\lambda}^{A}\tilde{\varGamma}^{m_{b}}Y^{T^{-1}}U\sqrt{\tilde{\lambda}_{1}^{B}}=Q_{c}\tilde{A}\tilde{B}P_{c}
\]

\end_inset


\begin_inset Formula 
\[
\sqrt{\tilde{\lambda}_{1}^{B}}V^{\dagger}X^{-1}\tilde{A}\tilde{B}\frac{1}{\tilde{\lambda}^{B}}Y^{T^{-1}}U\sqrt{\tilde{\lambda}_{1}^{B}}=Q_{c}\tilde{A}\tilde{B}P_{c}
\]

\end_inset

from whihc we can read off
\begin_inset Formula 
\[
Q_{c}=\sqrt{\tilde{\lambda}_{1}^{B}}V^{\dagger}X^{-1},\quad P_{c}=\frac{1}{\tilde{\lambda}^{B}}Y^{T^{-1}}U\sqrt{\tilde{\lambda}_{1}^{B}}
\]

\end_inset


\end_layout

\begin_layout Paragraph
Try and create two , two site gates
\end_layout

\begin_layout Standard
The idea here is the same as for orthogonalizing.
 Define 
\begin_inset Formula $\varGamma^{m}=\varGamma^{m_{a}}\lambda^{A}\varGamma^{m_{b}}$
\end_inset

 and create a gate for the 
\begin_inset Formula $d^{2}$
\end_inset

 Hilbert space of two sites using 
\begin_inset Formula $A_{o}^{m}=\varGamma^{m}\lambda^{B}$
\end_inset

 and a two site gate
\begin_inset Formula 
\[
g_{w_{1}w_{3}}^{mn}=g_{w_{1}w_{3}}^{m_{a}n_{a}m_{b}n_{b}}=\sum_{w_{2}}g_{w_{1}w_{2}}^{m_{a}n_{a}}g_{w_{2}w_{3}}^{m_{b}n_{b}}
\]

\end_inset

at the end we get 
\begin_inset Formula 
\[
G^{mn}=U^{\dagger}Q_{c}Qg^{mn}PP_{c}U
\]

\end_inset

 whihc can be unpacked into
\begin_inset Formula 
\[
G^{mn}\rightarrow G^{m_{a}n_{a}m_{b}n_{b}}
\]

\end_inset

Then we shift the center and define 
\begin_inset Formula $\varGamma^{m}=\varGamma^{m_{b}}\lambda^{B}\varGamma^{m_{a}}$
\end_inset

, 
\begin_inset Formula $A_{o}^{m}=\varGamma^{m}\lambda^{A}$
\end_inset

 and finally get a two site gate 
\begin_inset Formula $G^{m_{b}n_{b}m_{a}n_{a}}$
\end_inset

.
 Then we alternate applying these gates.
 This all depends on whether the ansatz than the environment is stable under
 iteration holds true.
 What if the 
\begin_inset Formula $AB$
\end_inset

 and 
\begin_inset Formula $BA$
\end_inset

 environments interact strongly? Then the ansatz fails.
\end_layout

\begin_layout Standard
It may even be possible to decompose it into two gates
\begin_inset Formula 
\[
G^{m_{a}n_{a}m_{b}n_{b}}\underset{\longrightarrow}{SVD}U^{m_{a}n_{a}}sV^{\dagger m_{b}n_{b}}
\]

\end_inset


\begin_inset Formula 
\[
=\left(U^{m_{a}n_{a}}\sqrt{s}\right)\left(\sqrt{s}V^{\dagger m_{b}n_{b}}\right)
\]

\end_inset


\begin_inset Formula 
\[
=G^{m_{a}n_{a}}G^{m_{b}n_{b}}
\]

\end_inset


\end_layout

\begin_layout Subsection
(iDMRG)
\begin_inset CommandInset label
LatexCommand label
name "subsec:Infinite-Density-Matrix"

\end_inset


\end_layout

\begin_layout Standard
The idea here is to start with a small system with only two sites, and we
 keep adding sites in the middle of the lattice until the matrices for the
 central sites converge to fixed point.
 For this it is convenient to change our lattice site number scheme from
 
\begin_inset Formula $1\ldots L$
\end_inset

 to 
\begin_inset Formula $1\ldots LL\ldots1$
\end_inset

 and sites to left of center have an additional label 
\begin_inset Formula $A$
\end_inset

 and sites to right 
\begin_inset Formula $B$
\end_inset

.
 The starting state is
\begin_inset Formula 
\[
\left|\psi_{1}\right\rangle =\sum_{n_{1}^{A}n_{1}^{B}}\boldsymbol{C}^{n_{1}^{A}n_{1}^{B}}\left|n_{1}^{A}n_{1}^{B}\right\rangle 
\]

\end_inset

which is just the full wavefunction (not an MPS) and 
\begin_inset Formula $C$
\end_inset

 is a 
\begin_inset Formula $d\times d$
\end_inset

 matrix of amplitudes.
 We calculate 
\begin_inset Formula $\boldsymbol{C}$
\end_inset

 by exact diagonalization of the of the 
\begin_inset Formula $d^{2}\times d^{2}$
\end_inset

 Hamiltonian matrix and reshaping the ground state eigenvector
\begin_inset Formula 
\[
U_{1,i}\rightarrow U_{1,(n_{1}^{A}n_{1}^{B})}=\boldsymbol{C}^{n_{1}^{A}n_{1}^{B}}
\]

\end_inset

 We can SVD 
\begin_inset Formula $C$
\end_inset

 (without any reshaping for once!)
\begin_inset Formula 
\[
\boldsymbol{C}=\boldsymbol{UsV^{\dagger}}
\]

\end_inset

and rename 
\begin_inset Formula $U_{n_{1}^{A},i_{1}}\rightarrow A_{1,i_{1}}^{[1]n_{1}^{A}}$
\end_inset

, 
\begin_inset Formula $s\rightarrow\Lambda^{[1]}$
\end_inset

 and 
\begin_inset Formula $\left(V^{\dagger}\right)_{i_{1},n_{1}^{B}}\rightarrow B_{i_{1},1}^{[1]n_{1}^{B}}$
\end_inset

 so that 
\begin_inset Formula 
\[
\left|\psi_{1}\right\rangle =\sum_{n_{1}^{A}n_{1}^{B}}\boldsymbol{A}^{[1]n_{1}^{A}}\boldsymbol{\Lambda}^{[1]}\boldsymbol{B}^{[1]n_{1}^{B}}\left|n_{1}^{A}n_{1}^{B}\right\rangle 
\]

\end_inset


\begin_inset Formula 
\[
=\sum_{n_{1}^{A}n_{1}^{B}}\sum_{i_{1}=1}^{d}A_{1,i_{1}}^{[1]n_{1}^{A}}\varLambda_{i_{1}}^{[1]}B_{i_{1},1}^{[1]n_{1}^{B}}\left|n_{1}^{A}n_{1}^{B}\right\rangle 
\]

\end_inset

This assumes that 
\begin_inset Formula $D>d$
\end_inset

 so we don;t need to truncate the sum of 
\begin_inset Formula $i_{1}$
\end_inset

 at this stage.
\end_layout

\begin_layout Standard
The next step is described as
\begin_inset CommandInset citation
LatexCommand cite
key "schollwoeck_density-matrix_2010"
literal "false"

\end_inset

 
\begin_inset Quotes eld
\end_inset

...we now insert two sites, and minimize the energy with respect to 
\begin_inset Formula $\hat{H}$
\end_inset

...
\begin_inset Quotes erd
\end_inset


\begin_inset Formula 
\[
\left|\psi_{2}\right\rangle =\sum_{n_{1}^{A}n_{2}^{A}n_{2}^{B}n_{1}^{B}}\boldsymbol{A}^{[1]n_{1}^{A}}\boldsymbol{\boldsymbol{C}}^{n_{2}^{A}n_{2}^{B}}\boldsymbol{B}^{[1]n_{1}^{B}}\left|n_{1}^{A}n_{2}^{A}n_{2}^{B}n_{1}^{B}\right\rangle 
\]

\end_inset


\begin_inset Formula 
\[
=\sum_{n_{1}^{A}n_{2}^{A}n_{2}^{B}n_{1}^{B}}\sum_{i_{1},i_{2}=1}^{\min\left\{ d,D\right\} }A_{1,i_{1}^{A}}^{[1]n_{1}^{A}}\boldsymbol{C}_{i_{1}^{A}i_{1}^{B}}^{n_{2}^{A}n_{2}^{B}}B_{i_{1}^{B},1}^{[1]n_{1}^{B}}\left|n_{1}^{A}n_{2}^{A}n_{2}^{B}n_{1}^{B}\right\rangle 
\]

\end_inset

As far as I know there is no such thing as minimizing the energy with respect
 to 
\begin_inset Formula $\hat{H}$
\end_inset

! What we need to do is minimize WRT 
\begin_inset Formula $C$
\end_inset

 and keep 
\begin_inset Formula $A^{[1]}$
\end_inset

 and 
\begin_inset Formula $B^{[1]}$
\end_inset

 fixed.
 Schollwoek says [Strongly Correlated Systems: Numerical Methods page 83]
 
\begin_inset Quotes eld
\end_inset

At each step we can write down 
\begin_inset Formula $\hat{H}$
\end_inset

 as an MPO and do the energy minimization
\begin_inset Quotes erd
\end_inset

.
 For coding we need unpack this last phrase in detail.
 A diagram is useful
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Plain Layout

\end_layout

\begin_layout Plain Layout
\begin_inset Graphics
	filename iDMRGEnergy.png
	scale 50

\end_inset


\begin_inset Caption Standard

\begin_layout Plain Layout
Energy contraction for the 4 site DMRG state.
\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout

\end_layout

\end_inset

We need to solve
\end_layout

\begin_layout Standard
\begin_inset Formula 
\begin{equation}
\frac{\partial E}{\partial C^{n_{2}^{A}n_{2}^{B}}}-\lambda\frac{\partial\left\langle \psi|\psi\right\rangle }{\partial C^{n_{2}^{A}n_{2}^{B}}}=0\label{eq:GSEquations-1}
\end{equation}

\end_inset

From the diagram we see use the rule for 
\begin_inset Formula $H_{eff}$
\end_inset

 just delete the tensors we want to optimize, in this case delete both 
\begin_inset Formula $C$
\end_inset

 tensors.
 As a result
\begin_inset Formula 
\[
H_{eff}\left(i_{1}^{A},i_{1}^{B},m_{2}^{A},m_{2}^{B}\right)\left(j_{1}^{A},j_{1}^{B},n_{2}^{A},n_{2}^{B}\right)
\]

\end_inset


\begin_inset Formula 
\[
=\sum_{\left\{ w\right\} }\left(\sum_{n_{1}^{A}m_{1}^{A}}A_{1,i_{1}^{A}}^{\dagger[1]m_{1}^{A}}W_{1w_{1}^{A}}^{m_{1}^{A}n_{1}^{A}}A_{1,j_{1}^{A}}^{[1]n_{1}^{A}}\right)W_{w_{1}^{A}w_{2}}^{m_{2}^{A}n_{2}^{A}}W_{w_{2}w_{1}^{B}}^{m_{2}^{B}n_{2}^{B}}\left(\sum_{n_{1}^{B}m_{1}^{B}}B_{i_{1}^{B},1}^{\dagger[1]m_{1}^{B}}W_{w_{1}^{B}1}^{m_{1}^{B}n_{1}^{B}}B_{j_{1}^{B},1}^{[1]n_{1}^{B}}\right)
\]

\end_inset

As usual we can define
\begin_inset Formula 
\[
L_{i_{1}^{A}w_{1}^{A}j_{1}^{A}}^{[1]}=\sum_{n_{1}^{A}m_{1}^{A}}A_{1,i_{1}^{A}}^{\dagger[1]m_{1}^{A}}W_{1w_{1}^{A}}^{m_{1}^{A}n_{1}^{A}}A_{1,j_{1}^{A}}^{[1]n_{1}^{A}}
\]

\end_inset


\begin_inset Formula 
\[
R_{i_{1}^{B}w_{1}^{B}j_{1}^{B}}^{[1]}=\sum_{n_{1}^{B}m_{1}^{B}}B_{i_{1}^{B},1}^{\dagger[1]m_{1}^{B}}W_{w_{1}^{B}1}^{m_{1}^{B}n_{1}^{B}}B_{j_{1}^{B},1}^{[1]n_{1}^{B}}
\]

\end_inset

These can be cached and recursively updated
\begin_inset Formula 
\[
L_{i_{2}^{A}w_{2}^{A}j_{2}^{A}}^{[2]}=\sum_{n_{2}^{A}m_{2}^{A}}\sum_{i_{1}^{A}w_{1}^{A}j_{1}^{A}}A_{i_{2}^{A}i_{1}^{A}}^{*[2]m_{2}^{A}}W_{w_{1}^{A}w_{2}^{A}}^{m_{2}^{A}n_{2}^{A}}L_{i_{1}^{A}w_{1}^{A}j_{1}^{A}}^{[1]}A_{j_{1}^{A}j_{2}^{A}}^{[2]n_{2}^{A}}
\]

\end_inset


\begin_inset Formula 
\[
R_{i_{2}^{B}w_{2}^{B}j_{2}^{B}}^{[2]}=\sum_{n_{2}^{B}m_{2}^{B}}\sum_{i_{1}^{B}w_{1}^{B}j_{1}^{B}}B_{i_{1}^{B},1}^{\dagger[2]m_{2}^{B}}W_{w_{1}^{B}w_{2}^{B}}^{m_{2}^{B}n_{2}^{B}}R_{i_{1}^{B}w_{1}^{B}j_{1}^{B}}^{[1]}B_{j_{1}^{B},1}^{[2]n_{2}^{B}}
\]

\end_inset

We can see form the indices that 
\begin_inset Formula $H_{eff}$
\end_inset

 is 
\begin_inset Formula $D^{2}d^{2}\times D^{2}d^{2}$
\end_inset

 matrix which is getting pretty sizable.
 
\end_layout

\begin_layout Standard
We go about this by reshaping and decomposing
\begin_inset Formula 
\[
\boldsymbol{C}_{i_{1}^{A}i_{1}^{B}}^{n_{2}^{A}n_{2}^{B}}\rightarrow C_{\left(i_{1}^{A}n_{2}^{A}\right)\left(i_{1}^{B}n_{2}^{B}\right)}=U^{2}s^{2}V^{2\dagger}
\]

\end_inset


\end_layout

\begin_layout Section
Software Plan
\end_layout

\begin_layout Standard
As of Feb 2020 we have the following implemented
\end_layout

\begin_layout Enumerate
Finite lattice MPS with open boundary conditions
\end_layout

\begin_layout Enumerate
MPOs with optimized contractions routines
\end_layout

\begin_layout Enumerate
Single site ground state sweeps
\end_layout

\begin_deeper
\begin_layout Enumerate
Convergence for these is spotty, particularly for 
\begin_inset Formula $S\geq1$
\end_inset


\end_layout

\end_deeper
\begin_layout Enumerate
Embryonic UI using wxPython using the wxPlotting library
\end_layout

\begin_deeper
\begin_layout Enumerate
Run time is not reliable, crashes when initializing graphs on home PC
\end_layout

\end_deeper
\begin_layout Enumerate
Calculation of 1 and 2 site density matrices
\end_layout

\begin_layout Enumerate
Full unit testing suite
\end_layout

\begin_layout Standard
Going forward we need
\end_layout

\begin_layout Itemize
More graphics
\end_layout

\begin_deeper
\begin_layout Itemize
Show spin expectations across the lattice (3D arrows?)
\end_layout

\begin_layout Itemize
Show 2D shade plot of spin spin correlations
\end_layout

\end_deeper
\begin_layout Itemize
Better convergence
\end_layout

\begin_deeper
\begin_layout Itemize
Done: For fixed 
\begin_inset Formula $L$
\end_inset

 start with 
\begin_inset Formula $D=2$
\end_inset

 and grow 
\begin_inset Formula $D$
\end_inset


\end_layout

\begin_layout Itemize
Done: Follow a schedule with ever tightening convergence criteria.
\end_layout

\begin_layout Itemize
Try two site optimization.
 We need this for iDMRG anyway
\end_layout

\end_deeper
\begin_layout Itemize
Exact diagonalization for small lattices
\end_layout

\begin_deeper
\begin_layout Itemize
Useful for unit testing
\end_layout

\begin_layout Itemize
Required for setting up 
\begin_inset Formula $\left\langle i\right|e^{-\tau\mathcal{\hat{H}}}\left|j\right\rangle $
\end_inset

 calculations
\end_layout

\begin_layout Itemize
Required for kick off of iDMRG
\end_layout

\end_deeper
\begin_layout Itemize
Time (imag and/or real) evolution for finite OBC lattice
\end_layout

\begin_deeper
\begin_layout Itemize
Done: Construct so called Trotter gate MPO 
\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:MPO-representation"
plural "false"
caps "false"
noprefix "false"

\end_inset


\end_layout

\begin_layout Itemize
Done: Apply to MPS
\end_layout

\begin_layout Itemize
Done: SVD compress 
\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:SVD-compression"
plural "false"
caps "false"
noprefix "false"

\end_inset


\end_layout

\begin_layout Itemize
Done: Optimal compress 
\begin_inset CommandInset ref
LatexCommand ref
reference "subsec:Optimal-compression"
plural "false"
caps "false"
noprefix "false"

\end_inset


\end_layout

\end_deeper
\begin_layout Itemize
iDMRG
\end_layout

\begin_layout Itemize
iTEBD
\end_layout

\begin_deeper
\begin_layout Itemize
Finish writing up theory
\end_layout

\end_deeper
\begin_layout Itemize
Wrappers
\end_layout

\begin_deeper
\begin_layout Itemize
Python
\end_layout

\begin_layout Itemize
Julia use 
\begin_inset CommandInset href
LatexCommand href
name "CxxWrap"
target "https://github.com/JuliaInterop/CxxWrap.jl"
literal "false"

\end_inset


\end_layout

\begin_deeper
\begin_layout Itemize
Julia docs 
\begin_inset CommandInset href
LatexCommand href
name "here"
target "https://docs.julialang.org/en/v1/manual/calling-c-and-fortran-code/"
literal "false"

\end_inset


\end_layout

\end_deeper
\end_deeper
\begin_layout Itemize
Investigate other MPS packages
\end_layout

\begin_deeper
\begin_layout Itemize
\begin_inset CommandInset href
LatexCommand href
name "OpenMPS"
target "https://openmps.sourceforge.io/"
literal "false"

\end_inset

, related publications are listed 
\begin_inset CommandInset href
LatexCommand href
name "here"
target "https://openmps.sourceforge.io/chapters/acknowledgments.html"
literal "false"

\end_inset

.
 (Python wrapper to FORTRAN)
\end_layout

\begin_layout Itemize
Done: 
\begin_inset CommandInset href
LatexCommand href
name "ITensor"
target "http://itensor.org/"
literal "false"

\end_inset

 (C++)
\end_layout

\begin_layout Itemize
\begin_inset CommandInset href
LatexCommand href
name "iPEPS"
target "https://arxiv.org/abs/1902.02663"
literal "false"

\end_inset

 (Julia)
\end_layout

\begin_layout Itemize
\begin_inset CommandInset href
LatexCommand href
name "TiledArray"
target "https://github.com/ValeevGroup/tiledarray"
literal "false"

\end_inset

 (C++)
\end_layout

\begin_layout Itemize
\begin_inset CommandInset href
LatexCommand href
name "Fastor"
target "https://github.com/romeric/Fastor"
literal "false"

\end_inset

 (C++) This one looks good for rank 
\begin_inset Formula $>2$
\end_inset

 tensors.
 Rank is hard coded.
\end_layout

\begin_layout Itemize
\begin_inset CommandInset href
LatexCommand href
name "Cyclops"
target "http://solomon2.web.engr.illinois.edu/ctf/"
literal "false"

\end_inset

 (C++)
\end_layout

\begin_layout Itemize
\begin_inset CommandInset href
LatexCommand href
name "Uni10"
target "http://yingjerkao.github.io/uni10/"
literal "false"

\end_inset

 (C++)
\end_layout

\end_deeper
\begin_layout Itemize
Try making Itensor and Fastor versions of the MPSSite class.
 How much code needs to sequestered behind an interface in order to do this?
\end_layout

\begin_layout Subsection
Notation/Symbol conventions
\end_layout

\begin_layout Standard
\begin_inset Float table
wide false
sideways false
status open

\begin_layout Plain Layout

\end_layout

\begin_layout Plain Layout
\begin_inset Tabular
<lyxtabular version="3" rows="14" columns="4">
<features tabularvalignment="middle">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<row>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Description
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
in Lyx Notes
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
in Code
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Other synbols used in the literature
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Dimension of local Hilbert space
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $d$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset listings
inline false
status open

\begin_layout Plain Layout

d
\end_layout

\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $p$
\end_inset

, 
\begin_inset Formula $2S+1$
\end_inset


\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
MPS bond dimension
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $D$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset listings
inline false
status open

\begin_layout Plain Layout

D
\end_layout

\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $m$
\end_inset

, 
\begin_inset Formula $\chi$
\end_inset


\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
MPO bond dimension
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $Dw$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset listings
inline false
status open

\begin_layout Plain Layout

Dw
\end_layout

\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $w$
\end_inset


\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Lattice extent
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $L$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset listings
inline false
status open

\begin_layout Plain Layout

L
\end_layout

\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $N$
\end_inset


\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Lattice site
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $i_{a}$
\end_inset

, 
\begin_inset Formula $i_{b}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset listings
inline false
status open

\begin_layout Plain Layout

ia, ib
\end_layout

\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $a,b$
\end_inset


\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Local site quantum number
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $n$
\end_inset

, 
\begin_inset Formula $m$
\end_inset

, 
\begin_inset Formula $n_{a}$
\end_inset

, 
\begin_inset Formula $m_{a}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset listings
inline false
status open

\begin_layout Plain Layout

n,m,na,ma,nb,mb
\end_layout

\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\sigma_{a}\sigma_{b}$
\end_inset


\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Bond Indices for 
\begin_inset Formula $\left|\psi\right\rangle $
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $i,i_{1},i_{2},i_{3}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset listings
inline false
status open

\begin_layout Plain Layout

i,i1,i2,i3
\end_layout

\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Bond Indices for 
\begin_inset Formula $\left\langle \psi\right|$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $j,j_{1},j_{2}j_{3}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset listings
inline false
status open

\begin_layout Plain Layout

j,j1,j2,j3
\end_layout

\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\begin_inset Caption Standard

\begin_layout Plain Layout
Variable naming conventions
\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout

\end_layout

\end_inset


\end_layout

\begin_layout Section
\start_of_appendix
\begin_inset CommandInset label
LatexCommand label
name "sec:Exponential-of-an Operator"

\end_inset

Exponential of an operator
\end_layout

\begin_layout Standard
Starting with 
\begin_inset Formula 
\[
\hat{O}=e^{-\tau\mathcal{\hat{H}}}
\]

\end_inset

we can use the eigen decomposition of 
\begin_inset Formula $\mathcal{\hat{H}}=U\mathcal{\hat{\lambda}}U^{\dagger}$
\end_inset

 where 
\begin_inset Formula $\mathcal{\hat{\lambda}}$
\end_inset

 is the diagonal matrix of eigen values and 
\begin_inset Formula $U$
\end_inset

 is a unitary matrix with eigen vectors as columns, we can Taylor expand
\begin_inset Formula 
\[
e^{-\tau\mathcal{\hat{H}}}=e^{-\tau U\mathcal{\hat{\lambda}}U^{\dagger}}
\]

\end_inset


\begin_inset Formula 
\[
=\mathbb{I}-\tau U\mathcal{\hat{\lambda}}U^{\dagger}+\frac{1}{2!}\tau^{2}U\mathcal{\hat{\lambda}}U^{\dagger}U\mathcal{\hat{\lambda}}U^{\dagger}-\frac{1}{3!}\tau^{3}U\mathcal{\hat{\lambda}}U^{\dagger}U\mathcal{\hat{\lambda}}U^{\dagger}U\mathcal{\hat{\lambda}}U^{\dagger}+\ldots
\]

\end_inset


\begin_inset Formula 
\[
=\mathbb{I}-\tau U\mathcal{\hat{\lambda}}U^{\dagger}+\frac{1}{2!}\tau^{2}U\mathcal{\hat{\lambda}}\mathcal{\hat{\lambda}}U^{\dagger}-\frac{1}{3!}\tau^{3}U\mathcal{\hat{\lambda}}\mathcal{\hat{\lambda}}\mathcal{\hat{\lambda}}U^{\dagger}+\ldots
\]

\end_inset


\begin_inset Formula 
\[
=U\left\{ \mathbb{I}-\tau\mathcal{\hat{\lambda}}+\frac{1}{2!}\tau^{2}\mathcal{\hat{\lambda}}^{2}-\frac{1}{3!}\tau^{3}\mathcal{\hat{\lambda}}^{3}+\ldots\right\} U^{\dagger}
\]

\end_inset


\begin_inset Formula 
\[
=Ue^{-\tau\mathcal{\hat{\lambda}}}U^{\dagger}
\]

\end_inset

where
\begin_inset Formula 
\[
e^{-\tau\mathcal{\hat{\lambda}}}=\begin{bmatrix}e^{-\tau\lambda_{1}} & 0 & 0 & \cdots & 0\\
0 & e^{-\tau\lambda_{2}} & 0 & \cdots & 0\\
0 & 0 & e^{-\tau\lambda_{3}} & \cdots & 0\\
\vdots & \vdots & \vdots & \ddots & \vdots\\
0 & 0 & 0 & \cdots & e^{-\tau\lambda_{N}}
\end{bmatrix}=\delta_{ij}e^{-\tau\lambda_{i}}
\]

\end_inset

As an example for 
\begin_inset Formula $S=\frac{1}{2}$
\end_inset

 we find
\begin_inset Formula 
\[
\hat{O}=\begin{bmatrix}e^{-\nicefrac{\tau}{4}} & 0 & 0 & 0\\
0 & e^{\nicefrac{\tau}{4}}2\cosh\frac{\tau}{2} & -e^{\nicefrac{\tau}{4}}2\sinh\frac{\tau}{2} & 0\\
0 & -e^{\nicefrac{\tau}{4}}2\sinh\frac{\tau}{2} & e^{\nicefrac{\tau}{4}}2\cosh\frac{\tau}{2} & 0\\
0 & 0 & 0 & e^{-\nicefrac{\tau}{4}}
\end{bmatrix}
\]

\end_inset


\end_layout

\begin_layout Section
Puzzle #1
\end_layout

\begin_layout Standard
Schollwoek eq.
 eq 150 is
\begin_inset Formula 
\[
\left\Vert \psi-\tilde{\psi}\right\Vert ^{2}=1-\sum_{n_{a}}Tr\left(\tilde{M}^{n_{a}\dagger}\tilde{M}^{n_{a}}\right)
\]

\end_inset

and the summation as written is not valid because site 
\begin_inset Formula $a$
\end_inset

 is singled out.
 What it could mean is
\begin_inset Formula 
\[
\left\Vert \psi-\tilde{\psi}\right\Vert ^{2}=1-\sum_{\left\{ n\right\} }Tr\left(\tilde{M}^{n_{a}\dagger}\tilde{M}^{n_{a}}\right)
\]

\end_inset

i.e.
 a 
\begin_inset Formula $2^{N}$
\end_inset

 sum of all states.
 He claims that the sum just 
\begin_inset Formula $\left\langle \tilde{\psi}|\tilde{\psi}\right\rangle $
\end_inset

 which we already know is
\begin_inset Formula 
\[
\left\langle \tilde{\psi}|\tilde{\psi}\right\rangle =\sum_{n_{L}}\boldsymbol{\tilde{M}}^{n_{L}^{\dagger}}\left(\cdots\left(\sum_{n_{1}}\boldsymbol{\tilde{M}}^{n_{1}^{\dagger}}\boldsymbol{\tilde{M}}^{n_{1}}\right)\cdots\right)\boldsymbol{\tilde{M}}^{n_{L}}
\]

\end_inset

and apparently the cross terms 
\begin_inset Formula $-\left\langle \psi|\tilde{\psi}\right\rangle -\left\langle \tilde{\psi}|\psi\right\rangle $
\end_inset

 drop out due to Schollwoeck eq 148 which is eq.
 
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:Mtilda"
plural "false"
caps "false"
noprefix "false"

\end_inset

 in these notes.
\end_layout

\begin_layout Section
Ground state energies
\end_layout

\begin_layout Standard
From 
\begin_inset CommandInset citation
LatexCommand cite
key "ExactEnergies"
literal "false"

\end_inset

 the infinite 
\begin_inset Formula $S=\nicefrac{1}{2}$
\end_inset

 chain ground state energy is 
\begin_inset Formula $E=\nicefrac{1}{4}-\ln2=‚àí0.4431471805599453094172$
\end_inset

.
 This is useful for checking iTEBD results, but for other methods we need
 to know GS energies for finite lattices with open boundary conditions.
 There are few numbers in phys.
 stat.
 sol.
 35, 933 (1969): 
\end_layout

\begin_layout Standard
\begin_inset Float table
wide false
sideways false
status open

\begin_layout Plain Layout

\end_layout

\begin_layout Plain Layout
\begin_inset Tabular
<lyxtabular version="3" rows="5" columns="3">
<features tabularvalignment="middle">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<row>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $L$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $2E$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
E
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $2$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $-1.50000$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $-0.750000$
\end_inset


\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $4$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $-1.09402$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $-0.547010$
\end_inset


\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $6$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $-0.99743$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $-0.498715$
\end_inset


\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $8$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $-0.96427$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $-0.482135$
\end_inset


\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset

 
\begin_inset Caption Standard

\begin_layout Plain Layout
Per site energies.
\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout

\end_layout

\end_inset


\end_layout

\begin_layout Standard
Using the MPtoolkit mp-dmrg program we get good agreement for 
\begin_inset Formula $L=6,8$
\end_inset

 but a significant discrepancy for 
\begin_inset Formula $L=4$
\end_inset

?!?.
\end_layout

\begin_layout Standard
\begin_inset Float table
wide false
sideways false
status open

\begin_layout Plain Layout
\begin_inset Tabular
<lyxtabular version="3" rows="9" columns="3">
<features tabularvalignment="middle">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<row>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $L$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $E$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\frac{E}{L-1}$
\end_inset


\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
2
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $-1.5$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $-1.5$
\end_inset


\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
4
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $-1.6160254037844$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $-0.538675134594800$
\end_inset


\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
6
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $-2.4935771338879$
\end_inset

 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
\begin_inset Formula $-0.498715426777580$
\end_inset


\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
8
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $-3.3749325986879$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
\begin_inset Formula $-0.482133228383986$
\end_inset


\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
10
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $-4.2580352072829$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
\begin_inset Formula $-0.473115023031433$
\end_inset


\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
12
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $-5.1420906328405$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
\begin_inset Formula $-0.467462784803682$
\end_inset


\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
14
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $-6.0267246618622$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
\begin_inset Formula $-0.463594204758631$
\end_inset


\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
16
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $-6.9117371455751$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\strikeout off
\xout off
\uuline off
\uwave off
\noun off
\color none
\begin_inset Formula $-0.460782476371673$
\end_inset


\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
Ground state energies for OBC finite chains using the mp-dmrg app.
\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout

\end_layout

\end_inset

We can also calculate the 
\begin_inset Formula $D$
\end_inset

 dependence infinite lattices
\begin_inset Float table
wide false
sideways false
status open

\begin_layout Plain Layout

\end_layout

\begin_layout Plain Layout
\begin_inset Tabular
<lyxtabular version="3" rows="8" columns="2">
<features tabularvalignment="middle">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<row>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $D$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $E$
\end_inset


\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
2
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $-0.440206467793605$
\end_inset


\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
4
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $-0.442607382097140$
\end_inset


\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
8
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $-0.443081778062480$
\end_inset

 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
16
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $-0.443134779580595$
\end_inset


\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
32
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $-0.443144786802265$
\end_inset


\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
64
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $-0.443145797781275$
\end_inset


\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
128
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $-0.443145969741740$
\end_inset


\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\begin_inset Caption Standard

\begin_layout Plain Layout
iDMRG GS energies, mp-toolkit, SU(2) lattice with 2 site unit cell.
\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout

\end_layout

\end_inset


\end_layout

\begin_layout Section*
Bibliography
\end_layout

\begin_layout Standard
\begin_inset CommandInset bibtex
LatexCommand bibtex
btprint "btPrintCited"
bibfiles "MPS1"
options "bibtotoc,plain"

\end_inset


\end_layout

\end_body
\end_document
